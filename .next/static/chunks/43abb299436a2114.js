(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,10708,e=>{"use strict";var t=e.i(843476),r=e.i(271645),a=e.i(248425),n=r.forwardRef((e,r)=>(0,t.jsx)(a.Primitive.label,{...e,ref:r,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));n.displayName="Label";var i=e.i(647163);function s({className:e,...r}){return(0,t.jsx)(n,{"data-slot":"label",className:(0,i.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...r})}e.s(["Label",()=>s],10708)},184762,e=>{"use strict";var t=e.i(843476),r=e.i(647163);function a({className:e,...a}){return(0,t.jsx)("textarea",{"data-slot":"textarea",className:(0,r.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...a})}e.s(["Textarea",()=>a])},120682,e=>{"use strict";var t=e.i(271645);let r=0,a=new Map,n=e=>{if(a.has(e))return;let t=setTimeout(()=>{a.delete(e),l({type:"REMOVE_TOAST",toastId:e})},1e6);a.set(e,t)},i=[],s={toasts:[]};function l(e){s=((e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?n(r):e.toasts.forEach(e=>{n(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}})(s,e),i.forEach(e=>{e(s)})}function o({...e}){let t=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>l({type:"DISMISS_TOAST",toastId:t});return l({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:e=>{e||a()}}}),{id:t,dismiss:a,update:e=>l({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function c(){let[e,r]=t.useState(s);return t.useEffect(()=>(i.push(r),()=>{let e=i.indexOf(r);e>-1&&i.splice(e,1)}),[e]),{...e,toast:o,dismiss:e=>l({type:"DISMISS_TOAST",toastId:e})}}e.s(["toast",()=>o,"useToast",()=>c])},970065,e=>{"use strict";var t=e.i(843476),r=e.i(647163);function a({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card",className:(0,r.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...a})}function n({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card-header",className:(0,r.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...a})}function i({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card-title",className:(0,r.cn)("leading-none font-semibold",e),...a})}function s({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card-description",className:(0,r.cn)("text-muted-foreground text-sm",e),...a})}function l({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card-content",className:(0,r.cn)("px-6",e),...a})}function o({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card-footer",className:(0,r.cn)("flex items-center px-6 [.border-t]:pt-6",e),...a})}e.s(["Card",()=>a,"CardContent",()=>l,"CardDescription",()=>s,"CardFooter",()=>o,"CardHeader",()=>n,"CardTitle",()=>i])},470152,e=>{"use strict";function t(e,[t,r]){return Math.min(r,Math.max(t,e))}e.s(["clamp",()=>t])},569074,e=>{"use strict";let t=(0,e.i(475254).default)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);e.s(["Upload",()=>t],569074)},871689,e=>{"use strict";let t=(0,e.i(475254).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>t],871689)},618975,e=>{"use strict";let t=(0,e.i(475254).default)("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);e.s(["default",()=>t])},674627,e=>{"use strict";let{getOwnPropertyNames:t,getOwnPropertySymbols:r}=Object,{hasOwnProperty:a}=Object.prototype;function n(e,t){return function(r,a,n){return e(r,a,n)&&t(r,a,n)}}function i(e){return function(t,r,a){if(!t||!r||"object"!=typeof t||"object"!=typeof r)return e(t,r,a);let{cache:n}=a,i=n.get(t),s=n.get(r);if(i&&s)return i===r&&s===t;n.set(t,r),n.set(r,t);let l=e(t,r,a);return n.delete(t),n.delete(r),l}}function s(e){return t(e).concat(r(e))}let l=Object.hasOwn||((e,t)=>a.call(e,t));function o(e,t){return e===t||!e&&!t&&e!=e&&t!=t}let{getOwnPropertyDescriptor:c,keys:u}=Object;function d(e,t){return e.byteLength===t.byteLength&&w(new Uint8Array(e),new Uint8Array(t))}function f(e,t,r){let a=e.length;if(t.length!==a)return!1;for(;a-- >0;)if(!r.equals(e[a],t[a],a,a,e,t,r))return!1;return!0}function p(e,t){return e.byteLength===t.byteLength&&w(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),new Uint8Array(t.buffer,t.byteOffset,t.byteLength))}function m(e,t){return o(e.getTime(),t.getTime())}function h(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function b(e,t){return e===t}function g(e,t,r){let a,n,i=e.size;if(i!==t.size)return!1;if(!i)return!0;let s=Array(i),l=e.entries(),o=0;for(;(a=l.next())&&!a.done;){let i=t.entries(),l=!1,c=0;for(;(n=i.next())&&!n.done;){if(s[c]){c++;continue}let i=a.value,u=n.value;if(r.equals(i[0],u[0],o,c,e,t,r)&&r.equals(i[1],u[1],i[0],u[0],e,t,r)){l=s[c]=!0;break}c++}if(!l)return!1;o++}return!0}function x(e,t,r){let a=u(e),n=a.length;if(u(t).length!==n)return!1;for(;n-- >0;)if(!N(e,t,r,a[n]))return!1;return!0}function j(e,t,r){let a,n,i,l=s(e),o=l.length;if(s(t).length!==o)return!1;for(;o-- >0;)if(!N(e,t,r,a=l[o])||(n=c(e,a),i=c(t,a),(n||i)&&(!n||!i||n.configurable!==i.configurable||n.enumerable!==i.enumerable||n.writable!==i.writable)))return!1;return!0}function y(e,t){return o(e.valueOf(),t.valueOf())}function v(e,t){return e.source===t.source&&e.flags===t.flags}function S(e,t,r){let a,n,i=e.size;if(i!==t.size)return!1;if(!i)return!0;let s=Array(i),l=e.values();for(;(a=l.next())&&!a.done;){let i=t.values(),l=!1,o=0;for(;(n=i.next())&&!n.done;){if(!s[o]&&r.equals(a.value,n.value,a.value,n.value,e,t,r)){l=s[o]=!0;break}o++}if(!l)return!1}return!0}function w(e,t){let r=e.byteLength;if(t.byteLength!==r||e.byteOffset!==t.byteOffset)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function A(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function N(e,t,r,a){return("_owner"===a||"__o"===a||"__v"===a)&&(!!e.$$typeof||!!t.$$typeof)||l(t,a)&&r.equals(e[a],t[a],a,a,e,t,r)}let T={"[object Int8Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Int16Array]":!0,"[object Uint16Array]":!0,"[object Int32Array]":!0,"[object Uint32Array]":!0,"[object Float16Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0,"[object BigInt64Array]":!0,"[object BigUint64Array]":!0},E=Object.prototype.toString,_=C();function C(e={}){let{circular:t=!1,createInternalComparator:r,createState:a,strict:s=!1}=e,l=function({areArrayBuffersEqual:e,areArraysEqual:t,areDataViewsEqual:r,areDatesEqual:a,areErrorsEqual:n,areFunctionsEqual:i,areMapsEqual:s,areNumbersEqual:l,areObjectsEqual:o,arePrimitiveWrappersEqual:c,areRegExpsEqual:u,areSetsEqual:d,areTypedArraysEqual:f,areUrlsEqual:p,unknownTagComparators:m}){return function(h,b,g){if(h===b)return!0;if(null==h||null==b)return!1;let x=typeof h;if(x!==typeof b)return!1;if("object"!==x)return"number"===x?l(h,b,g):"function"===x&&i(h,b,g);let j=h.constructor;if(j!==b.constructor)return!1;if(j===Object)return o(h,b,g);if(Array.isArray(h))return t(h,b,g);if(j===Date)return a(h,b,g);if(j===RegExp)return u(h,b,g);if(j===Map)return s(h,b,g);if(j===Set)return d(h,b,g);let y=E.call(h);if("[object Date]"===y)return a(h,b,g);if("[object RegExp]"===y)return u(h,b,g);if("[object Map]"===y)return s(h,b,g);if("[object Set]"===y)return d(h,b,g);if("[object Object]"===y)return"function"!=typeof h.then&&"function"!=typeof b.then&&o(h,b,g);if("[object URL]"===y)return p(h,b,g);if("[object Error]"===y)return n(h,b,g);if("[object Arguments]"===y)return o(h,b,g);if(T[y])return f(h,b,g);if("[object ArrayBuffer]"===y)return e(h,b,g);if("[object DataView]"===y)return r(h,b,g);if("[object Boolean]"===y||"[object Number]"===y||"[object String]"===y)return c(h,b,g);if(m){let e=m[y];if(!e){let t=null!=h?h[Symbol.toStringTag]:void 0;t&&(e=m[t])}if(e)return e(h,b,g)}return!1}}(function({circular:e,createCustomConfig:t,strict:r}){let a={areArrayBuffersEqual:d,areArraysEqual:r?j:f,areDataViewsEqual:p,areDatesEqual:m,areErrorsEqual:h,areFunctionsEqual:b,areMapsEqual:r?n(g,j):g,areNumbersEqual:o,areObjectsEqual:r?j:x,arePrimitiveWrappersEqual:y,areRegExpsEqual:v,areSetsEqual:r?n(S,j):S,areTypedArraysEqual:r?n(w,j):w,areUrlsEqual:A,unknownTagComparators:void 0};if(t&&(a=Object.assign({},a,t(a))),e){let e=i(a.areArraysEqual),t=i(a.areMapsEqual),r=i(a.areObjectsEqual),n=i(a.areSetsEqual);a=Object.assign({},a,{areArraysEqual:e,areMapsEqual:t,areObjectsEqual:r,areSetsEqual:n})}return a}(e)),c=r?r(l):function(e,t,r,a,n,i,s){return l(e,t,s)};return function({circular:e,comparator:t,createState:r,equals:a,strict:n}){if(r)return function(i,s){let{cache:l=e?new WeakMap:void 0,meta:o}=r();return t(i,s,{cache:l,equals:a,meta:o,strict:n})};if(e)return function(e,r){return t(e,r,{cache:new WeakMap,equals:a,meta:void 0,strict:n})};let i={cache:void 0,equals:a,meta:void 0,strict:n};return function(e,r){return t(e,r,i)}}({circular:t,comparator:l,createState:a,equals:c,strict:s})}C({strict:!0}),C({circular:!0}),C({circular:!0,strict:!0}),C({createInternalComparator:()=>o}),C({strict:!0,createInternalComparator:()=>o}),C({circular:!0,createInternalComparator:()=>o}),C({circular:!0,createInternalComparator:()=>o,strict:!0}),e.s(["deepEqual",()=>_])},889099,e=>{"use strict";var t=e.i(843476),r=e.i(271645),a=e.i(618566),n=e.i(970065),i=e.i(167881),s=e.i(23750),l=e.i(10708),o=e.i(184762),c=e.i(62870),u=e.i(871689),d=e.i(569074),f=e.i(37727),p=e.i(522016),m=e.i(646593),h=e.i(920755),b=e.i(120682);function g({params:e}){let{id:g}=(0,r.use)(e),x=(0,a.useRouter)(),{toast:j}=(0,b.useToast)(),[y,v]=(0,r.useState)(""),[S,w]=(0,r.useState)(!0),[A,N]=(0,r.useState)(!1),[T,E]=(0,r.useState)(null),[_,C]=(0,r.useState)([]),[O,I]=(0,r.useState)(""),[q,D]=(0,r.useState)(!1),L=(0,r.useRef)(null);(0,r.useEffect)(()=>{(async()=>{let e=(0,h.createClient)(),{data:t}=await e.from("blog_posts").select(`
          *,
          blog_post_categories(category_id)
        `).eq("id",g).single();t&&(E(t),v(t.content||""),I(t.featured_image_url||""));let{data:r}=await e.from("blog_categories").select("*").order("name");r&&C(r),w(!1)})()},[g]);let M=async e=>{let t=e.target.files?.[0];if(t){D(!0);try{let e=new FormData;e.append("file",t);let r=await fetch("/api/blog/upload",{method:"POST",body:e});if(!r.ok)throw Error("Upload failed");let a=await r.json();I(a.url),j({title:"Éxito",description:"Imagen destacada subida correctamente"})}catch(e){j({title:"Error",description:"No se pudo subir la imagen",variant:"destructive"})}finally{D(!1)}}},k=async e=>{e.preventDefault(),N(!0);let t=new FormData(e.currentTarget),r=(0,h.createClient)(),a=t.get("title"),n=t.get("slug"),i=t.get("excerpt"),s=t.get("status"),l=t.get("category"),{error:o}=await r.from("blog_posts").update({title:a,slug:n,excerpt:i,content:y,status:s,featured_image_url:O||null,published_at:"published"!==s||T.published_at?T.published_at:new Date().toISOString()}).eq("id",g);if(o){j({title:"Error",description:"No se pudo actualizar el post: "+o.message,variant:"destructive"}),N(!1);return}l&&(await r.from("blog_post_categories").delete().eq("post_id",g),await r.from("blog_post_categories").insert({post_id:g,category_id:l})),j({title:"Éxito",description:"Post actualizado correctamente"}),x.push("/admin/blog"),x.refresh()};return S?(0,t.jsx)("div",{className:"p-8",children:(0,t.jsx)("p",{children:"Cargando..."})}):T?(0,t.jsxs)("div",{className:"p-8 space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(i.Button,{variant:"ghost",size:"icon",asChild:!0,children:(0,t.jsx)(p.default,{href:"/admin/blog",children:(0,t.jsx)(u.ArrowLeft,{className:"h-5 w-5"})})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"Editar Post"}),(0,t.jsx)("p",{className:"text-muted-foreground mt-1",children:"Modifica el artículo del blog"})]})]}),(0,t.jsx)("form",{onSubmit:k,children:(0,t.jsxs)(n.Card,{children:[(0,t.jsxs)(n.CardHeader,{children:[(0,t.jsx)(n.CardTitle,{children:"Información del Post"}),(0,t.jsx)(n.CardDescription,{children:"Actualiza los detalles del artículo"})]}),(0,t.jsxs)(n.CardContent,{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(l.Label,{htmlFor:"title",children:"Título *"}),(0,t.jsx)(s.Input,{id:"title",name:"title",required:!0,defaultValue:T.title})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(l.Label,{htmlFor:"slug",children:"Slug (URL) *"}),(0,t.jsx)(s.Input,{id:"slug",name:"slug",required:!0,defaultValue:T.slug})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(l.Label,{htmlFor:"excerpt",children:"Extracto"}),(0,t.jsx)(o.Textarea,{id:"excerpt",name:"excerpt",defaultValue:T.excerpt||"",className:"min-h-[100px]"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(l.Label,{children:"Contenido *"}),(0,t.jsx)(m.RichTextEditor,{content:y,onChange:v})]}),(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(l.Label,{htmlFor:"status",children:"Estado"}),(0,t.jsxs)(c.Select,{name:"status",defaultValue:T.status,children:[(0,t.jsx)(c.SelectTrigger,{children:(0,t.jsx)(c.SelectValue,{})}),(0,t.jsxs)(c.SelectContent,{children:[(0,t.jsx)(c.SelectItem,{value:"draft",children:"Borrador"}),(0,t.jsx)(c.SelectItem,{value:"published",children:"Publicado"}),(0,t.jsx)(c.SelectItem,{value:"archived",children:"Archivado"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(l.Label,{htmlFor:"category",children:"Categoría"}),(0,t.jsxs)(c.Select,{name:"category",defaultValue:T.blog_post_categories?.[0]?.category_id,children:[(0,t.jsx)(c.SelectTrigger,{children:(0,t.jsx)(c.SelectValue,{placeholder:"Seleccionar categoría"})}),(0,t.jsx)(c.SelectContent,{children:_.map(e=>(0,t.jsx)(c.SelectItem,{value:e.id,children:e.name},e.id))})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(l.Label,{htmlFor:"featured_image",children:"Imagen Destacada"}),O?(0,t.jsxs)("div",{className:"relative aspect-video w-full max-w-md overflow-hidden rounded-lg border",children:[(0,t.jsx)("img",{src:O||"/placeholder.svg",alt:"Imagen destacada",className:"w-full h-full object-cover"}),(0,t.jsx)(i.Button,{type:"button",variant:"destructive",size:"icon",className:"absolute top-2 right-2",onClick:()=>I(""),children:(0,t.jsx)(f.X,{className:"h-4 w-4"})})]}):(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(s.Input,{ref:L,type:"file",accept:"image/*",onChange:M,disabled:q,className:"hidden"}),(0,t.jsxs)(i.Button,{type:"button",variant:"outline",onClick:()=>L.current?.click(),disabled:q,children:[(0,t.jsx)(d.Upload,{className:"mr-2 h-4 w-4"}),q?"Subiendo...":"Subir Imagen"]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"JPG, PNG o WebP (máx. 5MB)"})]})]})]}),(0,t.jsxs)("div",{className:"flex gap-4 justify-end pt-4",children:[(0,t.jsx)(i.Button,{type:"button",variant:"outline",asChild:!0,children:(0,t.jsx)(p.default,{href:"/admin/blog",children:"Cancelar"})}),(0,t.jsx)(i.Button,{type:"submit",disabled:A,children:A?"Guardando...":"Guardar Cambios"})]})]})]})})]}):(0,t.jsx)("div",{className:"p-8",children:(0,t.jsx)("p",{children:"Post no encontrado"})})}e.s(["default",()=>g])}]);