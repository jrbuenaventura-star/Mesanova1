(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,470152,e=>{"use strict";function r(e,[r,a]){return Math.min(a,Math.max(r,e))}e.s(["clamp",()=>r])},947627,e=>{"use strict";var r=e.i(843476),a=e.i(647163);function s({className:e,...s}){return(0,r.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,r.jsx)("table",{"data-slot":"table",className:(0,a.cn)("w-full caption-bottom text-sm",e),...s})})}function t({className:e,...s}){return(0,r.jsx)("thead",{"data-slot":"table-header",className:(0,a.cn)("[&_tr]:border-b",e),...s})}function i({className:e,...s}){return(0,r.jsx)("tbody",{"data-slot":"table-body",className:(0,a.cn)("[&_tr:last-child]:border-0",e),...s})}function l({className:e,...s}){return(0,r.jsx)("tfoot",{"data-slot":"table-footer",className:(0,a.cn)("bg-muted/50 border-t font-medium [&>tr]:last:border-b-0",e),...s})}function n({className:e,...s}){return(0,r.jsx)("tr",{"data-slot":"table-row",className:(0,a.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...s})}function d({className:e,...s}){return(0,r.jsx)("th",{"data-slot":"table-head",className:(0,a.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...s})}function c({className:e,...s}){return(0,r.jsx)("td",{"data-slot":"table-cell",className:(0,a.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...s})}function o({className:e,...s}){return(0,r.jsx)("caption",{"data-slot":"table-caption",className:(0,a.cn)("text-muted-foreground mt-4 text-sm",e),...s})}e.s(["Table",()=>s,"TableBody",()=>i,"TableCaption",()=>o,"TableCell",()=>c,"TableFooter",()=>l,"TableHead",()=>d,"TableHeader",()=>t,"TableRow",()=>n])},269638,e=>{"use strict";let r=(0,e.i(475254).default)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["CheckCircle",()=>r],269638)},263488,e=>{"use strict";let r=(0,e.i(475254).default)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);e.s(["Mail",()=>r],263488)},569074,e=>{"use strict";let r=(0,e.i(475254).default)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);e.s(["Upload",()=>r],569074)},232189,(e,r,a)=>{"use strict";r.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},865156,(e,r,a)=>{"use strict";var s=e.r(232189);function t(){}function i(){}i.resetWarningCache=t,r.exports=function(){function e(e,r,a,t,i,l){if(l!==s){var n=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw n.name="Invariant Violation",n}}function r(){return e}e.isRequired=e;var a={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:r,element:e,elementType:e,instanceOf:r,node:e,objectOf:r,oneOf:r,oneOfType:r,shape:r,exact:r,checkPropTypes:i,resetWarningCache:t};return a.PropTypes=a,a}},745009,(e,r,a)=>{r.exports=e.r(865156)()},287336,e=>{"use strict";var r=e.i(843476),a=e.i(271645),s=e.i(30030),t=e.i(248425),i="Progress",[l,n]=(0,s.createContextScope)(i),[d,c]=l(i),o=a.forwardRef((e,a)=>{var s,i;let{__scopeProgress:l,value:n=null,max:c,getValueLabel:o=m,...x}=e;(c||0===c)&&!v(c)&&console.error((s=`${c}`,`Invalid prop \`max\` of value \`${s}\` supplied to \`Progress\`. Only numbers greater than 0 are valid max values. Defaulting to \`100\`.`));let u=v(c)?c:100;null===n||j(n,u)||console.error((i=`${n}`,`Invalid prop \`value\` of value \`${i}\` supplied to \`Progress\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or 100 if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`));let f=j(n,u)?n:null,g=p(f)?o(f,u):void 0;return(0,r.jsx)(d,{scope:l,value:f,max:u,children:(0,r.jsx)(t.Primitive.div,{"aria-valuemax":u,"aria-valuemin":0,"aria-valuenow":p(f)?f:void 0,"aria-valuetext":g,role:"progressbar","data-state":h(f,u),"data-value":f??void 0,"data-max":u,...x,ref:a})})});o.displayName=i;var x="ProgressIndicator",u=a.forwardRef((e,a)=>{let{__scopeProgress:s,...i}=e,l=c(x,s);return(0,r.jsx)(t.Primitive.div,{"data-state":h(l.value,l.max),"data-value":l.value??void 0,"data-max":l.max,...i,ref:a})});function m(e,r){return`${Math.round(e/r*100)}%`}function h(e,r){return null==e?"indeterminate":e===r?"complete":"loading"}function p(e){return"number"==typeof e}function v(e){return p(e)&&!isNaN(e)&&e>0}function j(e,r){return p(e)&&!isNaN(e)&&e<=r&&e>=0}u.displayName=x;var f=e.i(647163);function g({className:e,value:a,...s}){return(0,r.jsx)(o,{"data-slot":"progress",className:(0,f.cn)("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",e),...s,children:(0,r.jsx)(u,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:`translateX(-${100-(a||0)}%)`}})})}e.s(["Progress",()=>g],287336)},970065,e=>{"use strict";var r=e.i(843476),a=e.i(647163);function s({className:e,...s}){return(0,r.jsx)("div",{"data-slot":"card",className:(0,a.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...s})}function t({className:e,...s}){return(0,r.jsx)("div",{"data-slot":"card-header",className:(0,a.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...s})}function i({className:e,...s}){return(0,r.jsx)("div",{"data-slot":"card-title",className:(0,a.cn)("leading-none font-semibold",e),...s})}function l({className:e,...s}){return(0,r.jsx)("div",{"data-slot":"card-description",className:(0,a.cn)("text-muted-foreground text-sm",e),...s})}function n({className:e,...s}){return(0,r.jsx)("div",{"data-slot":"card-content",className:(0,a.cn)("px-6",e),...s})}function d({className:e,...s}){return(0,r.jsx)("div",{"data-slot":"card-footer",className:(0,a.cn)("flex items-center px-6 [.border-t]:pt-6",e),...s})}e.s(["Card",()=>s,"CardContent",()=>n,"CardDescription",()=>l,"CardFooter",()=>d,"CardHeader",()=>t,"CardTitle",()=>i])},994179,e=>{"use strict";var r=e.i(843476),a=e.i(991918),s=e.i(225913),t=e.i(647163);let i=(0,s.cva)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function l({className:e,variant:s,asChild:l=!1,...n}){let d=l?a.Slot:"span";return(0,r.jsx)(d,{"data-slot":"badge",className:(0,t.cn)(i({variant:s}),e),...n})}e.s(["Badge",()=>l])},63209,e=>{"use strict";let r=(0,e.i(475254).default)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["AlertCircle",()=>r],63209)},16715,e=>{"use strict";let r=(0,e.i(475254).default)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);e.s(["RefreshCw",()=>r],16715)},440160,e=>{"use strict";let r=(0,e.i(475254).default)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);e.s(["Download",()=>r],440160)},781947,e=>{"use strict";var r=e.i(843476),a=e.i(225913),s=e.i(647163);let t=(0,a.cva)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function i({className:e,variant:a,...i}){return(0,r.jsx)("div",{"data-slot":"alert",role:"alert",className:(0,s.cn)(t({variant:a}),e),...i})}function l({className:e,...a}){return(0,r.jsx)("div",{"data-slot":"alert-title",className:(0,s.cn)("col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",e),...a})}function n({className:e,...a}){return(0,r.jsx)("div",{"data-slot":"alert-description",className:(0,s.cn)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",e),...a})}e.s(["Alert",()=>i,"AlertDescription",()=>n,"AlertTitle",()=>l])},373884,e=>{"use strict";let r=(0,e.i(475254).default)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);e.s(["XCircle",()=>r],373884)},332504,e=>{"use strict";var r=e.i(843476),a=e.i(271645),s=e.i(510665),t=e.i(569074),i=e.i(440160),l=e.i(294918),n=e.i(63209),d=e.i(269638),c=e.i(373884),o=e.i(16715),x=e.i(952571),u=e.i(263488),m=e.i(167881),h=e.i(970065),p=e.i(781947),v=e.i(994179),j=e.i(287336),f=e.i(947627),g=e.i(62870),b=e.i(890538);function y(){let[e,y]=(0,a.useState)("upload"),[N,C]=(0,a.useState)(null),[w,T]=(0,a.useState)(null),[k,S]=(0,a.useState)(null),[A,_]=(0,a.useState)("update"),[E,I]=(0,a.useState)(!1),[P,D]=(0,a.useState)(!1),[H,R]=(0,a.useState)(null),M=async e=>{if((e.headers.get("content-type")||"").includes("application/json"))return e.json();let r=await e.text(),a=401===e.status&&(r.includes("_vercel_sso_nonce")||r.toLowerCase().includes("vercel"));throw Error(`${a?"Vercel está bloqueando la ruta (Deployment Protection/SSO). Desactiva la protección del deployment o permite acceso público a /api/* y redeploy.":"La API devolvió una respuesta no-JSON."} (HTTP ${e.status})`)},V=(0,a.useCallback)(async e=>{let r=e[0];if(r){C(r),R(null),I(!0);try{let e=new FormData;e.append("file",r);let a=await fetch("/api/distributors/csv/validate",{method:"POST",body:e}),s=await M(a);if(!a.ok)throw Error(s.error||"Error al validar archivo");T(s),y("preview")}catch(e){R(e instanceof Error?e.message:"Error desconocido")}finally{I(!1)}}},[]),{getRootProps:O,getInputProps:B,isDragActive:z}=(0,s.useDropzone)({onDrop:V,accept:{"text/csv":[".csv"],"application/vnd.ms-excel":[".csv"]},maxFiles:1}),F=async()=>{if(N){D(!0),y("importing"),R(null);try{let e=new FormData;e.append("file",N),e.append("mode",A);let r=await fetch("/api/distributors/csv/import",{method:"POST",body:e}),a=await M(r);if(!r.ok)throw Error(a.error||"Error al importar archivo");S(a),y("complete")}catch(e){R(e instanceof Error?e.message:"Error desconocido"),y("preview")}finally{D(!1)}}},L=()=>{y("upload"),C(null),T(null),S(null),R(null)},q=async e=>{window.open(e?"/api/distributors/csv/template?descriptions=true":"/api/distributors/csv/template","_blank")};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex flex-wrap gap-4 justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-2xl font-bold",children:"Importación de Distribuidores"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Importa distribuidores masivamente desde un archivo CSV"})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsxs)(m.Button,{variant:"outline",onClick:()=>q(!1),children:[(0,r.jsx)(i.Download,{className:"mr-2 h-4 w-4"}),"Plantilla Vacía"]}),(0,r.jsxs)(m.Button,{variant:"outline",onClick:()=>q(!0),children:[(0,r.jsx)(l.FileSpreadsheet,{className:"mr-2 h-4 w-4"}),"Plantilla con Instrucciones"]})]})]}),(0,r.jsxs)(p.Alert,{children:[(0,r.jsx)(x.Info,{className:"h-4 w-4"}),(0,r.jsx)(p.AlertTitle,{children:"Información importante"}),(0,r.jsx)(p.AlertDescription,{children:(0,r.jsxs)("ul",{className:"list-disc list-inside mt-2 space-y-1 text-sm",children:[(0,r.jsxs)("li",{children:["Los distribuidores se identifican por su ",(0,r.jsx)("strong",{children:"NIT/RIF (company_rif)"})]}),(0,r.jsxs)("li",{children:["Los nuevos distribuidores recibirán un ",(0,r.jsx)("strong",{children:"email de invitación"})," para configurar su contraseña"]}),(0,r.jsx)("li",{children:"Las direcciones de envío se gestionan por separado (cada distribuidor puede tener varias)"})]})})]}),H&&(0,r.jsxs)(p.Alert,{variant:"destructive",children:[(0,r.jsx)(n.AlertCircle,{className:"h-4 w-4"}),(0,r.jsx)(p.AlertTitle,{children:"Error"}),(0,r.jsx)(p.AlertDescription,{children:H})]}),"upload"===e&&(0,r.jsxs)(h.Card,{children:[(0,r.jsxs)(h.CardHeader,{children:[(0,r.jsx)(h.CardTitle,{children:"Subir Archivo CSV"}),(0,r.jsx)(h.CardDescription,{children:"Arrastra un archivo CSV o haz clic para seleccionar"})]}),(0,r.jsx)(h.CardContent,{children:(0,r.jsxs)("div",{...O(),className:`border-2 border-dashed rounded-lg p-12 text-center cursor-pointer transition-colors
                ${z?"border-primary bg-primary/5":"border-muted-foreground/25 hover:border-primary/50"}`,children:[(0,r.jsx)("input",{...B()}),E?(0,r.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,r.jsx)(o.RefreshCw,{className:"h-12 w-12 animate-spin text-primary"}),(0,r.jsx)("p",{children:"Validando archivo..."})]}):(0,r.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,r.jsx)(t.Upload,{className:"h-12 w-12 text-muted-foreground"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-lg font-medium",children:z?"Suelta el archivo aquí":"Arrastra tu archivo CSV aquí"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"o haz clic para seleccionar"})]})]})]})})]}),"preview"===e&&w&&(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4",children:[(0,r.jsx)(h.Card,{children:(0,r.jsxs)(h.CardContent,{className:"pt-6",children:[(0,r.jsx)("div",{className:"text-2xl font-bold",children:w.stats.total}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Total filas"})]})}),(0,r.jsx)(h.Card,{children:(0,r.jsxs)(h.CardContent,{className:"pt-6",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-green-600",children:w.stats.valid}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Válidas"})]})}),(0,r.jsx)(h.Card,{children:(0,r.jsxs)(h.CardContent,{className:"pt-6",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-red-600",children:w.stats.invalid}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Con errores"})]})}),(0,r.jsx)(h.Card,{children:(0,r.jsxs)(h.CardContent,{className:"pt-6",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:w.stats.toCreate}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"A crear"})]})}),(0,r.jsx)(h.Card,{children:(0,r.jsxs)(h.CardContent,{className:"pt-6",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-amber-600",children:w.stats.toUpdate}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"A actualizar"})]})}),(0,r.jsx)(h.Card,{children:(0,r.jsxs)(h.CardContent,{className:"pt-6",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-gray-500",children:w.stats.unchanged}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Sin cambios"})]})})]}),w.globalErrors.length>0&&(0,r.jsxs)(p.Alert,{variant:"destructive",children:[(0,r.jsx)(n.AlertCircle,{className:"h-4 w-4"}),(0,r.jsx)(p.AlertTitle,{children:"Errores en el archivo"}),(0,r.jsx)(p.AlertDescription,{children:(0,r.jsx)("ul",{className:"list-disc list-inside mt-2",children:w.globalErrors.map((e,a)=>(0,r.jsx)("li",{children:e},a))})})]}),(0,r.jsxs)(h.Card,{children:[(0,r.jsxs)(h.CardHeader,{children:[(0,r.jsx)(h.CardTitle,{children:"Vista previa de datos"}),(0,r.jsx)(h.CardDescription,{children:w.hasMore&&"Mostrando los primeros 100 registros"})]}),(0,r.jsxs)(h.CardContent,{children:[(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)(f.Table,{children:[(0,r.jsx)(f.TableHeader,{children:(0,r.jsxs)(f.TableRow,{children:[(0,r.jsx)(f.TableHead,{className:"w-16",children:"Fila"}),(0,r.jsx)(f.TableHead,{children:"Estado"}),(0,r.jsx)(f.TableHead,{children:"NIT/RIF"}),(0,r.jsx)(f.TableHead,{children:"Empresa"}),(0,r.jsx)(f.TableHead,{children:"Email"}),(0,r.jsx)(f.TableHead,{children:"Contacto"}),(0,r.jsx)(f.TableHead,{children:"Descuento"}),(0,r.jsx)(f.TableHead,{children:"Crédito"})]})}),(0,r.jsx)(f.TableBody,{children:w.distributors.map(e=>{let a=w.diffs.find(r=>r.companyRif===e.data.company_rif?.trim());return(0,r.jsxs)(f.TableRow,{className:e.isValid?"":"bg-red-50",children:[(0,r.jsx)(f.TableCell,{children:e.row}),(0,r.jsx)(f.TableCell,{children:e.isValid?a?.changeType==="create"?(0,r.jsx)(v.Badge,{className:"bg-blue-600",children:"Nuevo"}):a?.changeType==="update"?(0,r.jsx)(v.Badge,{className:"bg-amber-600",children:"Actualizar"}):(0,r.jsx)(v.Badge,{variant:"secondary",children:"Sin cambios"}):(0,r.jsx)(v.Badge,{variant:"destructive",children:"Error"})}),(0,r.jsx)(f.TableCell,{className:"font-mono text-sm",children:e.data.company_rif}),(0,r.jsx)(f.TableCell,{children:e.data.company_name}),(0,r.jsx)(f.TableCell,{children:e.data.email}),(0,r.jsx)(f.TableCell,{children:e.data.full_name}),(0,r.jsxs)(f.TableCell,{children:[e.data.discount_percentage,"%"]}),(0,r.jsxs)(f.TableCell,{children:["$",Number(e.data.credit_limit||0).toLocaleString()]})]},e.row)})})]})}),w.distributors.some(e=>e.errors.length>0)&&(0,r.jsx)(b.Accordion,{type:"single",collapsible:!0,className:"mt-4",children:(0,r.jsxs)(b.AccordionItem,{value:"errors",children:[(0,r.jsx)(b.AccordionTrigger,{className:"text-red-600",children:(0,r.jsxs)("span",{className:"flex items-center gap-2",children:[(0,r.jsx)(c.XCircle,{className:"h-4 w-4"}),"Ver errores de validación (",w.stats.invalid," filas)"]})}),(0,r.jsx)(b.AccordionContent,{children:(0,r.jsx)("div",{className:"space-y-2",children:w.distributors.filter(e=>e.errors.length>0).map(e=>(0,r.jsxs)("div",{className:"p-3 bg-red-50 rounded-md",children:[(0,r.jsxs)("p",{className:"font-medium",children:["Fila ",e.row,": ",e.data.company_name||"Sin nombre"]}),(0,r.jsx)("ul",{className:"text-sm text-red-600 mt-1",children:e.errors.map((e,a)=>(0,r.jsxs)("li",{children:["• ",e.field,": ",e.message]},a))})]},e.row))})})]})})]})]}),(0,r.jsxs)(h.Card,{children:[(0,r.jsx)(h.CardHeader,{children:(0,r.jsx)(h.CardTitle,{children:"Opciones de importación"})}),(0,r.jsxs)(h.CardContent,{children:[(0,r.jsxs)("div",{className:"flex flex-wrap gap-4 items-end",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-sm font-medium",children:"Modo de importación"}),(0,r.jsxs)(g.Select,{value:A,onValueChange:e=>_(e),children:[(0,r.jsx)(g.SelectTrigger,{className:"w-[250px]",children:(0,r.jsx)(g.SelectValue,{})}),(0,r.jsxs)(g.SelectContent,{children:[(0,r.jsx)(g.SelectItem,{value:"update",children:"Crear nuevos y actualizar existentes"}),(0,r.jsx)(g.SelectItem,{value:"add_only",children:"Solo crear nuevos"})]})]})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(m.Button,{variant:"outline",onClick:L,children:"Cancelar"}),(0,r.jsxs)(m.Button,{onClick:F,disabled:w.stats.invalid>0,children:[(0,r.jsx)(t.Upload,{className:"mr-2 h-4 w-4"}),"Importar ",w.stats.valid," distribuidores"]})]})]}),w.stats.invalid>0&&(0,r.jsx)("p",{className:"text-sm text-red-600 mt-2",children:"Corrige los errores antes de importar"})]})]})]}),"importing"===e&&(0,r.jsx)(h.Card,{children:(0,r.jsx)(h.CardContent,{className:"pt-6",children:(0,r.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,r.jsx)(o.RefreshCw,{className:"h-12 w-12 animate-spin text-primary"}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("p",{className:"text-lg font-medium",children:"Importando distribuidores..."}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Por favor no cierres esta página"})]}),(0,r.jsx)(j.Progress,{value:50,className:"w-full max-w-md"})]})})}),"complete"===e&&k&&(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)(p.Alert,{className:k.success?"border-green-500":"border-amber-500",children:[k.success?(0,r.jsx)(d.CheckCircle,{className:"h-4 w-4 text-green-500"}):(0,r.jsx)(n.AlertCircle,{className:"h-4 w-4 text-amber-500"}),(0,r.jsx)(p.AlertTitle,{children:k.success?"Importación completada":"Importación completada con errores"}),(0,r.jsx)(p.AlertDescription,{children:(0,r.jsxs)("div",{className:"mt-2 space-y-1",children:[(0,r.jsxs)("p",{children:["• ",(0,r.jsx)("strong",{children:k.created})," distribuidores creados"]}),(0,r.jsxs)("p",{children:["• ",(0,r.jsx)("strong",{children:k.updated})," distribuidores actualizados"]}),(0,r.jsxs)("p",{children:["• ",(0,r.jsx)("strong",{children:k.skipped})," sin cambios/omitidos"]}),k.invited>0&&(0,r.jsxs)("p",{className:"flex items-center gap-1",children:[(0,r.jsx)(u.Mail,{className:"h-4 w-4"}),(0,r.jsx)("strong",{children:k.invited})," invitaciones enviadas por email"]}),k.errors.length>0&&(0,r.jsxs)("p",{className:"text-red-600",children:["• ",(0,r.jsx)("strong",{children:k.errors.length})," errores"]})]})})]}),k.errors.length>0&&(0,r.jsxs)(h.Card,{children:[(0,r.jsx)(h.CardHeader,{children:(0,r.jsx)(h.CardTitle,{className:"text-red-600",children:"Errores durante la importación"})}),(0,r.jsx)(h.CardContent,{children:(0,r.jsxs)("div",{className:"space-y-2",children:[k.errors.map((e,a)=>(0,r.jsxs)("div",{className:"p-3 bg-red-50 rounded-md",children:[(0,r.jsxs)("p",{className:"font-medium",children:["Fila ",e.row,": ",e.companyRif]}),(0,r.jsx)("p",{className:"text-sm text-red-600",children:e.error})]},a)),k.hasMoreErrors&&(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Hay más errores que no se muestran aquí"})]})})]}),(0,r.jsx)("div",{className:"flex gap-2",children:(0,r.jsxs)(m.Button,{onClick:L,children:[(0,r.jsx)(o.RefreshCw,{className:"mr-2 h-4 w-4"}),"Nueva importación"]})})]})]})}e.s(["CSVDistributorManager",()=>y])}]);