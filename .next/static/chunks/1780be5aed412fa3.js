(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,10708,e=>{"use strict";var a=e.i(843476),t=e.i(271645),l=e.i(248425),s=t.forwardRef((e,t)=>(0,a.jsx)(l.Primitive.label,{...e,ref:t,onMouseDown:a=>{a.target.closest("button, input, select, textarea")||(e.onMouseDown?.(a),!a.defaultPrevented&&a.detail>1&&a.preventDefault())}}));s.displayName="Label";var r=e.i(647163);function i({className:e,...t}){return(0,a.jsx)(s,{"data-slot":"label",className:(0,r.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...t})}e.s(["Label",()=>i],10708)},470152,e=>{"use strict";function a(e,[a,t]){return Math.min(t,Math.max(a,e))}e.s(["clamp",()=>a])},994179,e=>{"use strict";var a=e.i(843476),t=e.i(991918),l=e.i(225913),s=e.i(647163);let r=(0,l.cva)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function i({className:e,variant:l,asChild:i=!1,...n}){let c=i?t.Slot:"span";return(0,a.jsx)(c,{"data-slot":"badge",className:(0,s.cn)(r({variant:l}),e),...n})}e.s(["Badge",()=>i])},947627,e=>{"use strict";var a=e.i(843476),t=e.i(647163);function l({className:e,...l}){return(0,a.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,a.jsx)("table",{"data-slot":"table",className:(0,t.cn)("w-full caption-bottom text-sm",e),...l})})}function s({className:e,...l}){return(0,a.jsx)("thead",{"data-slot":"table-header",className:(0,t.cn)("[&_tr]:border-b",e),...l})}function r({className:e,...l}){return(0,a.jsx)("tbody",{"data-slot":"table-body",className:(0,t.cn)("[&_tr:last-child]:border-0",e),...l})}function i({className:e,...l}){return(0,a.jsx)("tfoot",{"data-slot":"table-footer",className:(0,t.cn)("bg-muted/50 border-t font-medium [&>tr]:last:border-b-0",e),...l})}function n({className:e,...l}){return(0,a.jsx)("tr",{"data-slot":"table-row",className:(0,t.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...l})}function c({className:e,...l}){return(0,a.jsx)("th",{"data-slot":"table-head",className:(0,t.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...l})}function o({className:e,...l}){return(0,a.jsx)("td",{"data-slot":"table-cell",className:(0,t.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...l})}function d({className:e,...l}){return(0,a.jsx)("caption",{"data-slot":"table-caption",className:(0,t.cn)("text-muted-foreground mt-4 text-sm",e),...l})}e.s(["Table",()=>l,"TableBody",()=>r,"TableCaption",()=>d,"TableCell",()=>o,"TableFooter",()=>i,"TableHead",()=>c,"TableHeader",()=>s,"TableRow",()=>n])},488844,e=>{"use strict";let a=(0,e.i(475254).default)("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);e.s(["Package",()=>a],488844)},323585,e=>{"use strict";let a=(0,e.i(475254).default)("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);e.s(["MoreVertical",()=>a],323585)},107233,e=>{"use strict";let a=(0,e.i(475254).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>a],107233)},727612,e=>{"use strict";let a=(0,e.i(475254).default)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);e.s(["Trash2",()=>a],727612)},788699,e=>{"use strict";let a=(0,e.i(475254).default)("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);e.s(["Pencil",()=>a],788699)},878894,e=>{"use strict";let a=(0,e.i(475254).default)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);e.s(["AlertTriangle",()=>a],878894)},847314,e=>{"use strict";var a=e.i(843476),t=e.i(271645),l=e.i(618566),s=e.i(920755),r=e.i(167881),i=e.i(23750),n=e.i(947627),c=e.i(463415),o=e.i(630374),d=e.i(10708),u=e.i(994179),m=e.i(555436),x=e.i(323585),h=e.i(788699),p=e.i(107233),j=e.i(727612),b=e.i(878894),v=e.i(488844),g=e.i(62870),f=e.i(657688),y=e.i(522016);function N({initialProducts:e,silos:N,subcategories:w,collections:T}){let S=(0,l.useRouter)(),[C,_]=(0,t.useState)(e),[k,M]=(0,t.useState)(""),[P,D]=(0,t.useState)("all"),[I,B]=(0,t.useState)("all"),[A,H]=(0,t.useState)("all"),[E,L]=(0,t.useState)("all"),[V,F]=(0,t.useState)(null),[z,R]=(0,t.useState)(!1),[q,O]=(0,t.useState)(""),[$,K]=(0,t.useState)("0"),[U,G]=(0,t.useState)(!1),J=Array.from(new Set(C.map(e=>e.marca).filter(e=>!!e))).sort(),Q=Array.from(new Set(C.map(e=>e.nombre_coleccion).filter(e=>!!e))).sort(),W=C.filter(e=>{let a=k.toLowerCase(),t=!a||e.pdt_codigo?.toLowerCase().includes(a)||e.pdt_descripcion?.toLowerCase().includes(a)||e.nombre_comercial?.toLowerCase().includes(a)||e.marca?.toLowerCase().includes(a),l="all"===P||e.marca===P,s="all"===I||e.nombre_coleccion===I,r=!0;return"descontinuado"===E?r=!0===e.descontinuado:"pedido_camino"===E?r=!0===e.pedido_en_camino:"activo"===E?r=!0===e.is_active:"inactivo"===E&&(r=!1===e.is_active),t&&l&&s&&"all"===A&&r}),X=async()=>{if(!V)return;G(!0);let e=(0,s.createClient)(),a=Number.parseFloat(q),t=Number.parseFloat($),l=t>0,{error:r}=await e.from("products").update({precio:a,descuento_porcentaje:t,is_on_sale:l,updated_at:new Date().toISOString()}).eq("id",V.id);r?(console.error("[v0] Error updating price:",r),alert("Error al actualizar el precio")):(_(e=>e.map(e=>e.id===V.id?{...e,precio:a,descuento_porcentaje:t,is_on_sale:l}:e)),R(!1),F(null)),G(!1)},Y=async e=>{if(!confirm("¿Estás seguro de que deseas eliminar este producto?"))return;G(!0);let a=(0,s.createClient)(),{error:t}=await a.from("products").delete().eq("id",e);t?(console.error("[v0] Error deleting product:",t),alert("Error al eliminar el producto")):_(a=>a.filter(a=>a.id!==e)),G(!1)};return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"relative flex-1",children:[(0,a.jsx)(m.Search,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,a.jsx)(i.Input,{placeholder:"Buscar por SKU, descripción, nombre o marca...",value:k,onChange:e=>M(e.target.value),className:"pl-10"})]}),(0,a.jsx)(r.Button,{asChild:!0,children:(0,a.jsxs)(y.default,{href:"/admin/products/nuevo",children:[(0,a.jsx)(p.Plus,{className:"mr-2 h-4 w-4"}),"Agregar Producto"]})})]}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,a.jsxs)(g.Select,{value:P,onValueChange:D,children:[(0,a.jsx)(g.SelectTrigger,{className:"w-[180px]",children:(0,a.jsx)(g.SelectValue,{placeholder:"Marca"})}),(0,a.jsxs)(g.SelectContent,{children:[(0,a.jsx)(g.SelectItem,{value:"all",children:"Todas las marcas"}),J.map(e=>(0,a.jsx)(g.SelectItem,{value:e,children:e},e))]})]}),(0,a.jsxs)(g.Select,{value:I,onValueChange:B,children:[(0,a.jsx)(g.SelectTrigger,{className:"w-[180px]",children:(0,a.jsx)(g.SelectValue,{placeholder:"Colección"})}),(0,a.jsxs)(g.SelectContent,{children:[(0,a.jsx)(g.SelectItem,{value:"all",children:"Todas las colecciones"}),Q.map(e=>(0,a.jsx)(g.SelectItem,{value:e,children:e},e))]})]}),(0,a.jsxs)(g.Select,{value:E,onValueChange:L,children:[(0,a.jsx)(g.SelectTrigger,{className:"w-[180px]",children:(0,a.jsx)(g.SelectValue,{placeholder:"Estado"})}),(0,a.jsxs)(g.SelectContent,{children:[(0,a.jsx)(g.SelectItem,{value:"all",children:"Todos los estados"}),(0,a.jsx)(g.SelectItem,{value:"activo",children:"Activos"}),(0,a.jsx)(g.SelectItem,{value:"inactivo",children:"Inactivos"}),(0,a.jsx)(g.SelectItem,{value:"descontinuado",children:"Descontinuados"}),(0,a.jsx)(g.SelectItem,{value:"pedido_camino",children:"Pedido en camino"})]})]}),("all"!==P||"all"!==I||"all"!==E)&&(0,a.jsx)(r.Button,{variant:"ghost",size:"sm",onClick:()=>{D("all"),B("all"),L("all")},children:"Limpiar filtros"}),(0,a.jsxs)("div",{className:"ml-auto text-sm text-muted-foreground",children:[W.length," de ",C.length," productos"]})]})]}),(0,a.jsx)("div",{className:"rounded-md border",children:(0,a.jsxs)(n.Table,{children:[(0,a.jsx)(n.TableHeader,{children:(0,a.jsxs)(n.TableRow,{children:[(0,a.jsx)(n.TableHead,{className:"w-[80px]",children:"Imagen"}),(0,a.jsx)(n.TableHead,{children:"SKU"}),(0,a.jsx)(n.TableHead,{children:"Producto"}),(0,a.jsx)(n.TableHead,{children:"Marca"}),(0,a.jsx)(n.TableHead,{children:"Colección"}),(0,a.jsx)(n.TableHead,{children:"Precio"}),(0,a.jsx)(n.TableHead,{children:"Descuento"}),(0,a.jsx)(n.TableHead,{children:"Stock"}),(0,a.jsx)(n.TableHead,{children:"Estado"}),(0,a.jsx)(n.TableHead,{className:"w-[80px]",children:"Acciones"})]})}),(0,a.jsx)(n.TableBody,{children:0===W.length?(0,a.jsx)(n.TableRow,{children:(0,a.jsx)(n.TableCell,{colSpan:10,className:"h-24 text-center",children:"No se encontraron productos."})}):W.map(e=>(0,a.jsxs)(n.TableRow,{children:[(0,a.jsx)(n.TableCell,{children:(0,a.jsx)("div",{className:"relative h-12 w-12 overflow-hidden rounded-md border",children:e.imagen_principal_url?(0,a.jsx)(f.default,{src:e.imagen_principal_url,alt:e.nombre_comercial||e.pdt_descripcion||"Producto",fill:!0,className:"object-cover",unoptimized:!0,onError:e=>{e.target.style.display="none"}}):(0,a.jsx)("div",{className:"flex h-full w-full items-center justify-center bg-muted text-xs text-muted-foreground",children:"Sin imagen"})})}),(0,a.jsx)(n.TableCell,{className:"font-mono text-sm",children:e.pdt_codigo}),(0,a.jsx)(n.TableCell,{children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:e.nombre_comercial||e.pdt_descripcion}),e.nombre_comercial&&(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:e.pdt_descripcion}),(0,a.jsxs)("div",{className:"flex gap-1 mt-1",children:[e.descontinuado&&(0,a.jsxs)(u.Badge,{variant:"destructive",className:"text-xs",children:[(0,a.jsx)(b.AlertTriangle,{className:"h-3 w-3 mr-1"}),"Descontinuado"]}),e.pedido_en_camino&&(0,a.jsxs)(u.Badge,{variant:"secondary",className:"text-xs",children:[(0,a.jsx)(v.Package,{className:"h-3 w-3 mr-1"}),"En camino"]})]})]})}),(0,a.jsx)(n.TableCell,{children:(0,a.jsx)("span",{className:"text-sm",children:e.marca||"-"})}),(0,a.jsx)(n.TableCell,{children:(0,a.jsx)("span",{className:"text-sm",children:e.nombre_coleccion||"-"})}),(0,a.jsx)(n.TableCell,{children:e.precio?(0,a.jsxs)("div",{className:"font-medium",children:["$",e.precio]}):(0,a.jsx)("span",{className:"text-muted-foreground",children:"-"})}),(0,a.jsx)(n.TableCell,{children:e.descuento_porcentaje&&e.descuento_porcentaje>0?(0,a.jsxs)(u.Badge,{variant:"secondary",className:"text-xs",children:[e.descuento_porcentaje,"% OFF"]}):(0,a.jsx)("span",{className:"text-muted-foreground",children:"-"})}),(0,a.jsx)(n.TableCell,{children:(0,a.jsx)(u.Badge,{variant:e.upp_existencia>0?"default":"secondary",children:e.upp_existencia})}),(0,a.jsx)(n.TableCell,{children:(0,a.jsx)(u.Badge,{variant:e.is_active?"default":"secondary",children:e.is_active?"Activo":"Inactivo"})}),(0,a.jsx)(n.TableCell,{children:(0,a.jsxs)(c.DropdownMenu,{children:[(0,a.jsx)(c.DropdownMenuTrigger,{asChild:!0,children:(0,a.jsx)(r.Button,{variant:"ghost",size:"icon",children:(0,a.jsx)(x.MoreVertical,{className:"h-4 w-4"})})}),(0,a.jsxs)(c.DropdownMenuContent,{align:"end",children:[(0,a.jsxs)(c.DropdownMenuItem,{onClick:()=>{F(e),O(e.precio?.toString()||"0"),K(e.descuento_porcentaje?.toString()||"0"),R(!0)},children:[(0,a.jsx)(h.Pencil,{className:"mr-2 h-4 w-4"}),"Editar Precio y Descuento"]}),(0,a.jsxs)(c.DropdownMenuItem,{onClick:()=>S.push(`/admin/products/${e.id}/editar`),children:[(0,a.jsx)(h.Pencil,{className:"mr-2 h-4 w-4"}),"Edición Avanzada"]}),(0,a.jsxs)(c.DropdownMenuItem,{onClick:()=>Y(e.id),className:"text-destructive",children:[(0,a.jsx)(j.Trash2,{className:"mr-2 h-4 w-4"}),"Eliminar"]})]})]})})]},e.id))})]})}),(0,a.jsx)(o.Dialog,{open:z,onOpenChange:R,children:(0,a.jsxs)(o.DialogContent,{children:[(0,a.jsxs)(o.DialogHeader,{children:[(0,a.jsx)(o.DialogTitle,{children:"Editar Precio y Descuento"}),(0,a.jsx)(o.DialogDescription,{children:V?.nombre_comercial||V?.pdt_descripcion})]}),(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{htmlFor:"price",children:"Precio ($)"}),(0,a.jsx)(i.Input,{id:"price",type:"number",step:"0.01",value:q,onChange:e=>O(e.target.value),placeholder:"0.00"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{htmlFor:"discount",children:"Descuento (%)"}),(0,a.jsx)(i.Input,{id:"discount",type:"number",step:"1",min:"0",max:"100",value:$,onChange:e=>K(e.target.value),placeholder:"0"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Si el descuento es mayor que 0, el producto aparecerá en Ofertas"})]}),Number.parseFloat($)>0&&Number.parseFloat(q)>0&&(0,a.jsxs)("div",{className:"rounded-md bg-muted p-3",children:[(0,a.jsx)("div",{className:"text-sm font-medium",children:"Precio con descuento:"}),(0,a.jsxs)("div",{className:"text-2xl font-bold text-primary",children:["$",(Number.parseFloat(q)*(1-Number.parseFloat($)/100)).toLocaleString()]}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground line-through",children:["$",Number.parseFloat(q).toLocaleString()]})]})]}),(0,a.jsxs)(o.DialogFooter,{children:[(0,a.jsx)(r.Button,{variant:"outline",onClick:()=>R(!1),disabled:U,children:"Cancelar"}),(0,a.jsx)(r.Button,{onClick:X,disabled:U,children:U?"Guardando...":"Guardar Cambios"})]})]})})]})}e.s(["ProductsManagement",()=>N])}]);