(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,47627,e=>{"use strict";var a=e.i(43476),l=e.i(47163);function i({className:e,...i}){return(0,a.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,a.jsx)("table",{"data-slot":"table",className:(0,l.cn)("w-full caption-bottom text-sm",e),...i})})}function s({className:e,...i}){return(0,a.jsx)("thead",{"data-slot":"table-header",className:(0,l.cn)("[&_tr]:border-b",e),...i})}function t({className:e,...i}){return(0,a.jsx)("tbody",{"data-slot":"table-body",className:(0,l.cn)("[&_tr:last-child]:border-0",e),...i})}function r({className:e,...i}){return(0,a.jsx)("tr",{"data-slot":"table-row",className:(0,l.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...i})}function n({className:e,...i}){return(0,a.jsx)("th",{"data-slot":"table-head",className:(0,l.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...i})}function c({className:e,...i}){return(0,a.jsx)("td",{"data-slot":"table-cell",className:(0,l.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...i})}e.s(["Table",()=>i,"TableBody",()=>t,"TableCell",()=>c,"TableHead",()=>n,"TableHeader",()=>s,"TableRow",()=>r])},27612,e=>{"use strict";let a=(0,e.i(75254).default)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);e.s(["Trash2",()=>a],27612)},23585,88699,e=>{"use strict";var a=e.i(75254);let l=(0,a.default)("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);e.s(["MoreVertical",()=>l],23585);let i=(0,a.default)("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);e.s(["Pencil",()=>i],88699)},61911,e=>{"use strict";let a=(0,e.i(75254).default)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);e.s(["Users",()=>a],61911)},31969,e=>{"use strict";var a=e.i(43476),l=e.i(71645),i=e.i(20755),s=e.i(67881),t=e.i(23750),r=e.i(94179),n=e.i(47627),c=e.i(30374),o=e.i(63415),d=e.i(10708),h=e.i(84762),u=e.i(62870),m=e.i(7233),x=e.i(55436),p=e.i(23585),j=e.i(61911),g=e.i(88699),b=e.i(27612),v=e.i(18566);function C(){let e=(0,v.useRouter)(),[C,_]=(0,l.useState)([]),[y,f]=(0,l.useState)([]),[N,T]=(0,l.useState)(""),[w,k]=(0,l.useState)(!0),[S,I]=(0,l.useState)(!1),[L,F]=(0,l.useState)(!1),[D,z]=(0,l.useState)(null),[M,H]=(0,l.useState)({razon_social:"",nit:"",pais:"Colombia",descuento_general:0,limite_credito:0,is_active:!0});async function B(){let e=(0,i.createClient)(),{data:a,error:l}=await e.from("companies").select(`
        *,
        contacts:company_contacts(*),
        distributor:distributors(*, profile:user_profiles(*))
      `).order("razon_social",{ascending:!0});!l&&a&&_(a),k(!1)}async function E(){let e=(0,i.createClient)(),{data:a}=await e.from("distributors").select("*, profile:user_profiles(*)").eq("is_active",!0);a&&f(a)}async function P(){let e=(0,i.createClient)(),{data:{user:a}}=await e.auth.getUser();if(D){let{error:l}=await e.from("companies").update({...M,updated_by:a?.id}).eq("id",D.id);l||(await B(),I(!1),V())}else{let{error:l}=await e.from("companies").insert([{...M,created_by:a?.id}]);l||(await B(),I(!1),V())}}async function R(e){if(!confirm("¿Está seguro de eliminar este cliente?"))return;let a=(0,i.createClient)(),{error:l}=await a.from("companies").delete().eq("id",e);l||await B()}function V(){H({razon_social:"",nit:"",pais:"Colombia",descuento_general:0,limite_credito:0,is_active:!0}),z(null)}function U(a){z(a),e.push(`/admin/clients/${a.id}/contacts`)}(0,l.useEffect)(()=>{B(),E()},[]);let A=C.filter(e=>e.razon_social?.toLowerCase().includes(N.toLowerCase())||e.nit?.includes(N)||e.email_principal?.toLowerCase().includes(N.toLowerCase()));return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,a.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,a.jsx)(x.Search,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,a.jsx)(t.Input,{placeholder:"Buscar por razón social, NIT o email...",value:N,onChange:e=>T(e.target.value),className:"pl-10"})]}),(0,a.jsxs)(s.Button,{onClick:()=>I(!0),children:[(0,a.jsx)(m.Plus,{className:"mr-2 h-4 w-4"}),"Agregar Cliente"]})]}),(0,a.jsx)("div",{className:"rounded-md border",children:(0,a.jsxs)(n.Table,{children:[(0,a.jsx)(n.TableHeader,{children:(0,a.jsxs)(n.TableRow,{children:[(0,a.jsx)(n.TableHead,{children:"Razón Social"}),(0,a.jsx)(n.TableHead,{children:"NIT"}),(0,a.jsx)(n.TableHead,{children:"Ciudad"}),(0,a.jsx)(n.TableHead,{children:"Distribuidor Asignado"}),(0,a.jsx)(n.TableHead,{children:"Contactos"}),(0,a.jsx)(n.TableHead,{children:"Crédito"}),(0,a.jsx)(n.TableHead,{children:"Estado"}),(0,a.jsx)(n.TableHead,{className:"w-[50px]"})]})}),(0,a.jsx)(n.TableBody,{children:A.map(e=>(0,a.jsxs)(n.TableRow,{children:[(0,a.jsx)(n.TableCell,{className:"font-medium",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{children:e.razon_social}),e.nombre_comercial&&(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:e.nombre_comercial})]})}),(0,a.jsx)(n.TableCell,{children:e.nit}),(0,a.jsx)(n.TableCell,{children:e.ciudad||"-"}),(0,a.jsx)(n.TableCell,{children:e.distributor?.profile?.full_name||"-"}),(0,a.jsx)(n.TableCell,{children:(0,a.jsxs)(s.Button,{variant:"ghost",size:"sm",onClick:()=>U(e),children:[(0,a.jsx)(j.Users,{className:"mr-2 h-4 w-4"}),e.contacts?.length||0]})}),(0,a.jsxs)(n.TableCell,{children:["$",e.limite_credito.toLocaleString()]}),(0,a.jsx)(n.TableCell,{children:(0,a.jsx)(r.Badge,{variant:e.is_active?"default":"secondary",children:e.is_active?"Activo":"Inactivo"})}),(0,a.jsx)(n.TableCell,{children:(0,a.jsxs)(o.DropdownMenu,{children:[(0,a.jsx)(o.DropdownMenuTrigger,{asChild:!0,children:(0,a.jsx)(s.Button,{variant:"ghost",size:"icon",children:(0,a.jsx)(p.MoreVertical,{className:"h-4 w-4"})})}),(0,a.jsxs)(o.DropdownMenuContent,{align:"end",children:[(0,a.jsxs)(o.DropdownMenuItem,{onClick:()=>{z(e),H(e),I(!0)},children:[(0,a.jsx)(g.Pencil,{className:"mr-2 h-4 w-4"}),"Editar"]}),(0,a.jsxs)(o.DropdownMenuItem,{onClick:()=>U(e),children:[(0,a.jsx)(j.Users,{className:"mr-2 h-4 w-4"}),"Gestionar Contactos"]}),(0,a.jsxs)(o.DropdownMenuItem,{onClick:()=>R(e.id),className:"text-red-600",children:[(0,a.jsx)(b.Trash2,{className:"mr-2 h-4 w-4"}),"Eliminar"]})]})]})})]},e.id))})]})}),(0,a.jsx)(c.Dialog,{open:S,onOpenChange:I,children:(0,a.jsxs)(c.DialogContent,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)(c.DialogHeader,{children:[(0,a.jsx)(c.DialogTitle,{children:D?"Editar Cliente":"Nuevo Cliente"}),(0,a.jsx)(c.DialogDescription,{children:"Complete la información del cliente empresarial"})]}),(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{htmlFor:"razon_social",children:"Razón Social *"}),(0,a.jsx)(t.Input,{id:"razon_social",value:M.razon_social,onChange:e=>H({...M,razon_social:e.target.value})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{htmlFor:"nit",children:"NIT *"}),(0,a.jsx)(t.Input,{id:"nit",value:M.nit,onChange:e=>H({...M,nit:e.target.value})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{htmlFor:"nombre_comercial",children:"Nombre Comercial"}),(0,a.jsx)(t.Input,{id:"nombre_comercial",value:M.nombre_comercial||"",onChange:e=>H({...M,nombre_comercial:e.target.value})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{htmlFor:"tipo_empresa",children:"Tipo de Empresa"}),(0,a.jsx)(t.Input,{id:"tipo_empresa",value:M.tipo_empresa||"",onChange:e=>H({...M,tipo_empresa:e.target.value}),placeholder:"Restaurante, Hotel, etc."})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{htmlFor:"direccion",children:"Dirección"}),(0,a.jsx)(h.Textarea,{id:"direccion",value:M.direccion||"",onChange:e=>H({...M,direccion:e.target.value})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{htmlFor:"ciudad",children:"Ciudad"}),(0,a.jsx)(t.Input,{id:"ciudad",value:M.ciudad||"",onChange:e=>H({...M,ciudad:e.target.value}),placeholder:"Ej: Bogotá"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{htmlFor:"estado",children:"Departamento"}),(0,a.jsx)(t.Input,{id:"estado",value:M.estado||"",onChange:e=>H({...M,estado:e.target.value}),placeholder:"Ej: Cundinamarca"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{htmlFor:"codigo_postal",children:"Código Postal"}),(0,a.jsx)(t.Input,{id:"codigo_postal",value:M.codigo_postal||"",onChange:e=>H({...M,codigo_postal:e.target.value})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{htmlFor:"pais",children:"País"}),(0,a.jsx)(t.Input,{id:"pais",value:M.pais||"Colombia",onChange:e=>H({...M,pais:e.target.value})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{htmlFor:"telefono_principal",children:"Teléfono Principal"}),(0,a.jsx)(t.Input,{id:"telefono_principal",value:M.telefono_principal||"",onChange:e=>H({...M,telefono_principal:e.target.value})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{htmlFor:"email_principal",children:"Email Principal"}),(0,a.jsx)(t.Input,{id:"email_principal",type:"email",value:M.email_principal||"",onChange:e=>H({...M,email_principal:e.target.value})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{htmlFor:"terminos_pago",children:"Términos de Pago"}),(0,a.jsxs)(u.Select,{value:M.terminos_pago||"",onValueChange:e=>H({...M,terminos_pago:e}),children:[(0,a.jsx)(u.SelectTrigger,{children:(0,a.jsx)(u.SelectValue,{placeholder:"Seleccionar..."})}),(0,a.jsxs)(u.SelectContent,{children:[(0,a.jsx)(u.SelectItem,{value:"Contado",children:"Contado"}),(0,a.jsx)(u.SelectItem,{value:"15 días",children:"15 días"}),(0,a.jsx)(u.SelectItem,{value:"30 días",children:"30 días"}),(0,a.jsx)(u.SelectItem,{value:"45 días",children:"45 días"}),(0,a.jsx)(u.SelectItem,{value:"60 días",children:"60 días"}),(0,a.jsx)(u.SelectItem,{value:"90 días",children:"90 días"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{htmlFor:"descuento_general",children:"Descuento General (%)"}),(0,a.jsx)(t.Input,{id:"descuento_general",type:"number",step:"0.01",value:M.descuento_general||0,onChange:e=>H({...M,descuento_general:Number.parseFloat(e.target.value)})})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{htmlFor:"limite_credito",children:"Límite de Crédito"}),(0,a.jsx)(t.Input,{id:"limite_credito",type:"number",step:"0.01",value:M.limite_credito||0,onChange:e=>H({...M,limite_credito:Number.parseFloat(e.target.value)})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{htmlFor:"distribuidor_asignado_id",children:"Distribuidor Asignado"}),(0,a.jsxs)(u.Select,{value:M.distribuidor_asignado_id||"",onValueChange:e=>H({...M,distribuidor_asignado_id:e}),children:[(0,a.jsx)(u.SelectTrigger,{children:(0,a.jsx)(u.SelectValue,{placeholder:"Seleccionar distribuidor..."})}),(0,a.jsx)(u.SelectContent,{children:y.map(e=>(0,a.jsx)(u.SelectItem,{value:e.id,children:e.profile?.full_name||e.company_name},e.id))})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{htmlFor:"notas",children:"Notas"}),(0,a.jsx)(h.Textarea,{id:"notas",value:M.notas||"",onChange:e=>H({...M,notas:e.target.value}),rows:3})]})]}),(0,a.jsxs)(c.DialogFooter,{children:[(0,a.jsx)(s.Button,{variant:"outline",onClick:()=>{I(!1),V()},children:"Cancelar"}),(0,a.jsx)(s.Button,{onClick:P,children:"Guardar Cliente"})]})]})})]})}e.s(["ClientsManagement",()=>C])}]);