(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,27612,e=>{"use strict";let r=(0,e.i(75254).default)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);e.s(["Trash2",()=>r],27612)},47627,e=>{"use strict";var r=e.i(43476),a=e.i(47163);function t({className:e,...t}){return(0,r.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,r.jsx)("table",{"data-slot":"table",className:(0,a.cn)("w-full caption-bottom text-sm",e),...t})})}function s({className:e,...t}){return(0,r.jsx)("thead",{"data-slot":"table-header",className:(0,a.cn)("[&_tr]:border-b",e),...t})}function i({className:e,...t}){return(0,r.jsx)("tbody",{"data-slot":"table-body",className:(0,a.cn)("[&_tr:last-child]:border-0",e),...t})}function l({className:e,...t}){return(0,r.jsx)("tr",{"data-slot":"table-row",className:(0,a.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...t})}function n({className:e,...t}){return(0,r.jsx)("th",{"data-slot":"table-head",className:(0,a.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}function o({className:e,...t}){return(0,r.jsx)("td",{"data-slot":"table-cell",className:(0,a.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}e.s(["Table",()=>t,"TableBody",()=>i,"TableCell",()=>o,"TableHead",()=>n,"TableHeader",()=>s,"TableRow",()=>l])},78745,e=>{"use strict";let r=(0,e.i(75254).default)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);e.s(["default",()=>r])},78784,e=>{"use strict";var r=e.i(78745);e.s(["CheckIcon",()=>r.default])},10708,e=>{"use strict";var r=e.i(43476),a=e.i(71645),t=e.i(48425),s=a.forwardRef((e,a)=>(0,r.jsx)(t.Primitive.label,{...e,ref:a,onMouseDown:r=>{r.target.closest("button, input, select, textarea")||(e.onMouseDown?.(r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));s.displayName="Label";var i=e.i(47163);function l({className:e,...a}){return(0,r.jsx)(s,{"data-slot":"label",className:(0,i.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...a})}e.s(["Label",()=>l],10708)},35804,e=>{"use strict";var r=e.i(71645),a=e.i(34620);function t(e){let[t,s]=r.useState(void 0);return(0,a.useLayoutEffect)(()=>{if(e){s({width:e.offsetWidth,height:e.offsetHeight});let r=new ResizeObserver(r=>{let a,t;if(!Array.isArray(r)||!r.length)return;let i=r[0];if("borderBoxSize"in i){let e=i.borderBoxSize,r=Array.isArray(e)?e[0]:e;a=r.inlineSize,t=r.blockSize}else a=e.offsetWidth,t=e.offsetHeight;s({width:a,height:t})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}s(void 0)},[e]),t}e.s(["useSize",()=>t])},94179,e=>{"use strict";var r=e.i(43476),a=e.i(91918),t=e.i(25913),s=e.i(47163);let i=(0,t.cva)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function l({className:e,variant:t,asChild:l=!1,...n}){let o=l?a.Slot:"span";return(0,r.jsx)(o,{"data-slot":"badge",className:(0,s.cn)(i({variant:t}),e),...n})}e.s(["Badge",()=>l])},7233,e=>{"use strict";let r=(0,e.i(75254).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>r],7233)},23585,88699,e=>{"use strict";var r=e.i(75254);let a=(0,r.default)("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);e.s(["MoreVertical",()=>a],23585);let t=(0,r.default)("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);e.s(["Pencil",()=>t],88699)},47314,e=>{"use strict";var r=e.i(43476),a=e.i(71645),t=e.i(18566),s=e.i(20755),i=e.i(67881),l=e.i(23750),n=e.i(47627),o=e.i(63415),d=e.i(30374),c=e.i(10708),u=e.i(94179),x=e.i(55436),h=e.i(23585),m=e.i(88699),p=e.i(7233),b=e.i(27612),f=e.i(57688),v=e.i(22016);function g({initialProducts:e,silos:g,subcategories:j,collections:y}){(0,t.useRouter)();let[N,w]=(0,a.useState)(e),[T,C]=(0,a.useState)(""),[k,_]=(0,a.useState)(null),[S,D]=(0,a.useState)(!1),[P,M]=(0,a.useState)(""),[B,H]=(0,a.useState)("0"),[E,L]=(0,a.useState)(!1),z=N.filter(e=>{let r=T.toLowerCase();return e.pdt_codigo?.toLowerCase().includes(r)||e.pdt_descripcion?.toLowerCase().includes(r)||e.nombre_comercial?.toLowerCase().includes(r)}),A=async()=>{if(!k)return;L(!0);let e=(0,s.createClient)(),r=Number.parseFloat(P),a=Number.parseFloat(B)>0,{error:t}=await e.from("products").update({precio:r,is_on_sale:a,updated_at:new Date().toISOString()}).eq("id",k.id);t?(console.error("[v0] Error updating price:",t),alert("Error al actualizar el precio")):(w(e=>e.map(e=>e.id===k.id?{...e,precio:r,is_on_sale:a}:e)),D(!1),_(null)),L(!1)},F=async e=>{if(!confirm("¿Estás seguro de que deseas eliminar este producto?"))return;L(!0);let r=(0,s.createClient)(),{error:a}=await r.from("products").delete().eq("id",e);a?(console.error("[v0] Error deleting product:",a),alert("Error al eliminar el producto")):w(r=>r.filter(r=>r.id!==e)),L(!1)};return(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsxs)("div",{className:"relative flex-1",children:[(0,r.jsx)(x.Search,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,r.jsx)(l.Input,{placeholder:"Buscar por SKU, descripción o nombre...",value:T,onChange:e=>C(e.target.value),className:"pl-10"})]}),(0,r.jsx)(i.Button,{asChild:!0,children:(0,r.jsxs)(v.default,{href:"/admin/products/nuevo",children:[(0,r.jsx)(p.Plus,{className:"mr-2 h-4 w-4"}),"Agregar Producto"]})})]}),(0,r.jsx)("div",{className:"rounded-md border",children:(0,r.jsxs)(n.Table,{children:[(0,r.jsx)(n.TableHeader,{children:(0,r.jsxs)(n.TableRow,{children:[(0,r.jsx)(n.TableHead,{className:"w-[80px]",children:"Imagen"}),(0,r.jsx)(n.TableHead,{children:"SKU"}),(0,r.jsx)(n.TableHead,{children:"Producto"}),(0,r.jsx)(n.TableHead,{children:"Precio"}),(0,r.jsx)(n.TableHead,{children:"Stock"}),(0,r.jsx)(n.TableHead,{children:"Estado"}),(0,r.jsx)(n.TableHead,{className:"w-[80px]",children:"Acciones"})]})}),(0,r.jsx)(n.TableBody,{children:0===z.length?(0,r.jsx)(n.TableRow,{children:(0,r.jsx)(n.TableCell,{colSpan:7,className:"h-24 text-center",children:"No se encontraron productos."})}):z.map(e=>(0,r.jsxs)(n.TableRow,{children:[(0,r.jsx)(n.TableCell,{children:(0,r.jsx)("div",{className:"relative h-12 w-12 overflow-hidden rounded-md border",children:e.imagen_principal_url?(0,r.jsx)(f.default,{src:e.imagen_principal_url||"/placeholder.svg",alt:e.nombre_comercial||e.pdt_descripcion,fill:!0,className:"object-cover"}):(0,r.jsx)("div",{className:"flex h-full w-full items-center justify-center bg-muted text-xs text-muted-foreground",children:"Sin imagen"})})}),(0,r.jsx)(n.TableCell,{className:"font-mono text-sm",children:e.pdt_codigo}),(0,r.jsx)(n.TableCell,{children:(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-medium",children:e.nombre_comercial||e.pdt_descripcion}),e.nombre_comercial&&(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:e.pdt_descripcion})]})}),(0,r.jsx)(n.TableCell,{children:e.precio?(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsxs)("div",{className:"font-medium",children:["$",e.precio.toLocaleString()]}),e.is_on_sale&&(0,r.jsx)(u.Badge,{variant:"secondary",className:"text-xs",children:"En oferta"})]}):(0,r.jsx)("span",{className:"text-muted-foreground",children:"-"})}),(0,r.jsx)(n.TableCell,{children:(0,r.jsx)(u.Badge,{variant:e.upp_existencia>0?"default":"secondary",children:e.upp_existencia})}),(0,r.jsx)(n.TableCell,{children:(0,r.jsx)(u.Badge,{variant:e.is_active?"default":"secondary",children:e.is_active?"Activo":"Inactivo"})}),(0,r.jsx)(n.TableCell,{children:(0,r.jsxs)(o.DropdownMenu,{children:[(0,r.jsx)(o.DropdownMenuTrigger,{asChild:!0,children:(0,r.jsx)(i.Button,{variant:"ghost",size:"icon",children:(0,r.jsx)(h.MoreVertical,{className:"h-4 w-4"})})}),(0,r.jsxs)(o.DropdownMenuContent,{align:"end",children:[(0,r.jsxs)(o.DropdownMenuItem,{onClick:()=>{_(e),M(e.precio?.toString()||"0"),H("0"),D(!0)},children:[(0,r.jsx)(m.Pencil,{className:"mr-2 h-4 w-4"}),"Editar Precio y Descuento"]}),(0,r.jsx)(o.DropdownMenuItem,{asChild:!0,children:(0,r.jsxs)(v.default,{href:`/admin/products/${e.id}/editar`,children:[(0,r.jsx)(m.Pencil,{className:"mr-2 h-4 w-4"}),"Edición Avanzada"]})}),(0,r.jsxs)(o.DropdownMenuItem,{onClick:()=>F(e.id),className:"text-destructive",children:[(0,r.jsx)(b.Trash2,{className:"mr-2 h-4 w-4"}),"Eliminar"]})]})]})})]},e.id))})]})}),(0,r.jsx)(d.Dialog,{open:S,onOpenChange:D,children:(0,r.jsxs)(d.DialogContent,{children:[(0,r.jsxs)(d.DialogHeader,{children:[(0,r.jsx)(d.DialogTitle,{children:"Editar Precio y Descuento"}),(0,r.jsx)(d.DialogDescription,{children:k?.nombre_comercial||k?.pdt_descripcion})]}),(0,r.jsxs)("div",{className:"space-y-4 py-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(c.Label,{htmlFor:"price",children:"Precio ($)"}),(0,r.jsx)(l.Input,{id:"price",type:"number",step:"0.01",value:P,onChange:e=>M(e.target.value),placeholder:"0.00"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(c.Label,{htmlFor:"discount",children:"Descuento (%)"}),(0,r.jsx)(l.Input,{id:"discount",type:"number",step:"1",min:"0",max:"100",value:B,onChange:e=>H(e.target.value),placeholder:"0"}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Si el descuento es mayor que 0, el producto aparecerá en Ofertas"})]}),Number.parseFloat(B)>0&&Number.parseFloat(P)>0&&(0,r.jsxs)("div",{className:"rounded-md bg-muted p-3",children:[(0,r.jsx)("div",{className:"text-sm font-medium",children:"Precio con descuento:"}),(0,r.jsxs)("div",{className:"text-2xl font-bold text-primary",children:["$",(Number.parseFloat(P)*(1-Number.parseFloat(B)/100)).toLocaleString()]}),(0,r.jsxs)("div",{className:"text-sm text-muted-foreground line-through",children:["$",Number.parseFloat(P).toLocaleString()]})]})]}),(0,r.jsxs)(d.DialogFooter,{children:[(0,r.jsx)(i.Button,{variant:"outline",onClick:()=>D(!1),disabled:E,children:"Cancelar"}),(0,r.jsx)(i.Button,{onClick:A,disabled:E,children:E?"Guardando...":"Guardar Cambios"})]})]})})]})}e.s(["ProductsManagement",()=>g])}]);