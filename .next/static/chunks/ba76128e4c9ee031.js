(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,470152,e=>{"use strict";function a(e,[a,i]){return Math.min(i,Math.max(a,e))}e.s(["clamp",()=>a])},10708,e=>{"use strict";var a=e.i(843476),i=e.i(271645),t=e.i(248425),s=i.forwardRef((e,i)=>(0,a.jsx)(t.Primitive.label,{...e,ref:i,onMouseDown:a=>{a.target.closest("button, input, select, textarea")||(e.onMouseDown?.(a),!a.defaultPrevented&&a.detail>1&&a.preventDefault())}}));s.displayName="Label";var l=e.i(647163);function r({className:e,...i}){return(0,a.jsx)(s,{"data-slot":"label",className:(0,l.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...i})}e.s(["Label",()=>r],10708)},184762,e=>{"use strict";var a=e.i(843476),i=e.i(647163);function t({className:e,...t}){return(0,a.jsx)("textarea",{"data-slot":"textarea",className:(0,i.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...t})}e.s(["Textarea",()=>t])},994179,e=>{"use strict";var a=e.i(843476),i=e.i(991918),t=e.i(225913),s=e.i(647163);let l=(0,t.cva)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function r({className:e,variant:t,asChild:r=!1,...n}){let o=r?i.Slot:"span";return(0,a.jsx)(o,{"data-slot":"badge",className:(0,s.cn)(l({variant:t}),e),...n})}e.s(["Badge",()=>r])},947627,e=>{"use strict";var a=e.i(843476),i=e.i(647163);function t({className:e,...t}){return(0,a.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,a.jsx)("table",{"data-slot":"table",className:(0,i.cn)("w-full caption-bottom text-sm",e),...t})})}function s({className:e,...t}){return(0,a.jsx)("thead",{"data-slot":"table-header",className:(0,i.cn)("[&_tr]:border-b",e),...t})}function l({className:e,...t}){return(0,a.jsx)("tbody",{"data-slot":"table-body",className:(0,i.cn)("[&_tr:last-child]:border-0",e),...t})}function r({className:e,...t}){return(0,a.jsx)("tfoot",{"data-slot":"table-footer",className:(0,i.cn)("bg-muted/50 border-t font-medium [&>tr]:last:border-b-0",e),...t})}function n({className:e,...t}){return(0,a.jsx)("tr",{"data-slot":"table-row",className:(0,i.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...t})}function o({className:e,...t}){return(0,a.jsx)("th",{"data-slot":"table-head",className:(0,i.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}function c({className:e,...t}){return(0,a.jsx)("td",{"data-slot":"table-cell",className:(0,i.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}function d({className:e,...t}){return(0,a.jsx)("caption",{"data-slot":"table-caption",className:(0,i.cn)("text-muted-foreground mt-4 text-sm",e),...t})}e.s(["Table",()=>t,"TableBody",()=>l,"TableCaption",()=>d,"TableCell",()=>c,"TableFooter",()=>r,"TableHead",()=>o,"TableHeader",()=>s,"TableRow",()=>n])},323585,e=>{"use strict";let a=(0,e.i(475254).default)("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);e.s(["MoreVertical",()=>a],323585)},107233,e=>{"use strict";let a=(0,e.i(475254).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>a],107233)},727612,e=>{"use strict";let a=(0,e.i(475254).default)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);e.s(["Trash2",()=>a],727612)},788699,e=>{"use strict";let a=(0,e.i(475254).default)("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);e.s(["Pencil",()=>a],788699)},531969,e=>{"use strict";var a=e.i(843476),i=e.i(271645),t=e.i(920755),s=e.i(167881),l=e.i(23750),r=e.i(994179),n=e.i(947627),o=e.i(630374),c=e.i(463415),d=e.i(10708),u=e.i(184762),m=e.i(62870),h=e.i(107233),x=e.i(555436),p=e.i(323585),b=e.i(761911),g=e.i(788699),v=e.i(727612),j=e.i(618566);function f(){let e=(0,j.useRouter)(),[f,y]=(0,i.useState)([]),[C,_]=(0,i.useState)([]),[N,w]=(0,i.useState)(""),[T,k]=(0,i.useState)(!0),[S,I]=(0,i.useState)(!1),[L,D]=(0,i.useState)(!1),[F,M]=(0,i.useState)(null),[z,P]=(0,i.useState)({razon_social:"",nit:"",pais:"Colombia",descuento_general:0,limite_credito:0,is_active:!0});async function H(){let e=(0,t.createClient)(),{data:a,error:i}=await e.from("companies").select(`
        *,
        contacts:company_contacts(*),
        distributor:distributors(*, profile:user_profiles(*))
      `).order("razon_social",{ascending:!0});!i&&a&&y(a),k(!1)}async function B(){let e=(0,t.createClient)(),{data:a}=await e.from("distributors").select("*, profile:user_profiles(*)").eq("is_active",!0);a&&_(a)}async function E(){let e=(0,t.createClient)(),{data:{user:a}}=await e.auth.getUser();if(F){let{error:i}=await e.from("companies").update({...z,updated_by:a?.id}).eq("id",F.id);i||(await H(),I(!1),V())}else{let{error:i}=await e.from("companies").insert([{...z,created_by:a?.id}]);i||(await H(),I(!1),V())}}async function R(e){if(!confirm("¿Está seguro de eliminar este cliente?"))return;let a=(0,t.createClient)(),{error:i}=await a.from("companies").delete().eq("id",e);i||await H()}function V(){P({razon_social:"",nit:"",pais:"Colombia",descuento_general:0,limite_credito:0,is_active:!0}),M(null)}function A(a){M(a),e.push(`/admin/clients/${a.id}/contacts`)}(0,i.useEffect)(()=>{H(),B()},[]);let U=f.filter(e=>e.razon_social?.toLowerCase().includes(N.toLowerCase())||e.nit?.includes(N)||e.email_principal?.toLowerCase().includes(N.toLowerCase()));return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,a.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,a.jsx)(x.Search,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,a.jsx)(l.Input,{placeholder:"Buscar por razón social, NIT o email...",value:N,onChange:e=>w(e.target.value),className:"pl-10"})]}),(0,a.jsxs)(s.Button,{onClick:()=>I(!0),children:[(0,a.jsx)(h.Plus,{className:"mr-2 h-4 w-4"}),"Agregar Cliente"]})]}),(0,a.jsx)("div",{className:"rounded-md border",children:(0,a.jsxs)(n.Table,{children:[(0,a.jsx)(n.TableHeader,{children:(0,a.jsxs)(n.TableRow,{children:[(0,a.jsx)(n.TableHead,{children:"Razón Social"}),(0,a.jsx)(n.TableHead,{children:"NIT"}),(0,a.jsx)(n.TableHead,{children:"Ciudad"}),(0,a.jsx)(n.TableHead,{children:"Distribuidor Asignado"}),(0,a.jsx)(n.TableHead,{children:"Contactos"}),(0,a.jsx)(n.TableHead,{children:"Crédito"}),(0,a.jsx)(n.TableHead,{children:"Estado"}),(0,a.jsx)(n.TableHead,{className:"w-[50px]"})]})}),(0,a.jsx)(n.TableBody,{children:U.map(e=>(0,a.jsxs)(n.TableRow,{children:[(0,a.jsx)(n.TableCell,{className:"font-medium",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{children:e.razon_social}),e.nombre_comercial&&(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:e.nombre_comercial})]})}),(0,a.jsx)(n.TableCell,{children:e.nit}),(0,a.jsx)(n.TableCell,{children:e.ciudad||"-"}),(0,a.jsx)(n.TableCell,{children:e.distributor?.profile?.full_name||"-"}),(0,a.jsx)(n.TableCell,{children:(0,a.jsxs)(s.Button,{variant:"ghost",size:"sm",onClick:()=>A(e),children:[(0,a.jsx)(b.Users,{className:"mr-2 h-4 w-4"}),e.contacts?.length||0]})}),(0,a.jsxs)(n.TableCell,{children:["$",e.limite_credito.toLocaleString()]}),(0,a.jsx)(n.TableCell,{children:(0,a.jsx)(r.Badge,{variant:e.is_active?"default":"secondary",children:e.is_active?"Activo":"Inactivo"})}),(0,a.jsx)(n.TableCell,{children:(0,a.jsxs)(c.DropdownMenu,{children:[(0,a.jsx)(c.DropdownMenuTrigger,{asChild:!0,children:(0,a.jsx)(s.Button,{variant:"ghost",size:"icon",children:(0,a.jsx)(p.MoreVertical,{className:"h-4 w-4"})})}),(0,a.jsxs)(c.DropdownMenuContent,{align:"end",children:[(0,a.jsxs)(c.DropdownMenuItem,{onClick:()=>{M(e),P(e),I(!0)},children:[(0,a.jsx)(g.Pencil,{className:"mr-2 h-4 w-4"}),"Editar"]}),(0,a.jsxs)(c.DropdownMenuItem,{onClick:()=>A(e),children:[(0,a.jsx)(b.Users,{className:"mr-2 h-4 w-4"}),"Gestionar Contactos"]}),(0,a.jsxs)(c.DropdownMenuItem,{onClick:()=>R(e.id),className:"text-red-600",children:[(0,a.jsx)(v.Trash2,{className:"mr-2 h-4 w-4"}),"Eliminar"]})]})]})})]},e.id))})]})}),(0,a.jsx)(o.Dialog,{open:S,onOpenChange:I,children:(0,a.jsxs)(o.DialogContent,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)(o.DialogHeader,{children:[(0,a.jsx)(o.DialogTitle,{children:F?"Editar Cliente":"Nuevo Cliente"}),(0,a.jsx)(o.DialogDescription,{children:"Complete la información del cliente empresarial"})]}),(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{htmlFor:"razon_social",children:"Razón Social *"}),(0,a.jsx)(l.Input,{id:"razon_social",value:z.razon_social,onChange:e=>P({...z,razon_social:e.target.value})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{htmlFor:"nit",children:"NIT *"}),(0,a.jsx)(l.Input,{id:"nit",value:z.nit,onChange:e=>P({...z,nit:e.target.value})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{htmlFor:"nombre_comercial",children:"Nombre Comercial"}),(0,a.jsx)(l.Input,{id:"nombre_comercial",value:z.nombre_comercial||"",onChange:e=>P({...z,nombre_comercial:e.target.value})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{htmlFor:"tipo_empresa",children:"Tipo de Empresa"}),(0,a.jsx)(l.Input,{id:"tipo_empresa",value:z.tipo_empresa||"",onChange:e=>P({...z,tipo_empresa:e.target.value}),placeholder:"Restaurante, Hotel, etc."})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{htmlFor:"direccion",children:"Dirección"}),(0,a.jsx)(u.Textarea,{id:"direccion",value:z.direccion||"",onChange:e=>P({...z,direccion:e.target.value})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{htmlFor:"ciudad",children:"Ciudad"}),(0,a.jsx)(l.Input,{id:"ciudad",value:z.ciudad||"",onChange:e=>P({...z,ciudad:e.target.value}),placeholder:"Ej: Bogotá"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{htmlFor:"estado",children:"Departamento"}),(0,a.jsx)(l.Input,{id:"estado",value:z.estado||"",onChange:e=>P({...z,estado:e.target.value}),placeholder:"Ej: Cundinamarca"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{htmlFor:"codigo_postal",children:"Código Postal"}),(0,a.jsx)(l.Input,{id:"codigo_postal",value:z.codigo_postal||"",onChange:e=>P({...z,codigo_postal:e.target.value})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{htmlFor:"pais",children:"País"}),(0,a.jsx)(l.Input,{id:"pais",value:z.pais||"Colombia",onChange:e=>P({...z,pais:e.target.value})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{htmlFor:"telefono_principal",children:"Teléfono Principal"}),(0,a.jsx)(l.Input,{id:"telefono_principal",value:z.telefono_principal||"",onChange:e=>P({...z,telefono_principal:e.target.value})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{htmlFor:"email_principal",children:"Email Principal"}),(0,a.jsx)(l.Input,{id:"email_principal",type:"email",value:z.email_principal||"",onChange:e=>P({...z,email_principal:e.target.value})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{htmlFor:"terminos_pago",children:"Términos de Pago"}),(0,a.jsxs)(m.Select,{value:z.terminos_pago||"",onValueChange:e=>P({...z,terminos_pago:e}),children:[(0,a.jsx)(m.SelectTrigger,{children:(0,a.jsx)(m.SelectValue,{placeholder:"Seleccionar..."})}),(0,a.jsxs)(m.SelectContent,{children:[(0,a.jsx)(m.SelectItem,{value:"Contado",children:"Contado"}),(0,a.jsx)(m.SelectItem,{value:"15 días",children:"15 días"}),(0,a.jsx)(m.SelectItem,{value:"30 días",children:"30 días"}),(0,a.jsx)(m.SelectItem,{value:"45 días",children:"45 días"}),(0,a.jsx)(m.SelectItem,{value:"60 días",children:"60 días"}),(0,a.jsx)(m.SelectItem,{value:"90 días",children:"90 días"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{htmlFor:"descuento_general",children:"Descuento General (%)"}),(0,a.jsx)(l.Input,{id:"descuento_general",type:"number",step:"0.01",value:z.descuento_general||0,onChange:e=>P({...z,descuento_general:Number.parseFloat(e.target.value)})})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{htmlFor:"limite_credito",children:"Límite de Crédito"}),(0,a.jsx)(l.Input,{id:"limite_credito",type:"number",step:"0.01",value:z.limite_credito||0,onChange:e=>P({...z,limite_credito:Number.parseFloat(e.target.value)})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{htmlFor:"distribuidor_asignado_id",children:"Distribuidor Asignado"}),(0,a.jsxs)(m.Select,{value:z.distribuidor_asignado_id||"",onValueChange:e=>P({...z,distribuidor_asignado_id:e}),children:[(0,a.jsx)(m.SelectTrigger,{children:(0,a.jsx)(m.SelectValue,{placeholder:"Seleccionar distribuidor..."})}),(0,a.jsx)(m.SelectContent,{children:C.map(e=>(0,a.jsx)(m.SelectItem,{value:e.id,children:e.profile?.full_name||e.company_name},e.id))})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{htmlFor:"notas",children:"Notas"}),(0,a.jsx)(u.Textarea,{id:"notas",value:z.notas||"",onChange:e=>P({...z,notas:e.target.value}),rows:3})]})]}),(0,a.jsxs)(o.DialogFooter,{children:[(0,a.jsx)(s.Button,{variant:"outline",onClick:()=>{I(!1),V()},children:"Cancelar"}),(0,a.jsx)(s.Button,{onClick:E,children:"Guardar Cliente"})]})]})})]})}e.s(["ClientsManagement",()=>f])}]);