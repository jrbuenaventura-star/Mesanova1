(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,70065,e=>{"use strict";var t=e.i(43476),a=e.i(47163);function s({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card",className:(0,a.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...s})}function r({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-header",className:(0,a.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...s})}function i({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-title",className:(0,a.cn)("leading-none font-semibold",e),...s})}function l({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-description",className:(0,a.cn)("text-muted-foreground text-sm",e),...s})}function d({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-content",className:(0,a.cn)("px-6",e),...s})}function c({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-footer",className:(0,a.cn)("flex items-center px-6 [.border-t]:pt-6",e),...s})}e.s(["Card",()=>s,"CardContent",()=>d,"CardDescription",()=>l,"CardFooter",()=>c,"CardHeader",()=>r,"CardTitle",()=>i])},20682,e=>{"use strict";var t=e.i(71645);let a=0,s=new Map,r=e=>{if(s.has(e))return;let t=setTimeout(()=>{s.delete(e),d({type:"REMOVE_TOAST",toastId:e})},1e6);s.set(e,t)},i=[],l={toasts:[]};function d(e){l=((e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?r(a):e.toasts.forEach(e=>{r(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}})(l,e),i.forEach(e=>{e(l)})}function c({...e}){let t=(a=(a+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>d({type:"DISMISS_TOAST",toastId:t});return d({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:e=>{e||s()}}}),{id:t,dismiss:s,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function o(){let[e,a]=t.useState(l);return t.useEffect(()=>(i.push(a),()=>{let e=i.indexOf(a);e>-1&&i.splice(e,1)}),[e]),{...e,toast:c,dismiss:e=>d({type:"DISMISS_TOAST",toastId:e})}}e.s(["toast",()=>c,"useToast",()=>o])},71689,e=>{"use strict";let t=(0,e.i(75254).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>t],71689)},18975,e=>{"use strict";let t=(0,e.i(75254).default)("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);e.s(["default",()=>t])},89099,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(18566),r=e.i(70065),i=e.i(67881),l=e.i(23750),d=e.i(10708),c=e.i(84762),o=e.i(62870),n=e.i(71689),u=e.i(69074),m=e.i(37727),h=e.i(22016),x=e.i(46593),p=e.i(20755),g=e.i(20682);function f({params:e}){let{id:f}=(0,a.use)(e),j=(0,s.useRouter)(),{toast:b}=(0,g.useToast)(),[v,S]=(0,a.useState)(""),[y,N]=(0,a.useState)(!0),[T,_]=(0,a.useState)(!1),[C,w]=(0,a.useState)(null),[I,A]=(0,a.useState)([]),[E,O]=(0,a.useState)(""),[D,P]=(0,a.useState)(!1),L=(0,a.useRef)(null);(0,a.useEffect)(()=>{(async()=>{let e=(0,p.createClient)(),{data:t}=await e.from("blog_posts").select(`
          *,
          blog_post_categories(category_id)
        `).eq("id",f).single();t&&(w(t),S(t.content||""),O(t.featured_image_url||""));let{data:a}=await e.from("blog_categories").select("*").order("name");a&&A(a),N(!1)})()},[f]);let V=async e=>{let t=e.target.files?.[0];if(t){P(!0);try{let e=new FormData;e.append("file",t);let a=await fetch("/api/blog/upload",{method:"POST",body:e});if(!a.ok)throw Error("Upload failed");let s=await a.json();O(s.url),b({title:"Éxito",description:"Imagen destacada subida correctamente"})}catch(e){b({title:"Error",description:"No se pudo subir la imagen",variant:"destructive"})}finally{P(!1)}}},F=async e=>{e.preventDefault(),_(!0);let t=new FormData(e.currentTarget),a=(0,p.createClient)(),s=t.get("title"),r=t.get("slug"),i=t.get("excerpt"),l=t.get("status"),d=t.get("category"),{error:c}=await a.from("blog_posts").update({title:s,slug:r,excerpt:i,content:v,status:l,featured_image_url:E||null,published_at:"published"!==l||C.published_at?C.published_at:new Date().toISOString()}).eq("id",f);if(c){b({title:"Error",description:"No se pudo actualizar el post: "+c.message,variant:"destructive"}),_(!1);return}d&&(await a.from("blog_post_categories").delete().eq("post_id",f),await a.from("blog_post_categories").insert({post_id:f,category_id:d})),b({title:"Éxito",description:"Post actualizado correctamente"}),j.push("/admin/blog"),j.refresh()};return y?(0,t.jsx)("div",{className:"p-8",children:(0,t.jsx)("p",{children:"Cargando..."})}):C?(0,t.jsxs)("div",{className:"p-8 space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(i.Button,{variant:"ghost",size:"icon",asChild:!0,children:(0,t.jsx)(h.default,{href:"/admin/blog",children:(0,t.jsx)(n.ArrowLeft,{className:"h-5 w-5"})})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"Editar Post"}),(0,t.jsx)("p",{className:"text-muted-foreground mt-1",children:"Modifica el artículo del blog"})]})]}),(0,t.jsx)("form",{onSubmit:F,children:(0,t.jsxs)(r.Card,{children:[(0,t.jsxs)(r.CardHeader,{children:[(0,t.jsx)(r.CardTitle,{children:"Información del Post"}),(0,t.jsx)(r.CardDescription,{children:"Actualiza los detalles del artículo"})]}),(0,t.jsxs)(r.CardContent,{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(d.Label,{htmlFor:"title",children:"Título *"}),(0,t.jsx)(l.Input,{id:"title",name:"title",required:!0,defaultValue:C.title})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(d.Label,{htmlFor:"slug",children:"Slug (URL) *"}),(0,t.jsx)(l.Input,{id:"slug",name:"slug",required:!0,defaultValue:C.slug})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(d.Label,{htmlFor:"excerpt",children:"Extracto"}),(0,t.jsx)(c.Textarea,{id:"excerpt",name:"excerpt",defaultValue:C.excerpt||"",className:"min-h-[100px]"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(d.Label,{children:"Contenido *"}),(0,t.jsx)(x.RichTextEditor,{content:v,onChange:S})]}),(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(d.Label,{htmlFor:"status",children:"Estado"}),(0,t.jsxs)(o.Select,{name:"status",defaultValue:C.status,children:[(0,t.jsx)(o.SelectTrigger,{children:(0,t.jsx)(o.SelectValue,{})}),(0,t.jsxs)(o.SelectContent,{children:[(0,t.jsx)(o.SelectItem,{value:"draft",children:"Borrador"}),(0,t.jsx)(o.SelectItem,{value:"published",children:"Publicado"}),(0,t.jsx)(o.SelectItem,{value:"archived",children:"Archivado"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(d.Label,{htmlFor:"category",children:"Categoría"}),(0,t.jsxs)(o.Select,{name:"category",defaultValue:C.blog_post_categories?.[0]?.category_id,children:[(0,t.jsx)(o.SelectTrigger,{children:(0,t.jsx)(o.SelectValue,{placeholder:"Seleccionar categoría"})}),(0,t.jsx)(o.SelectContent,{children:I.map(e=>(0,t.jsx)(o.SelectItem,{value:e.id,children:e.name},e.id))})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(d.Label,{htmlFor:"featured_image",children:"Imagen Destacada"}),E?(0,t.jsxs)("div",{className:"relative aspect-video w-full max-w-md overflow-hidden rounded-lg border",children:[(0,t.jsx)("img",{src:E||"/placeholder.svg",alt:"Imagen destacada",className:"w-full h-full object-cover"}),(0,t.jsx)(i.Button,{type:"button",variant:"destructive",size:"icon",className:"absolute top-2 right-2",onClick:()=>O(""),children:(0,t.jsx)(m.X,{className:"h-4 w-4"})})]}):(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(l.Input,{ref:L,type:"file",accept:"image/*",onChange:V,disabled:D,className:"hidden"}),(0,t.jsxs)(i.Button,{type:"button",variant:"outline",onClick:()=>L.current?.click(),disabled:D,children:[(0,t.jsx)(u.Upload,{className:"mr-2 h-4 w-4"}),D?"Subiendo...":"Subir Imagen"]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"JPG, PNG o WebP (máx. 5MB)"})]})]})]}),(0,t.jsxs)("div",{className:"flex gap-4 justify-end pt-4",children:[(0,t.jsx)(i.Button,{type:"button",variant:"outline",asChild:!0,children:(0,t.jsx)(h.default,{href:"/admin/blog",children:"Cancelar"})}),(0,t.jsx)(i.Button,{type:"submit",disabled:T,children:T?"Guardando...":"Guardar Cambios"})]})]})]})})]}):(0,t.jsx)("div",{className:"p-8",children:(0,t.jsx)("p",{children:"Post no encontrado"})})}e.s(["default",()=>f])}]);