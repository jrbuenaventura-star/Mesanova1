module.exports=[99794,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(69240),e=a.i(40695),f=a.i(5522),g=a.i(54161),h=a.i(88237),i=a.i(65733),j=a.i(76504),k=a.i(17171),l=a.i(46893),m=a.i(87682),n=a.i(15618),o=a.i(87532),p=a.i(79360),q=a.i(60246),r=a.i(99464),s=a.i(81560),t=a.i(50944);function u(){let a=(0,t.useRouter)(),[u,v]=(0,c.useState)([]),[w,x]=(0,c.useState)([]),[y,z]=(0,c.useState)(""),[A,B]=(0,c.useState)(!0),[C,D]=(0,c.useState)(!1),[E,F]=(0,c.useState)(!1),[G,H]=(0,c.useState)(null),[I,J]=(0,c.useState)({razon_social:"",nit:"",pais:"Colombia",descuento_general:0,limite_credito:0,is_active:!0});async function K(){let a=(0,d.createClient)(),{data:b,error:c}=await a.from("companies").select(`
        *,
        contacts:company_contacts(*),
        distributor:distributors(*, profile:user_profiles(*))
      `).order("razon_social",{ascending:!0});!c&&b&&v(b),B(!1)}async function L(){let a=(0,d.createClient)(),{data:b}=await a.from("distributors").select("*, profile:user_profiles(*)").eq("is_active",!0);b&&x(b)}async function M(){let a=(0,d.createClient)(),{data:{user:b}}=await a.auth.getUser();if(G){let{error:c}=await a.from("companies").update({...I,updated_by:b?.id}).eq("id",G.id);c||(await K(),D(!1),O())}else{let{error:c}=await a.from("companies").insert([{...I,created_by:b?.id}]);c||(await K(),D(!1),O())}}async function N(a){if(!confirm("¿Está seguro de eliminar este cliente?"))return;let b=(0,d.createClient)(),{error:c}=await b.from("companies").delete().eq("id",a);c||await K()}function O(){J({razon_social:"",nit:"",pais:"Colombia",descuento_general:0,limite_credito:0,is_active:!0}),H(null)}function P(b){H(b),a.push(`/admin/clients/${b.id}/contacts`)}(0,c.useEffect)(()=>{K(),L()},[]);let Q=u.filter(a=>a.razon_social?.toLowerCase().includes(y.toLowerCase())||a.nit?.includes(y)||a.email_principal?.toLowerCase().includes(y.toLowerCase()));return(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,b.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,b.jsx)(o.Search,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,b.jsx)(f.Input,{placeholder:"Buscar por razón social, NIT o email...",value:y,onChange:a=>z(a.target.value),className:"pl-10"})]}),(0,b.jsxs)(e.Button,{onClick:()=>D(!0),children:[(0,b.jsx)(n.Plus,{className:"mr-2 h-4 w-4"}),"Agregar Cliente"]})]}),(0,b.jsx)("div",{className:"rounded-md border",children:(0,b.jsxs)(h.Table,{children:[(0,b.jsx)(h.TableHeader,{children:(0,b.jsxs)(h.TableRow,{children:[(0,b.jsx)(h.TableHead,{children:"Razón Social"}),(0,b.jsx)(h.TableHead,{children:"NIT"}),(0,b.jsx)(h.TableHead,{children:"Ciudad"}),(0,b.jsx)(h.TableHead,{children:"Distribuidor Asignado"}),(0,b.jsx)(h.TableHead,{children:"Contactos"}),(0,b.jsx)(h.TableHead,{children:"Crédito"}),(0,b.jsx)(h.TableHead,{children:"Estado"}),(0,b.jsx)(h.TableHead,{className:"w-[50px]"})]})}),(0,b.jsx)(h.TableBody,{children:Q.map(a=>(0,b.jsxs)(h.TableRow,{children:[(0,b.jsx)(h.TableCell,{className:"font-medium",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{children:a.razon_social}),a.nombre_comercial&&(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:a.nombre_comercial})]})}),(0,b.jsx)(h.TableCell,{children:a.nit}),(0,b.jsx)(h.TableCell,{children:a.ciudad||"-"}),(0,b.jsx)(h.TableCell,{children:a.distributor?.profile?.full_name||"-"}),(0,b.jsx)(h.TableCell,{children:(0,b.jsxs)(e.Button,{variant:"ghost",size:"sm",onClick:()=>P(a),children:[(0,b.jsx)(q.Users,{className:"mr-2 h-4 w-4"}),a.contacts?.length||0]})}),(0,b.jsxs)(h.TableCell,{children:["$",a.limite_credito.toLocaleString()]}),(0,b.jsx)(h.TableCell,{children:(0,b.jsx)(g.Badge,{variant:a.is_active?"default":"secondary",children:a.is_active?"Activo":"Inactivo"})}),(0,b.jsx)(h.TableCell,{children:(0,b.jsxs)(j.DropdownMenu,{children:[(0,b.jsx)(j.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(e.Button,{variant:"ghost",size:"icon",children:(0,b.jsx)(p.MoreVertical,{className:"h-4 w-4"})})}),(0,b.jsxs)(j.DropdownMenuContent,{align:"end",children:[(0,b.jsxs)(j.DropdownMenuItem,{onClick:()=>{H(a),J(a),D(!0)},children:[(0,b.jsx)(r.Pencil,{className:"mr-2 h-4 w-4"}),"Editar"]}),(0,b.jsxs)(j.DropdownMenuItem,{onClick:()=>P(a),children:[(0,b.jsx)(q.Users,{className:"mr-2 h-4 w-4"}),"Gestionar Contactos"]}),(0,b.jsxs)(j.DropdownMenuItem,{onClick:()=>N(a.id),className:"text-red-600",children:[(0,b.jsx)(s.Trash2,{className:"mr-2 h-4 w-4"}),"Eliminar"]})]})]})})]},a.id))})]})}),(0,b.jsx)(i.Dialog,{open:C,onOpenChange:D,children:(0,b.jsxs)(i.DialogContent,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)(i.DialogHeader,{children:[(0,b.jsx)(i.DialogTitle,{children:G?"Editar Cliente":"Nuevo Cliente"}),(0,b.jsx)(i.DialogDescription,{children:"Complete la información del cliente empresarial"})]}),(0,b.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(k.Label,{htmlFor:"razon_social",children:"Razón Social *"}),(0,b.jsx)(f.Input,{id:"razon_social",value:I.razon_social,onChange:a=>J({...I,razon_social:a.target.value})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(k.Label,{htmlFor:"nit",children:"NIT *"}),(0,b.jsx)(f.Input,{id:"nit",value:I.nit,onChange:a=>J({...I,nit:a.target.value})})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(k.Label,{htmlFor:"nombre_comercial",children:"Nombre Comercial"}),(0,b.jsx)(f.Input,{id:"nombre_comercial",value:I.nombre_comercial||"",onChange:a=>J({...I,nombre_comercial:a.target.value})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(k.Label,{htmlFor:"tipo_empresa",children:"Tipo de Empresa"}),(0,b.jsx)(f.Input,{id:"tipo_empresa",value:I.tipo_empresa||"",onChange:a=>J({...I,tipo_empresa:a.target.value}),placeholder:"Restaurante, Hotel, etc."})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(k.Label,{htmlFor:"direccion",children:"Dirección"}),(0,b.jsx)(l.Textarea,{id:"direccion",value:I.direccion||"",onChange:a=>J({...I,direccion:a.target.value})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-4 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(k.Label,{htmlFor:"ciudad",children:"Ciudad"}),(0,b.jsx)(f.Input,{id:"ciudad",value:I.ciudad||"",onChange:a=>J({...I,ciudad:a.target.value}),placeholder:"Ej: Bogotá"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(k.Label,{htmlFor:"estado",children:"Departamento"}),(0,b.jsx)(f.Input,{id:"estado",value:I.estado||"",onChange:a=>J({...I,estado:a.target.value}),placeholder:"Ej: Cundinamarca"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(k.Label,{htmlFor:"codigo_postal",children:"Código Postal"}),(0,b.jsx)(f.Input,{id:"codigo_postal",value:I.codigo_postal||"",onChange:a=>J({...I,codigo_postal:a.target.value})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(k.Label,{htmlFor:"pais",children:"País"}),(0,b.jsx)(f.Input,{id:"pais",value:I.pais||"Colombia",onChange:a=>J({...I,pais:a.target.value})})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(k.Label,{htmlFor:"telefono_principal",children:"Teléfono Principal"}),(0,b.jsx)(f.Input,{id:"telefono_principal",value:I.telefono_principal||"",onChange:a=>J({...I,telefono_principal:a.target.value})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(k.Label,{htmlFor:"email_principal",children:"Email Principal"}),(0,b.jsx)(f.Input,{id:"email_principal",type:"email",value:I.email_principal||"",onChange:a=>J({...I,email_principal:a.target.value})})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(k.Label,{htmlFor:"terminos_pago",children:"Términos de Pago"}),(0,b.jsxs)(m.Select,{value:I.terminos_pago||"",onValueChange:a=>J({...I,terminos_pago:a}),children:[(0,b.jsx)(m.SelectTrigger,{children:(0,b.jsx)(m.SelectValue,{placeholder:"Seleccionar..."})}),(0,b.jsxs)(m.SelectContent,{children:[(0,b.jsx)(m.SelectItem,{value:"Contado",children:"Contado"}),(0,b.jsx)(m.SelectItem,{value:"15 días",children:"15 días"}),(0,b.jsx)(m.SelectItem,{value:"30 días",children:"30 días"}),(0,b.jsx)(m.SelectItem,{value:"45 días",children:"45 días"}),(0,b.jsx)(m.SelectItem,{value:"60 días",children:"60 días"}),(0,b.jsx)(m.SelectItem,{value:"90 días",children:"90 días"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(k.Label,{htmlFor:"descuento_general",children:"Descuento General (%)"}),(0,b.jsx)(f.Input,{id:"descuento_general",type:"number",step:"0.01",value:I.descuento_general||0,onChange:a=>J({...I,descuento_general:Number.parseFloat(a.target.value)})})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(k.Label,{htmlFor:"limite_credito",children:"Límite de Crédito"}),(0,b.jsx)(f.Input,{id:"limite_credito",type:"number",step:"0.01",value:I.limite_credito||0,onChange:a=>J({...I,limite_credito:Number.parseFloat(a.target.value)})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(k.Label,{htmlFor:"distribuidor_asignado_id",children:"Distribuidor Asignado"}),(0,b.jsxs)(m.Select,{value:I.distribuidor_asignado_id||"",onValueChange:a=>J({...I,distribuidor_asignado_id:a}),children:[(0,b.jsx)(m.SelectTrigger,{children:(0,b.jsx)(m.SelectValue,{placeholder:"Seleccionar distribuidor..."})}),(0,b.jsx)(m.SelectContent,{children:w.map(a=>(0,b.jsx)(m.SelectItem,{value:a.id,children:a.profile?.full_name||a.company_name},a.id))})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(k.Label,{htmlFor:"notas",children:"Notas"}),(0,b.jsx)(l.Textarea,{id:"notas",value:I.notas||"",onChange:a=>J({...I,notas:a.target.value}),rows:3})]})]}),(0,b.jsxs)(i.DialogFooter,{children:[(0,b.jsx)(e.Button,{variant:"outline",onClick:()=>{D(!1),O()},children:"Cancelar"}),(0,b.jsx)(e.Button,{onClick:M,children:"Guardar Cliente"})]})]})})]})}a.s(["ClientsManagement",()=>u])}];

//# sourceMappingURL=components_admin_clients-management_tsx_d3c6393b._.js.map