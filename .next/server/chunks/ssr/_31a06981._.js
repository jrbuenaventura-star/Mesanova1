module.exports=[523011,a=>{"use strict";var b=a.i(211857);let c=(0,b.registerClientReference)(function(){throw Error("Attempted to call DropdownMenu() from the server but DropdownMenu is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/components/ui/dropdown-menu.tsx <module evaluation>","DropdownMenu"),d=(0,b.registerClientReference)(function(){throw Error("Attempted to call DropdownMenuCheckboxItem() from the server but DropdownMenuCheckboxItem is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/components/ui/dropdown-menu.tsx <module evaluation>","DropdownMenuCheckboxItem"),e=(0,b.registerClientReference)(function(){throw Error("Attempted to call DropdownMenuContent() from the server but DropdownMenuContent is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/components/ui/dropdown-menu.tsx <module evaluation>","DropdownMenuContent"),f=(0,b.registerClientReference)(function(){throw Error("Attempted to call DropdownMenuGroup() from the server but DropdownMenuGroup is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/components/ui/dropdown-menu.tsx <module evaluation>","DropdownMenuGroup"),g=(0,b.registerClientReference)(function(){throw Error("Attempted to call DropdownMenuItem() from the server but DropdownMenuItem is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/components/ui/dropdown-menu.tsx <module evaluation>","DropdownMenuItem"),h=(0,b.registerClientReference)(function(){throw Error("Attempted to call DropdownMenuLabel() from the server but DropdownMenuLabel is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/components/ui/dropdown-menu.tsx <module evaluation>","DropdownMenuLabel"),i=(0,b.registerClientReference)(function(){throw Error("Attempted to call DropdownMenuPortal() from the server but DropdownMenuPortal is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/components/ui/dropdown-menu.tsx <module evaluation>","DropdownMenuPortal"),j=(0,b.registerClientReference)(function(){throw Error("Attempted to call DropdownMenuRadioGroup() from the server but DropdownMenuRadioGroup is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/components/ui/dropdown-menu.tsx <module evaluation>","DropdownMenuRadioGroup"),k=(0,b.registerClientReference)(function(){throw Error("Attempted to call DropdownMenuRadioItem() from the server but DropdownMenuRadioItem is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/components/ui/dropdown-menu.tsx <module evaluation>","DropdownMenuRadioItem"),l=(0,b.registerClientReference)(function(){throw Error("Attempted to call DropdownMenuSeparator() from the server but DropdownMenuSeparator is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/components/ui/dropdown-menu.tsx <module evaluation>","DropdownMenuSeparator"),m=(0,b.registerClientReference)(function(){throw Error("Attempted to call DropdownMenuShortcut() from the server but DropdownMenuShortcut is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/components/ui/dropdown-menu.tsx <module evaluation>","DropdownMenuShortcut"),n=(0,b.registerClientReference)(function(){throw Error("Attempted to call DropdownMenuSub() from the server but DropdownMenuSub is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/components/ui/dropdown-menu.tsx <module evaluation>","DropdownMenuSub"),o=(0,b.registerClientReference)(function(){throw Error("Attempted to call DropdownMenuSubContent() from the server but DropdownMenuSubContent is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/components/ui/dropdown-menu.tsx <module evaluation>","DropdownMenuSubContent"),p=(0,b.registerClientReference)(function(){throw Error("Attempted to call DropdownMenuSubTrigger() from the server but DropdownMenuSubTrigger is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/components/ui/dropdown-menu.tsx <module evaluation>","DropdownMenuSubTrigger"),q=(0,b.registerClientReference)(function(){throw Error("Attempted to call DropdownMenuTrigger() from the server but DropdownMenuTrigger is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/components/ui/dropdown-menu.tsx <module evaluation>","DropdownMenuTrigger");a.s(["DropdownMenu",0,c,"DropdownMenuCheckboxItem",0,d,"DropdownMenuContent",0,e,"DropdownMenuGroup",0,f,"DropdownMenuItem",0,g,"DropdownMenuLabel",0,h,"DropdownMenuPortal",0,i,"DropdownMenuRadioGroup",0,j,"DropdownMenuRadioItem",0,k,"DropdownMenuSeparator",0,l,"DropdownMenuShortcut",0,m,"DropdownMenuSub",0,n,"DropdownMenuSubContent",0,o,"DropdownMenuSubTrigger",0,p,"DropdownMenuTrigger",0,q])},605309,a=>{"use strict";var b=a.i(211857);let c=(0,b.registerClientReference)(function(){throw Error("Attempted to call DropdownMenu() from the server but DropdownMenu is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/components/ui/dropdown-menu.tsx","DropdownMenu"),d=(0,b.registerClientReference)(function(){throw Error("Attempted to call DropdownMenuCheckboxItem() from the server but DropdownMenuCheckboxItem is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/components/ui/dropdown-menu.tsx","DropdownMenuCheckboxItem"),e=(0,b.registerClientReference)(function(){throw Error("Attempted to call DropdownMenuContent() from the server but DropdownMenuContent is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/components/ui/dropdown-menu.tsx","DropdownMenuContent"),f=(0,b.registerClientReference)(function(){throw Error("Attempted to call DropdownMenuGroup() from the server but DropdownMenuGroup is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/components/ui/dropdown-menu.tsx","DropdownMenuGroup"),g=(0,b.registerClientReference)(function(){throw Error("Attempted to call DropdownMenuItem() from the server but DropdownMenuItem is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/components/ui/dropdown-menu.tsx","DropdownMenuItem"),h=(0,b.registerClientReference)(function(){throw Error("Attempted to call DropdownMenuLabel() from the server but DropdownMenuLabel is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/components/ui/dropdown-menu.tsx","DropdownMenuLabel"),i=(0,b.registerClientReference)(function(){throw Error("Attempted to call DropdownMenuPortal() from the server but DropdownMenuPortal is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/components/ui/dropdown-menu.tsx","DropdownMenuPortal"),j=(0,b.registerClientReference)(function(){throw Error("Attempted to call DropdownMenuRadioGroup() from the server but DropdownMenuRadioGroup is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/components/ui/dropdown-menu.tsx","DropdownMenuRadioGroup"),k=(0,b.registerClientReference)(function(){throw Error("Attempted to call DropdownMenuRadioItem() from the server but DropdownMenuRadioItem is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/components/ui/dropdown-menu.tsx","DropdownMenuRadioItem"),l=(0,b.registerClientReference)(function(){throw Error("Attempted to call DropdownMenuSeparator() from the server but DropdownMenuSeparator is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/components/ui/dropdown-menu.tsx","DropdownMenuSeparator"),m=(0,b.registerClientReference)(function(){throw Error("Attempted to call DropdownMenuShortcut() from the server but DropdownMenuShortcut is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/components/ui/dropdown-menu.tsx","DropdownMenuShortcut"),n=(0,b.registerClientReference)(function(){throw Error("Attempted to call DropdownMenuSub() from the server but DropdownMenuSub is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/components/ui/dropdown-menu.tsx","DropdownMenuSub"),o=(0,b.registerClientReference)(function(){throw Error("Attempted to call DropdownMenuSubContent() from the server but DropdownMenuSubContent is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/components/ui/dropdown-menu.tsx","DropdownMenuSubContent"),p=(0,b.registerClientReference)(function(){throw Error("Attempted to call DropdownMenuSubTrigger() from the server but DropdownMenuSubTrigger is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/components/ui/dropdown-menu.tsx","DropdownMenuSubTrigger"),q=(0,b.registerClientReference)(function(){throw Error("Attempted to call DropdownMenuTrigger() from the server but DropdownMenuTrigger is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/components/ui/dropdown-menu.tsx","DropdownMenuTrigger");a.s(["DropdownMenu",0,c,"DropdownMenuCheckboxItem",0,d,"DropdownMenuContent",0,e,"DropdownMenuGroup",0,f,"DropdownMenuItem",0,g,"DropdownMenuLabel",0,h,"DropdownMenuPortal",0,i,"DropdownMenuRadioGroup",0,j,"DropdownMenuRadioItem",0,k,"DropdownMenuSeparator",0,l,"DropdownMenuShortcut",0,m,"DropdownMenuSub",0,n,"DropdownMenuSubContent",0,o,"DropdownMenuSubTrigger",0,p,"DropdownMenuTrigger",0,q])},205970,a=>{"use strict";a.i(523011);var b=a.i(605309);a.n(b)},329530,a=>{"use strict";var b=a.i(907997),c=a.i(998310);a.i(570396);var d=a.i(673727),e=a.i(395936),f=a.i(529171),g=a.i(943917),h=a.i(640088),i=a.i(822605),j=a.i(776615),k=a.i(583627),l=a.i(638307),m=a.i(440905),n=a.i(246840),o=a.i(701269);let p=(0,o.default)("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]),q=(0,o.default)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);var r=a.i(737229),s=a.i(205970);async function t(){let a=await (0,c.createClient)(),{data:{user:o}}=await a.auth.getUser();o||(0,d.redirect)("/auth/login");let{data:t}=await a.from("user_profiles").select("role").eq("id",o.id).single();t?.role!=="superadmin"&&(0,d.redirect)("/");let u=[];try{let{data:b}=await a.from("aliados").select(`
        *,
        user:user_profiles(full_name, email:id)
      `).order("created_at",{ascending:!1});u=b||[]}catch(a){}let{data:v}=await a.from("user_profiles").select("id, full_name, role").eq("role","aliado"),w={};try{let{data:b}=await a.from("distributors").select("aliado_id").not("aliado_id","is",null);b&&b.forEach(a=>{a.aliado_id&&(w[a.aliado_id]=(w[a.aliado_id]||0)+1)})}catch(a){}return(0,b.jsxs)("div",{className:"container mx-auto py-8 px-4 space-y-6",children:[(0,b.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Gestión de Aliados"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Administra los aliados comerciales y sus distribuidores asignados"})]}),(0,b.jsx)(g.Button,{asChild:!0,children:(0,b.jsxs)(e.default,{href:"/admin/aliados/nuevo",children:[(0,b.jsx)(l.UserPlus,{className:"mr-2 h-4 w-4"}),"Nuevo Aliado"]})})]}),(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,b.jsxs)(f.Card,{children:[(0,b.jsxs)(f.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(f.CardTitle,{className:"text-sm font-medium",children:"Total Aliados"}),(0,b.jsx)(k.Users,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsx)(f.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold",children:u.length})})]}),(0,b.jsxs)(f.Card,{children:[(0,b.jsxs)(f.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(f.CardTitle,{className:"text-sm font-medium",children:"Aliados Activos"}),(0,b.jsx)(k.Users,{className:"h-4 w-4 text-green-600"})]}),(0,b.jsx)(f.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold",children:u.filter(a=>a.is_active).length})})]}),(0,b.jsxs)(f.Card,{children:[(0,b.jsxs)(f.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(f.CardTitle,{className:"text-sm font-medium",children:"Distribuidores Asignados"}),(0,b.jsx)(n.Building2,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsx)(f.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold",children:Object.values(w).reduce((a,b)=>a+b,0)})})]})]}),(0,b.jsx)("div",{className:"flex gap-4",children:(0,b.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,b.jsx)(m.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(i.Input,{placeholder:"Buscar aliados...",className:"pl-10"})]})}),(0,b.jsxs)(f.Card,{children:[(0,b.jsxs)(f.CardHeader,{children:[(0,b.jsx)(f.CardTitle,{children:"Listado de Aliados"}),(0,b.jsx)(f.CardDescription,{children:"Todos los aliados comerciales registrados en el sistema"})]}),(0,b.jsx)(f.CardContent,{children:0===u.length?(0,b.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,b.jsx)(k.Users,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),(0,b.jsx)("p",{className:"text-lg font-medium",children:"No hay aliados registrados"}),(0,b.jsx)("p",{className:"text-sm",children:v&&v.length>0?`Hay ${v.length} usuarios con rol "aliado" sin perfil configurado`:"Crea el primer aliado para comenzar"}),(0,b.jsx)(g.Button,{asChild:!0,className:"mt-4",children:(0,b.jsxs)(e.default,{href:"/admin/aliados/nuevo",children:[(0,b.jsx)(l.UserPlus,{className:"mr-2 h-4 w-4"}),"Crear Aliado"]})})]}):(0,b.jsxs)(j.Table,{children:[(0,b.jsx)(j.TableHeader,{children:(0,b.jsxs)(j.TableRow,{children:[(0,b.jsx)(j.TableHead,{children:"Empresa"}),(0,b.jsx)(j.TableHead,{children:"Contacto"}),(0,b.jsx)(j.TableHead,{children:"Email"}),(0,b.jsx)(j.TableHead,{children:"Teléfono"}),(0,b.jsx)(j.TableHead,{children:"Distribuidores"}),(0,b.jsx)(j.TableHead,{children:"Estado"}),(0,b.jsx)(j.TableHead,{className:"w-[50px]"})]})}),(0,b.jsx)(j.TableBody,{children:u.map(a=>(0,b.jsxs)(j.TableRow,{children:[(0,b.jsx)(j.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(n.Building2,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsx)("span",{className:"font-medium",children:a.company_name})]})}),(0,b.jsx)(j.TableCell,{children:a.contact_name||"-"}),(0,b.jsx)(j.TableCell,{children:a.email&&(0,b.jsx)("a",{href:`mailto:${a.email}`,className:"text-primary hover:underline",children:a.email})}),(0,b.jsx)(j.TableCell,{children:a.phone||"-"}),(0,b.jsx)(j.TableCell,{children:(0,b.jsxs)(h.Badge,{variant:"secondary",children:[w[a.id]||0," distribuidores"]})}),(0,b.jsx)(j.TableCell,{children:(0,b.jsx)(h.Badge,{variant:a.is_active?"default":"secondary",children:a.is_active?"Activo":"Inactivo"})}),(0,b.jsx)(j.TableCell,{children:(0,b.jsxs)(s.DropdownMenu,{children:[(0,b.jsx)(s.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(g.Button,{variant:"ghost",size:"icon",children:(0,b.jsx)(p,{className:"h-4 w-4"})})}),(0,b.jsxs)(s.DropdownMenuContent,{align:"end",children:[(0,b.jsx)(s.DropdownMenuItem,{asChild:!0,children:(0,b.jsxs)(e.default,{href:`/admin/aliados/${a.id}`,children:[(0,b.jsx)(q,{className:"mr-2 h-4 w-4"}),"Editar"]})}),(0,b.jsx)(s.DropdownMenuItem,{asChild:!0,children:(0,b.jsxs)(e.default,{href:`/admin/aliados/${a.id}/distributors`,children:[(0,b.jsx)(k.Users,{className:"mr-2 h-4 w-4"}),"Ver distribuidores"]})}),(0,b.jsxs)(s.DropdownMenuItem,{className:"text-destructive",children:[(0,b.jsx)(r.Trash2,{className:"mr-2 h-4 w-4"}),"Eliminar"]})]})]})})]},a.id))})]})})]})]})}a.s(["default",()=>t],329530)}];

//# sourceMappingURL=_31a06981._.js.map