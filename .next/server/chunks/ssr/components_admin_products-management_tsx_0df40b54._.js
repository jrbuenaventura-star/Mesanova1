module.exports=[949282,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(50944),e=a.i(269240),f=a.i(340695),g=a.i(205522),h=a.i(588237),i=a.i(676504),j=a.i(965733),k=a.i(917171),l=a.i(254161),m=a.i(587532),n=a.i(879360),o=a.i(699464),p=a.i(915618),q=a.i(781560),r=a.i(73570),s=a.i(883497),t=a.i(887682),u=a.i(571987),v=a.i(238246);function w({initialProducts:a,silos:w,subcategories:x,collections:y}){let z=(0,d.useRouter)(),[A,B]=(0,c.useState)(a),[C,D]=(0,c.useState)(""),[E,F]=(0,c.useState)("all"),[G,H]=(0,c.useState)("all"),[I,J]=(0,c.useState)("all"),[K,L]=(0,c.useState)("all"),[M,N]=(0,c.useState)(null),[O,P]=(0,c.useState)(!1),[Q,R]=(0,c.useState)(""),[S,T]=(0,c.useState)("0"),[U,V]=(0,c.useState)(!1),W=Array.from(new Set(A.map(a=>a.marca).filter(a=>!!a))).sort(),X=Array.from(new Set(A.map(a=>a.nombre_coleccion).filter(a=>!!a))).sort(),Y=A.filter(a=>{let b=C.toLowerCase(),c=!b||a.pdt_codigo?.toLowerCase().includes(b)||a.pdt_descripcion?.toLowerCase().includes(b)||a.nombre_comercial?.toLowerCase().includes(b)||a.marca?.toLowerCase().includes(b),d="all"===E||a.marca===E,e="all"===G||a.nombre_coleccion===G,f=!0;return"descontinuado"===K?f=!0===a.descontinuado:"pedido_camino"===K?f=!0===a.pedido_en_camino:"activo"===K?f=!0===a.is_active:"inactivo"===K&&(f=!1===a.is_active),c&&d&&e&&"all"===I&&f}),Z=async()=>{if(!M)return;V(!0);let a=(0,e.createClient)(),b=Number.parseFloat(Q),c=Number.parseFloat(S),d=c>0,{error:f}=await a.from("products").update({precio:b,descuento_porcentaje:c,is_on_sale:d,updated_at:new Date().toISOString()}).eq("id",M.id);f?(console.error("[v0] Error updating price:",f),alert("Error al actualizar el precio")):(B(a=>a.map(a=>a.id===M.id?{...a,precio:b,descuento_porcentaje:c,is_on_sale:d}:a)),P(!1),N(null)),V(!1)},$=async a=>{if(!confirm("¿Estás seguro de que deseas eliminar este producto?"))return;V(!0);let b=(0,e.createClient)(),{error:c}=await b.from("products").delete().eq("id",a);c?(console.error("[v0] Error deleting product:",c),alert("Error al eliminar el producto")):B(b=>b.filter(b=>b.id!==a)),V(!1)};return(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsxs)("div",{className:"relative flex-1",children:[(0,b.jsx)(m.Search,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,b.jsx)(g.Input,{placeholder:"Buscar por SKU, descripción, nombre o marca...",value:C,onChange:a=>D(a.target.value),className:"pl-10"})]}),(0,b.jsx)(f.Button,{asChild:!0,children:(0,b.jsxs)(v.default,{href:"/admin/products/nuevo",children:[(0,b.jsx)(p.Plus,{className:"mr-2 h-4 w-4"}),"Agregar Producto"]})})]}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,b.jsxs)(t.Select,{value:E,onValueChange:F,children:[(0,b.jsx)(t.SelectTrigger,{className:"w-[180px]",children:(0,b.jsx)(t.SelectValue,{placeholder:"Marca"})}),(0,b.jsxs)(t.SelectContent,{children:[(0,b.jsx)(t.SelectItem,{value:"all",children:"Todas las marcas"}),W.map(a=>(0,b.jsx)(t.SelectItem,{value:a,children:a},a))]})]}),(0,b.jsxs)(t.Select,{value:G,onValueChange:H,children:[(0,b.jsx)(t.SelectTrigger,{className:"w-[180px]",children:(0,b.jsx)(t.SelectValue,{placeholder:"Colección"})}),(0,b.jsxs)(t.SelectContent,{children:[(0,b.jsx)(t.SelectItem,{value:"all",children:"Todas las colecciones"}),X.map(a=>(0,b.jsx)(t.SelectItem,{value:a,children:a},a))]})]}),(0,b.jsxs)(t.Select,{value:K,onValueChange:L,children:[(0,b.jsx)(t.SelectTrigger,{className:"w-[180px]",children:(0,b.jsx)(t.SelectValue,{placeholder:"Estado"})}),(0,b.jsxs)(t.SelectContent,{children:[(0,b.jsx)(t.SelectItem,{value:"all",children:"Todos los estados"}),(0,b.jsx)(t.SelectItem,{value:"activo",children:"Activos"}),(0,b.jsx)(t.SelectItem,{value:"inactivo",children:"Inactivos"}),(0,b.jsx)(t.SelectItem,{value:"descontinuado",children:"Descontinuados"}),(0,b.jsx)(t.SelectItem,{value:"pedido_camino",children:"Pedido en camino"})]})]}),("all"!==E||"all"!==G||"all"!==K)&&(0,b.jsx)(f.Button,{variant:"ghost",size:"sm",onClick:()=>{F("all"),H("all"),L("all")},children:"Limpiar filtros"}),(0,b.jsxs)("div",{className:"ml-auto text-sm text-muted-foreground",children:[Y.length," de ",A.length," productos"]})]})]}),(0,b.jsx)("div",{className:"rounded-md border",children:(0,b.jsxs)(h.Table,{children:[(0,b.jsx)(h.TableHeader,{children:(0,b.jsxs)(h.TableRow,{children:[(0,b.jsx)(h.TableHead,{className:"w-[80px]",children:"Imagen"}),(0,b.jsx)(h.TableHead,{children:"SKU"}),(0,b.jsx)(h.TableHead,{children:"Producto"}),(0,b.jsx)(h.TableHead,{children:"Marca"}),(0,b.jsx)(h.TableHead,{children:"Colección"}),(0,b.jsx)(h.TableHead,{children:"Precio"}),(0,b.jsx)(h.TableHead,{children:"Descuento"}),(0,b.jsx)(h.TableHead,{children:"Stock"}),(0,b.jsx)(h.TableHead,{children:"Estado"}),(0,b.jsx)(h.TableHead,{className:"w-[80px]",children:"Acciones"})]})}),(0,b.jsx)(h.TableBody,{children:0===Y.length?(0,b.jsx)(h.TableRow,{children:(0,b.jsx)(h.TableCell,{colSpan:10,className:"h-24 text-center",children:"No se encontraron productos."})}):Y.map(a=>(0,b.jsxs)(h.TableRow,{children:[(0,b.jsx)(h.TableCell,{children:(0,b.jsx)("div",{className:"relative h-12 w-12 overflow-hidden rounded-md border",children:a.imagen_principal_url?(0,b.jsx)(u.default,{src:a.imagen_principal_url,alt:a.nombre_comercial||a.pdt_descripcion||"Producto",fill:!0,className:"object-cover",unoptimized:!0,onError:a=>{a.target.style.display="none"}}):(0,b.jsx)("div",{className:"flex h-full w-full items-center justify-center bg-muted text-xs text-muted-foreground",children:"Sin imagen"})})}),(0,b.jsx)(h.TableCell,{className:"font-mono text-sm",children:a.pdt_codigo}),(0,b.jsx)(h.TableCell,{children:(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium",children:a.nombre_comercial||a.pdt_descripcion}),a.nombre_comercial&&(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:a.pdt_descripcion}),(0,b.jsxs)("div",{className:"flex gap-1 mt-1",children:[a.descontinuado&&(0,b.jsxs)(l.Badge,{variant:"destructive",className:"text-xs",children:[(0,b.jsx)(r.AlertTriangle,{className:"h-3 w-3 mr-1"}),"Descontinuado"]}),a.pedido_en_camino&&(0,b.jsxs)(l.Badge,{variant:"secondary",className:"text-xs",children:[(0,b.jsx)(s.Package,{className:"h-3 w-3 mr-1"}),"En camino"]})]})]})}),(0,b.jsx)(h.TableCell,{children:(0,b.jsx)("span",{className:"text-sm",children:a.marca||"-"})}),(0,b.jsx)(h.TableCell,{children:(0,b.jsx)("span",{className:"text-sm",children:a.nombre_coleccion||"-"})}),(0,b.jsx)(h.TableCell,{children:a.precio?(0,b.jsxs)("div",{className:"font-medium",children:["$",a.precio]}):(0,b.jsx)("span",{className:"text-muted-foreground",children:"-"})}),(0,b.jsx)(h.TableCell,{children:a.descuento_porcentaje&&a.descuento_porcentaje>0?(0,b.jsxs)(l.Badge,{variant:"secondary",className:"text-xs",children:[a.descuento_porcentaje,"% OFF"]}):(0,b.jsx)("span",{className:"text-muted-foreground",children:"-"})}),(0,b.jsx)(h.TableCell,{children:(0,b.jsx)(l.Badge,{variant:a.upp_existencia>0?"default":"secondary",children:a.upp_existencia})}),(0,b.jsx)(h.TableCell,{children:(0,b.jsx)(l.Badge,{variant:a.is_active?"default":"secondary",children:a.is_active?"Activo":"Inactivo"})}),(0,b.jsx)(h.TableCell,{children:(0,b.jsxs)(i.DropdownMenu,{children:[(0,b.jsx)(i.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(f.Button,{variant:"ghost",size:"icon",children:(0,b.jsx)(n.MoreVertical,{className:"h-4 w-4"})})}),(0,b.jsxs)(i.DropdownMenuContent,{align:"end",children:[(0,b.jsxs)(i.DropdownMenuItem,{onClick:()=>{N(a),R(a.precio?.toString()||"0"),T(a.descuento_porcentaje?.toString()||"0"),P(!0)},children:[(0,b.jsx)(o.Pencil,{className:"mr-2 h-4 w-4"}),"Editar Precio y Descuento"]}),(0,b.jsxs)(i.DropdownMenuItem,{onClick:()=>z.push(`/admin/products/${a.id}/editar`),children:[(0,b.jsx)(o.Pencil,{className:"mr-2 h-4 w-4"}),"Edición Avanzada"]}),(0,b.jsxs)(i.DropdownMenuItem,{onClick:()=>$(a.id),className:"text-destructive",children:[(0,b.jsx)(q.Trash2,{className:"mr-2 h-4 w-4"}),"Eliminar"]})]})]})})]},a.id))})]})}),(0,b.jsx)(j.Dialog,{open:O,onOpenChange:P,children:(0,b.jsxs)(j.DialogContent,{children:[(0,b.jsxs)(j.DialogHeader,{children:[(0,b.jsx)(j.DialogTitle,{children:"Editar Precio y Descuento"}),(0,b.jsx)(j.DialogDescription,{children:M?.nombre_comercial||M?.pdt_descripcion})]}),(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(k.Label,{htmlFor:"price",children:"Precio ($)"}),(0,b.jsx)(g.Input,{id:"price",type:"number",step:"0.01",value:Q,onChange:a=>R(a.target.value),placeholder:"0.00"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(k.Label,{htmlFor:"discount",children:"Descuento (%)"}),(0,b.jsx)(g.Input,{id:"discount",type:"number",step:"1",min:"0",max:"100",value:S,onChange:a=>T(a.target.value),placeholder:"0"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Si el descuento es mayor que 0, el producto aparecerá en Ofertas"})]}),Number.parseFloat(S)>0&&Number.parseFloat(Q)>0&&(0,b.jsxs)("div",{className:"rounded-md bg-muted p-3",children:[(0,b.jsx)("div",{className:"text-sm font-medium",children:"Precio con descuento:"}),(0,b.jsxs)("div",{className:"text-2xl font-bold text-primary",children:["$",(Number.parseFloat(Q)*(1-Number.parseFloat(S)/100)).toLocaleString()]}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground line-through",children:["$",Number.parseFloat(Q).toLocaleString()]})]})]}),(0,b.jsxs)(j.DialogFooter,{children:[(0,b.jsx)(f.Button,{variant:"outline",onClick:()=>P(!1),disabled:U,children:"Cancelar"}),(0,b.jsx)(f.Button,{onClick:Z,disabled:U,children:U?"Guardando...":"Guardar Cambios"})]})]})})]})}a.s(["ProductsManagement",()=>w])}];

//# sourceMappingURL=components_admin_products-management_tsx_0df40b54._.js.map