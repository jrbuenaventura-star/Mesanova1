module.exports=[917171,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(30553),e=c.forwardRef((a,c)=>(0,b.jsx)(d.Primitive.label,{...a,ref:c,onMouseDown:b=>{b.target.closest("button, input, select, textarea")||(a.onMouseDown?.(b),!b.defaultPrevented&&b.detail>1&&b.preventDefault())}}));e.displayName="Label";var f=a.i(497895);function g({className:a,...c}){return(0,b.jsx)(e,{"data-slot":"label",className:(0,f.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",a),...c})}a.s(["Label",()=>g],917171)},130656,a=>{"use strict";function b(a,[b,c]){return Math.min(c,Math.max(b,a))}a.s(["clamp",()=>b])},277687,a=>{"use strict";var b=a.i(572131);let c=0,d=new Map,e=a=>{if(d.has(a))return;let b=setTimeout(()=>{d.delete(a),h({type:"REMOVE_TOAST",toastId:a})},1e6);d.set(a,b)},f=[],g={toasts:[]};function h(a){g=((a,b)=>{switch(b.type){case"ADD_TOAST":return{...a,toasts:[b.toast,...a.toasts].slice(0,1)};case"UPDATE_TOAST":return{...a,toasts:a.toasts.map(a=>a.id===b.toast.id?{...a,...b.toast}:a)};case"DISMISS_TOAST":{let{toastId:c}=b;return c?e(c):a.toasts.forEach(a=>{e(a.id)}),{...a,toasts:a.toasts.map(a=>a.id===c||void 0===c?{...a,open:!1}:a)}}case"REMOVE_TOAST":if(void 0===b.toastId)return{...a,toasts:[]};return{...a,toasts:a.toasts.filter(a=>a.id!==b.toastId)}}})(g,a),f.forEach(a=>{a(g)})}function i({...a}){let b=(c=(c+1)%Number.MAX_SAFE_INTEGER).toString(),d=()=>h({type:"DISMISS_TOAST",toastId:b});return h({type:"ADD_TOAST",toast:{...a,id:b,open:!0,onOpenChange:a=>{a||d()}}}),{id:b,dismiss:d,update:a=>h({type:"UPDATE_TOAST",toast:{...a,id:b}})}}function j(){let[a,c]=b.useState(g);return b.useEffect(()=>(f.push(c),()=>{let a=f.indexOf(c);a>-1&&f.splice(a,1)}),[a]),{...a,toast:i,dismiss:a=>h({type:"DISMISS_TOAST",toastId:a})}}a.s(["toast",()=>i,"useToast",()=>j])},773320,a=>{"use strict";let b=(0,a.i(170106).default)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);a.s(["Upload",()=>b],773320)},104720,a=>{"use strict";let b=(0,a.i(170106).default)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);a.s(["FileText",()=>b],104720)},427789,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(50944),e=a.i(269240),f=a.i(340695),g=a.i(205522),h=a.i(917171),i=a.i(887682),j=a.i(277687),k=a.i(596221);let l=["Tienda de hogar","Restaurante","Hotel","Catering","Mayorista","Minorista","Institucional","Otro"];function m({distributor:a,userProfile:m}){let n=(0,d.useRouter)(),{toast:o}=(0,j.useToast)(),p=(0,e.createClient)(),[q,r]=(0,c.useState)(!1),[s,t]=(0,c.useState)({company_name:a?.company_name||"",company_rif:a?.company_rif||"",business_type:a?.business_type||"",contact_name:a?.contact_name||m?.full_name||"",contact_email:a?.contact_email||"",contact_phone:a?.contact_phone||m?.phone||"",contact_position:a?.contact_position||"",address:a?.address||"",city:a?.city||"",state:a?.state||""}),u=(a,b)=>{t(c=>({...c,[a]:b}))},v=async b=>{b.preventDefault(),r(!0);try{if(a?.id){let{error:b}=await p.from("distributors").update({company_name:s.company_name,company_rif:s.company_rif,business_type:s.business_type,contact_name:s.contact_name,contact_email:s.contact_email,contact_phone:s.contact_phone,contact_position:s.contact_position,address:s.address,city:s.city,state:s.state}).eq("id",a.id);if(b)throw b}else{let{data:{user:a}}=await p.auth.getUser();if(!a)throw Error("No autenticado");let{error:b}=await p.from("distributors").insert({user_id:a.id,company_name:s.company_name,company_rif:s.company_rif,business_type:s.business_type,contact_name:s.contact_name,contact_email:s.contact_email,contact_phone:s.contact_phone,contact_position:s.contact_position,address:s.address,city:s.city,state:s.state,requires_approval:!0});if(b)throw b}o({title:"Perfil actualizado",description:"Los cambios se han guardado correctamente"}),n.refresh()}catch(a){o({title:"Error",description:a.message||"No se pudo guardar el perfil",variant:"destructive"})}finally{r(!1)}};return(0,b.jsxs)("form",{onSubmit:v,className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"company_name",children:"Nombre de la Empresa *"}),(0,b.jsx)(g.Input,{id:"company_name",value:s.company_name,onChange:a=>u("company_name",a.target.value),placeholder:"Mi Empresa S.A.S.",required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"company_rif",children:"NIT / RIF"}),(0,b.jsx)(g.Input,{id:"company_rif",value:s.company_rif,onChange:a=>u("company_rif",a.target.value),placeholder:"900.123.456-7"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"business_type",children:"Tipo de Negocio *"}),(0,b.jsxs)(i.Select,{value:s.business_type,onValueChange:a=>u("business_type",a),children:[(0,b.jsx)(i.SelectTrigger,{children:(0,b.jsx)(i.SelectValue,{placeholder:"Selecciona tipo"})}),(0,b.jsx)(i.SelectContent,{children:l.map(a=>(0,b.jsx)(i.SelectItem,{value:a,children:a},a))})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"contact_name",children:"Nombre del Contacto *"}),(0,b.jsx)(g.Input,{id:"contact_name",value:s.contact_name,onChange:a=>u("contact_name",a.target.value),placeholder:"Juan Pérez",required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"contact_email",children:"Email de Contacto"}),(0,b.jsx)(g.Input,{id:"contact_email",type:"email",value:s.contact_email,onChange:a=>u("contact_email",a.target.value),placeholder:"contacto@empresa.com"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"contact_phone",children:"Teléfono de Contacto"}),(0,b.jsx)(g.Input,{id:"contact_phone",value:s.contact_phone,onChange:a=>u("contact_phone",a.target.value),placeholder:"+57 300 123 4567"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"contact_position",children:"Cargo"}),(0,b.jsx)(g.Input,{id:"contact_position",value:s.contact_position,onChange:a=>u("contact_position",a.target.value),placeholder:"Gerente de Compras"})]}),(0,b.jsxs)("div",{className:"space-y-2 md:col-span-2",children:[(0,b.jsx)(h.Label,{htmlFor:"address",children:"Dirección"}),(0,b.jsx)(g.Input,{id:"address",value:s.address,onChange:a=>u("address",a.target.value),placeholder:"Calle 123 # 45-67"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"city",children:"Ciudad"}),(0,b.jsx)(g.Input,{id:"city",value:s.city,onChange:a=>u("city",a.target.value),placeholder:"Bogotá"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"state",children:"Departamento"}),(0,b.jsx)(g.Input,{id:"state",value:s.state,onChange:a=>u("state",a.target.value),placeholder:"Cundinamarca"})]})]}),(0,b.jsxs)(f.Button,{type:"submit",disabled:q,className:"w-full",children:[q&&(0,b.jsx)(k.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),a?"Guardar Cambios":"Crear Perfil"]})]})}a.s(["DistributorProfileForm",()=>m])},185585,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(50944),e=a.i(269240),f=a.i(340695),g=a.i(277687),h=a.i(773320),i=a.i(596221),j=a.i(104720);function k({distributorId:a,documentType:k,onUploadComplete:l}){let m=(0,d.useRouter)(),{toast:n}=(0,g.useToast)(),o=(0,e.createClient)(),[p,q]=(0,c.useState)(!1),[r,s]=(0,c.useState)(null),t=(0,c.useCallback)(a=>{let b=a.target.files?.[0];if(b){if(!["application/pdf","image/jpeg","image/png","image/jpg"].includes(b.type))return void n({title:"Tipo de archivo no permitido",description:"Solo se permiten archivos PDF, JPG o PNG",variant:"destructive"});if(b.size>0xa00000)return void n({title:"Archivo muy grande",description:"El archivo no puede ser mayor a 10MB",variant:"destructive"});s(b)}},[n]),u=async()=>{if(!r||!a)return void n({title:"Error",description:a?"Selecciona un archivo":"Debes completar tu perfil primero",variant:"destructive"});q(!0);try{let b=r.name.split(".").pop(),c=`${a}/${k}_${Date.now()}.${b}`,{data:d,error:e}=await o.storage.from("distributor-documents").upload(c,r,{cacheControl:"3600",upsert:!1});e&&console.error("Storage error:",e);let f=null;if(d){let{data:a}=o.storage.from("distributor-documents").getPublicUrl(c);f=a.publicUrl}let g=null,h=null;if("estados_financieros"===k){let a=new Date;h=a.getFullYear(),g=new Date(a.getFullYear()+1,3,30).toISOString()}let{error:i}=await o.from("distributor_documents").upsert({distributor_id:a,document_type:k,file_name:r.name,file_url:f,file_size:r.size,mime_type:r.type,fiscal_year:h,expires_at:g,status:"pending"},{onConflict:"distributor_id,document_type,fiscal_year"});if(i){if(console.error("DB error:",i),"42P01"===i.code)return void n({title:"Configuración pendiente",description:"El sistema de documentos está siendo configurado. Intenta más tarde.",variant:"destructive"});throw i}n({title:"Documento subido",description:"El documento está pendiente de revisión"}),s(null),l?.(),m.refresh()}catch(a){console.error("Upload error:",a),n({title:"Error al subir",description:a.message||"No se pudo subir el documento",variant:"destructive"})}finally{q(!1)}};return a?(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("input",{type:"file",id:`file-${k}`,className:"hidden",accept:".pdf,.jpg,.jpeg,.png",onChange:t,disabled:p}),(0,b.jsx)("label",{htmlFor:`file-${k}`,className:"flex-1 cursor-pointer",children:(0,b.jsx)("div",{className:"flex items-center justify-center gap-2 p-3 border-2 border-dashed rounded-lg hover:border-primary hover:bg-muted/50 transition-colors",children:r?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(j.FileText,{className:"h-4 w-4 text-primary"}),(0,b.jsx)("span",{className:"text-sm truncate max-w-[150px]",children:r.name})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(h.Upload,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Seleccionar archivo"})]})})})]}),r&&(0,b.jsx)(f.Button,{onClick:u,disabled:p,size:"sm",className:"w-full",children:p?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(i.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Subiendo..."]}):"Subir documento"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"PDF, JPG o PNG. Máximo 10MB."})]}):(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Completa tu perfil para subir documentos"})}a.s(["DocumentUploader",()=>k])}];

//# sourceMappingURL=_0037750c._.js.map