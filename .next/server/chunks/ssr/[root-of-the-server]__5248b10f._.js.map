{"version":3,"sources":["../../../../components/ui/badge.tsx","../../../../node_modules/lucide-react/src/icons/shopping-cart.ts","../../../../lib/db/queries.ts","../../../../components/products/favorite-button.tsx/__nextjs-internal-proxy.mjs","../../../../components/products/product-card.tsx","../../../../app/buscar/page.tsx"],"sourcesContent":["import * as React from 'react'\nimport { Slot } from '@radix-ui/react-slot'\nimport { cva, type VariantProps } from 'class-variance-authority'\n\nimport { cn } from '@/lib/utils'\n\nconst badgeVariants = cva(\n  'inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden',\n  {\n    variants: {\n      variant: {\n        default:\n          'border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90',\n        secondary:\n          'border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90',\n        destructive:\n          'border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60',\n        outline:\n          'text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground',\n      },\n    },\n    defaultVariants: {\n      variant: 'default',\n    },\n  },\n)\n\nfunction Badge({\n  className,\n  variant,\n  asChild = false,\n  ...props\n}: React.ComponentProps<'span'> &\n  VariantProps<typeof badgeVariants> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : 'span'\n\n  return (\n    <Comp\n      data-slot=\"badge\"\n      className={cn(badgeVariants({ variant }), className)}\n      {...props}\n    />\n  )\n}\n\nexport { Badge, badgeVariants }\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name ShoppingCart\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8Y2lyY2xlIGN4PSI4IiBjeT0iMjEiIHI9IjEiIC8+CiAgPGNpcmNsZSBjeD0iMTkiIGN5PSIyMSIgcj0iMSIgLz4KICA8cGF0aCBkPSJNMi4wNSAyLjA1aDJsMi42NiAxMi40MmEyIDIgMCAwIDAgMiAxLjU4aDkuNzhhMiAyIDAgMCAwIDEuOTUtMS41N2wxLjY1LTcuNDNINS4xMiIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/shopping-cart\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst ShoppingCart = createLucideIcon('ShoppingCart', [\n  ['circle', { cx: '8', cy: '21', r: '1', key: 'jimo8o' }],\n  ['circle', { cx: '19', cy: '21', r: '1', key: '13723u' }],\n  [\n    'path',\n    {\n      d: 'M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12',\n      key: '9zh506',\n    },\n  ],\n]);\n\nexport default ShoppingCart;\n","import { createClient } from \"@/lib/supabase/server\"\nimport type {\n  ProductWithCategories,\n  Warehouse,\n  UserRole,\n  DistributorWithProfile,\n  OrderWithItems,\n  DistributorMonthlySales,\n} from \"./types\"\n\n// Obtener todos los silos con sus subcategorías\nexport async function getSilosWithSubcategories() {\n  const supabase = await createClient()\n\n  const { data, error } = await supabase\n    .from(\"silos\")\n    .select(`\n      *,\n      subcategories (*)\n    `)\n    .order(\"order_index\")\n\n  if (error) throw error\n  return data\n}\n\n// Obtener un producto por slug con todas sus relaciones\nexport async function getProductBySlug(slug: string): Promise<ProductWithCategories | null> {\n  const supabase = await createClient()\n\n  const { data, error } = await supabase\n    .from(\"products\")\n    .select(`\n      *,\n      collection:collections(*),\n      product_categories (\n        *,\n        subcategory:subcategories (\n          *,\n          silo:silos (*)\n        )\n      ),\n      product_types:product_product_types (\n        *,\n        product_type:product_types (*)\n      ),\n      product_media (*),\n      product_similar (\n        similar_product:products (*)\n      ),\n      product_complement (\n        complement_product:products (*)\n      ),\n      warehouse_stock:product_warehouse_stock (\n        *,\n        warehouse:warehouses (*)\n      )\n    `)\n    .eq(\"slug\", slug)\n    .eq(\"is_active\", true)\n    .single()\n\n  if (error) {\n    console.log(\"[v0] Error fetching product:\", error)\n    return null\n  }\n  return data\n}\n\n// Obtener productos por categoría\nexport async function getProductsBySubcategory(subcategorySlug: string, limit = 20) {\n  const supabase = await createClient()\n\n  const { data, error } = await supabase\n    .from(\"products\")\n    .select(`\n      *,\n      product_categories!inner (\n        subcategory:subcategories!inner (\n          slug\n        )\n      )\n    `)\n    .eq(\"product_categories.subcategory.slug\", subcategorySlug)\n    .eq(\"is_active\", true)\n    .order(\"pdt_descripcion\")\n    .limit(limit)\n\n  if (error) {\n    return []\n  }\n\n  return data || []\n}\n\n// Obtener tipos de producto disponibles por subcategoría (solo los que tienen productos)\nexport async function getAvailableProductTypesBySubcategory(subcategorySlug: string) {\n  const supabase = await createClient()\n\n  const { error: checkError } = await supabase.from(\"product_types\").select(\"id\").limit(1)\n\n  if (checkError) {\n    console.log(\"[v0] product_types table doesn't exist yet, returning empty array\")\n    return []\n  }\n\n  try {\n    const { data, error } = await supabase\n      .from(\"product_types\")\n      .select(\n        `\n        *,\n        subcategory:subcategories!inner (\n          slug\n        ),\n        product_product_types!inner (\n          product:products!inner (\n            is_active\n          )\n        )\n      `,\n      )\n      .eq(\"subcategory.slug\", subcategorySlug)\n      .eq(\"product_product_types.product.is_active\", true)\n      .order(\"order_index\")\n\n    if (error) {\n      console.log(\"[v0] Error fetching product types:\", error)\n      return []\n    }\n\n    return data || []\n  } catch (err) {\n    console.log(\"[v0] Exception fetching product types:\", err)\n    return []\n  }\n}\n\n// Obtener productos filtrados por subcategoría y tipo de producto\nexport async function getProductsBySubcategoryAndType(subcategorySlug: string, productTypeSlug: string) {\n  const supabase = await createClient()\n\n  const { error: checkError } = await supabase.from(\"product_types\").select(\"id\").limit(1)\n\n  if (checkError) {\n    console.log(\"[v0] product_types table doesn't exist yet, falling back to subcategory only\")\n    return getProductsBySubcategory(subcategorySlug)\n  }\n\n  try {\n    const { data, error } = await supabase\n      .from(\"products\")\n      .select(\n        `\n        *,\n        product_categories!inner (\n          subcategory:subcategories!inner (\n            slug\n          )\n        ),\n        product_product_types!inner (\n          product_type:product_types!inner (\n            slug\n          )\n        )\n      `,\n      )\n      .eq(\"product_categories.subcategory.slug\", subcategorySlug)\n      .eq(\"product_product_types.product_type.slug\", productTypeSlug)\n      .eq(\"is_active\", true)\n      .order(\"pdt_descripcion\")\n\n    if (error) {\n      // Si falla el filtrado por tipo, intentar solo por subcategoría\n      const { data: fallbackData, error: fallbackError } = await supabase\n        .from(\"products\")\n        .select(\n          `\n          *,\n          product_categories!inner (\n            subcategory:subcategories!inner (\n              slug\n            )\n          )\n        `,\n        )\n        .eq(\"product_categories.subcategory.slug\", subcategorySlug)\n        .eq(\"is_active\", true)\n        .order(\"pdt_descripcion\")\n\n      if (fallbackError) {\n        return []\n      }\n\n      return fallbackData || []\n    }\n\n    return data || []\n  } catch (err) {\n    console.log(\"[v0] Exception in getProductsBySubcategoryAndType:\", err)\n    return getProductsBySubcategory(subcategorySlug)\n  }\n}\n\n// Obtener productos destacados\nexport async function getFeaturedProducts(limit = 10) {\n  const supabase = await createClient()\n\n  const { data, error } = await supabase\n    .from(\"products\")\n    .select(\"*\")\n    .eq(\"is_active\", true)\n    .eq(\"is_featured\", true)\n    .limit(limit)\n\n  if (error) throw error\n  return data\n}\n\n// Buscar productos\nexport async function searchProducts(query: string, limit = 20) {\n  const supabase = await createClient()\n\n  const { data, error } = await supabase\n    .from(\"products\")\n    .select(\"*\")\n    .eq(\"is_active\", true)\n    .or(`pdt_descripcion.ilike.%${query}%,nombre_comercial.ilike.%${query}%,pdt_codigo.ilike.%${query}%`)\n    .limit(limit)\n\n  if (error) throw error\n  return data\n}\n\n// Obtener disponibilidad de un producto (sincronizado con ERP)\nexport async function getProductAvailability(productCode: string) {\n  const supabase = await createClient()\n\n  const { data, error } = await supabase\n    .from(\"products\")\n    .select(\"pdt_codigo, upp_existencia, pdt_empaque\")\n    .eq(\"pdt_codigo\", productCode)\n    .single()\n\n  if (error) throw error\n  return data\n}\n\n// Obtener todos los almacenes activos\nexport async function getActiveWarehouses() {\n  const supabase = await createClient()\n\n  const { data, error } = await supabase.from(\"warehouses\").select(\"*\").eq(\"is_active\", true).order(\"order_index\")\n\n  if (error) throw error\n  return data\n}\n\n// Obtener stock de un producto en todos los almacenes\nexport async function getProductStockByWarehouses(productId: string) {\n  const supabase = await createClient()\n\n  const { data, error } = await supabase\n    .from(\"product_warehouse_stock\")\n    .select(`\n      *,\n      warehouse:warehouses (*)\n    `)\n    .eq(\"product_id\", productId)\n    .order(\"warehouse.order_index\")\n\n  if (error) throw error\n  return data\n}\n\n// Obtener stock disponible en almacenes que pueden despachar\nexport async function getAvailableStockForShipping(productId: string) {\n  const supabase = await createClient()\n\n  const { data, error } = await supabase\n    .from(\"product_warehouse_stock\")\n    .select(`\n      *,\n      warehouse:warehouses!inner (*)\n    `)\n    .eq(\"product_id\", productId)\n    .eq(\"warehouse.can_ship\", true)\n    .eq(\"warehouse.is_active\", true)\n    .gt(\"available_quantity\", 0)\n\n  if (error) throw error\n  return data\n}\n\n// Actualizar stock de un producto en un almacén específico\nexport async function updateWarehouseStock(\n  productId: string,\n  warehouseId: string,\n  quantity: number,\n  reservedQuantity = 0,\n) {\n  const supabase = await createClient()\n\n  const { data, error } = await supabase\n    .from(\"product_warehouse_stock\")\n    .upsert({\n      product_id: productId,\n      warehouse_id: warehouseId,\n      quantity,\n      reserved_quantity: reservedQuantity,\n      last_sync_at: new Date().toISOString(),\n    })\n    .select()\n    .single()\n\n  if (error) throw error\n  return data\n}\n\n// Obtener productos con stock bajo por almacén\nexport async function getLowStockProducts(warehouseId?: string) {\n  const supabase = await createClient()\n\n  let query = supabase\n    .from(\"product_warehouse_stock\")\n    .select(`\n      *,\n      product:products (*),\n      warehouse:warehouses (*)\n    `)\n    .filter(\"available_quantity\", \"lte\", \"min_stock\")\n    .gt(\"min_stock\", 0)\n\n  if (warehouseId) {\n    query = query.eq(\"warehouse_id\", warehouseId)\n  }\n\n  const { data, error } = await query\n\n  if (error) throw error\n  return data\n}\n\n// Crear o actualizar almacén\nexport async function upsertWarehouse(warehouse: Partial<Warehouse>) {\n  const supabase = await createClient()\n\n  const { data, error } = await supabase.from(\"warehouses\").upsert(warehouse).select().single()\n\n  if (error) throw error\n  return data\n}\n\n// Obtener resumen de todos los almacenes con estadísticas\nexport async function getWarehouseSummary() {\n  const supabase = await createClient()\n\n  const { data, error } = await supabase\n    .from(\"warehouses\")\n    .select(`\n      *,\n      stock:product_warehouse_stock (\n        quantity,\n        available_quantity,\n        min_stock\n      )\n    `)\n    .eq(\"is_active\", true)\n    .order(\"order_index\")\n\n  if (error) throw error\n  return data\n}\n\n// Obtener perfil de usuario actual\nexport async function getCurrentUserProfile() {\n  const supabase = await createClient()\n\n  const {\n    data: { user },\n  } = await supabase.auth.getUser()\n  if (!user) return null\n\n  const { data, error } = await supabase.from(\"user_profiles\").select(\"*\").eq(\"id\", user.id).single()\n\n  if (error) throw error\n  return data\n}\n\n// Obtener perfil con información de distribuidor si aplica\nexport async function getCurrentUserWithDistributor() {\n  const supabase = await createClient()\n\n  const {\n    data: { user },\n  } = await supabase.auth.getUser()\n  if (!user) return null\n\n  const { data, error } = await supabase\n    .from(\"user_profiles\")\n    .select(`\n      *,\n      distributor:distributors (*)\n    `)\n    .eq(\"id\", user.id)\n    .single()\n\n  if (error) throw error\n  return data\n}\n\n// Crear o actualizar perfil de usuario\nexport async function upsertUserProfile(\n  userId: string,\n  profile: {\n    role?: UserRole\n    full_name?: string\n    phone?: string\n    document_type?: string\n    document_number?: string\n    shipping_address?: string\n    shipping_city?: string\n    shipping_state?: string\n    shipping_postal_code?: string\n    shipping_country?: string\n  },\n) {\n  const supabase = await createClient()\n\n  const { data, error } = await supabase\n    .from(\"user_profiles\")\n    .upsert({\n      id: userId,\n      ...profile,\n    })\n    .select()\n    .single()\n\n  if (error) throw error\n  return data\n}\n\n// Obtener todos los distribuidores (solo superadmin)\nexport async function getAllDistributors() {\n  const supabase = await createClient()\n\n  const { data, error } = await supabase\n    .from(\"distributors\")\n    .select(`\n      *,\n      profile:user_profiles (*)\n    `)\n    .order(\"created_at\", { ascending: false })\n\n  if (error) throw error\n  return data as DistributorWithProfile[]\n}\n\n// Obtener información de distribuidor del usuario actual\nexport async function getCurrentDistributor() {\n  const supabase = await createClient()\n\n  const {\n    data: { user },\n  } = await supabase.auth.getUser()\n  if (!user) return null\n\n  const { data, error } = await supabase\n    .from(\"distributors\")\n    .select(`\n      *,\n      profile:user_profiles (*)\n    `)\n    .eq(\"user_id\", user.id)\n    .single()\n\n  if (error) {\n    if (error.code === \"PGRST116\") return null // No distributor found\n    throw error\n  }\n  return data as DistributorWithProfile\n}\n\n// Crear o actualizar distribuidor\nexport async function upsertDistributor(distributor: {\n  user_id: string\n  company_name: string\n  company_rif?: string\n  business_type?: string\n  discount_percentage?: number\n  monthly_budget_cocina?: number\n  monthly_budget_mesa?: number\n  monthly_budget_cafe_te_bar?: number\n  monthly_budget_termos_neveras?: number\n  monthly_budget_profesional?: number\n  credit_limit?: number\n}) {\n  const supabase = await createClient()\n\n  const { data, error } = await supabase.from(\"distributors\").upsert(distributor).select().single()\n\n  if (error) throw error\n  return data\n}\n\n// Obtener precio para distribuidor (considerando precios personalizados)\nexport async function getPriceForDistributor(productId: string, distributorId: string) {\n  const supabase = await createClient()\n\n  // Primero buscar precio personalizado activo\n  const { data: customPrice } = await supabase\n    .from(\"distributor_custom_prices\")\n    .select(\"custom_price, discount_percentage\")\n    .eq(\"distributor_id\", distributorId)\n    .eq(\"product_id\", productId)\n    .eq(\"is_active\", true)\n    .lte(\"valid_from\", new Date().toISOString())\n    .or(`valid_until.is.null,valid_until.gte.${new Date().toISOString()}`)\n    .single()\n\n  if (customPrice) {\n    return customPrice\n  }\n\n  // Si no hay precio personalizado, usar descuento general del distribuidor\n  const { data: distributor } = await supabase\n    .from(\"distributors\")\n    .select(\"discount_percentage\")\n    .eq(\"id\", distributorId)\n    .single()\n\n  return {\n    custom_price: null,\n    discount_percentage: distributor?.discount_percentage || 0,\n  }\n}\n\n// Obtener productos con mayor rotación (top selling)\nexport async function getTopSellingProducts(limit = 20) {\n  const supabase = await createClient()\n\n  const { data, error } = await supabase\n    .from(\"top_selling_products\")\n    .select(`\n      *,\n      product:products (*)\n    `)\n    .eq(\"is_featured\", true)\n    .order(\"order_index\")\n    .limit(limit)\n\n  if (error) throw error\n  return data\n}\n\n// Crear nueva orden\nexport async function createOrder(\n  order: {\n    user_id: string\n    distributor_id?: string\n    subtotal: number\n    discount_amount?: number\n    tax_amount?: number\n    shipping_cost?: number\n    total: number\n    shipping_full_name?: string\n    shipping_phone?: string\n    shipping_address?: string\n    shipping_city?: string\n    shipping_state?: string\n    shipping_postal_code?: string\n    shipping_country?: string\n    notes?: string\n  },\n  items: {\n    product_id: string\n    quantity: number\n    unit_price: number\n    discount_percentage?: number\n    discount_amount?: number\n    subtotal: number\n    warehouse_id?: string\n  }[],\n) {\n  const supabase = await createClient()\n\n  // Generar número de orden único\n  const orderNumber = `ORD-${Date.now()}-${Math.random().toString(36).substr(2, 9).toUpperCase()}`\n\n  // Crear la orden\n  const { data: newOrder, error: orderError } = await supabase\n    .from(\"orders\")\n    .insert({\n      order_number: orderNumber,\n      ...order,\n    })\n    .select()\n    .single()\n\n  if (orderError) throw orderError\n\n  // Crear los items de la orden\n  const orderItems = items.map((item) => ({\n    order_id: newOrder.id,\n    ...item,\n  }))\n\n  const { error: itemsError } = await supabase.from(\"order_items\").insert(orderItems)\n\n  if (itemsError) throw itemsError\n\n  return newOrder\n}\n\n// Obtener órdenes del usuario actual\nexport async function getCurrentUserOrders(limit = 50) {\n  const supabase = await createClient()\n\n  const {\n    data: { user },\n  } = await supabase.auth.getUser()\n  if (!user) return []\n\n  const { data, error } = await supabase\n    .from(\"orders\")\n    .select(`\n      *,\n      items:order_items (\n        *,\n        product:products (*),\n        warehouse:warehouses (*)\n      )\n    `)\n    .eq(\"user_id\", user.id)\n    .order(\"created_at\", { ascending: false })\n    .limit(limit)\n\n  if (error) throw error\n  return data as OrderWithItems[]\n}\n\n// Obtener una orden específica con todos sus detalles\nexport async function getOrderById(orderId: string) {\n  const supabase = await createClient()\n\n  const { data, error } = await supabase\n    .from(\"orders\")\n    .select(`\n      *,\n      items:order_items (\n        *,\n        product:products (*),\n        warehouse:warehouses (*)\n      ),\n      user:user_profiles (*),\n      distributor:distributors (\n        *,\n        profile:user_profiles (*)\n      )\n    `)\n    .eq(\"id\", orderId)\n    .single()\n\n  if (error) throw error\n  return data as OrderWithItems\n}\n\n// Actualizar estado de orden\nexport async function updateOrderStatus(\n  orderId: string,\n  updates: {\n    status?: string\n    payment_status?: string\n    tracking_number?: string\n    tracking_url?: string\n    carrier?: string\n    shipped_at?: string\n    delivered_at?: string\n    internal_notes?: string\n  },\n) {\n  const supabase = await createClient()\n\n  const { data, error } = await supabase.from(\"orders\").update(updates).eq(\"id\", orderId).select().single()\n\n  if (error) throw error\n  return data\n}\n\n// Obtener ventas mensuales del distribuidor actual\nexport async function getDistributorMonthlySales(year?: number, months = 12) {\n  const supabase = await createClient()\n\n  const distributor = await getCurrentDistributor()\n  if (!distributor) return []\n\n  const currentYear = year || new Date().getFullYear()\n\n  const { data, error } = await supabase\n    .from(\"distributor_monthly_sales\")\n    .select(\"*\")\n    .eq(\"distributor_id\", distributor.id)\n    .gte(\"year\", currentYear - 1) // Últimos 2 años\n    .order(\"year\", { ascending: false })\n    .order(\"month\", { ascending: false })\n    .limit(months)\n\n  if (error) throw error\n  return data as DistributorMonthlySales[]\n}\n\n// Obtener ventas del distribuidor comparadas con presupuesto (mes actual)\nexport async function getDistributorCurrentMonthPerformance() {\n  const supabase = await createClient()\n\n  const distributor = await getCurrentDistributor()\n  if (!distributor) return null\n\n  const now = new Date()\n  const year = now.getFullYear()\n  const month = now.getMonth() + 1\n\n  const { data: sales } = await supabase\n    .from(\"distributor_monthly_sales\")\n    .select(\"*\")\n    .eq(\"distributor_id\", distributor.id)\n    .eq(\"year\", year)\n    .eq(\"month\", month)\n    .single()\n\n  return {\n    sales: sales || {\n      sales_cocina: 0,\n      sales_mesa: 0,\n      sales_cafe_te_bar: 0,\n      sales_termos_neveras: 0,\n      sales_profesional: 0,\n      total_sales: 0,\n      total_orders: 0,\n    },\n    budget: {\n      cocina: distributor.monthly_budget_cocina,\n      mesa: distributor.monthly_budget_mesa,\n      cafe_te_bar: distributor.monthly_budget_cafe_te_bar,\n      termos_neveras: distributor.monthly_budget_termos_neveras,\n      profesional: distributor.monthly_budget_profesional,\n      total:\n        distributor.monthly_budget_cocina +\n        distributor.monthly_budget_mesa +\n        distributor.monthly_budget_cafe_te_bar +\n        distributor.monthly_budget_termos_neveras +\n        distributor.monthly_budget_profesional,\n    },\n    distributor,\n  }\n}\n\n// Calcular ventas mensuales de un distribuidor (función auxiliar para admin)\nexport async function calculateDistributorMonthlySales(distributorId: string, year: number, month: number) {\n  const supabase = await createClient()\n\n  const { error } = await supabase.rpc(\"calculate_distributor_monthly_sales\", {\n    p_distributor_id: distributorId,\n    p_year: year,\n    p_month: month,\n  })\n\n  if (error) throw error\n  return true\n}\n\n// Blog queries\n\n// Get all published blog posts with pagination\nexport async function getBlogPosts(limit = 10, offset = 0) {\n  const supabase = await createClient()\n\n  const { data, error } = await supabase\n    .from(\"blog_posts\")\n    .select(`\n      *,\n      author:user_profiles (*),\n      blog_post_categories (\n        category:blog_categories (*)\n      )\n    `)\n    .eq(\"status\", \"published\")\n    .order(\"published_at\", { ascending: false })\n    .range(offset, offset + limit - 1)\n\n  if (error) throw error\n  return data\n}\n\n// Get a single blog post by slug\nexport async function getBlogPostBySlug(slug: string) {\n  const supabase = await createClient()\n\n  console.log(\"[v0] Searching for blog post with slug:\", slug)\n\n  // Get the post first\n  const { data: post, error } = await supabase\n    .from(\"blog_posts\")\n    .select(\"*\")\n    .eq(\"slug\", slug)\n    .eq(\"status\", \"published\")\n    .single()\n\n  console.log(\"[v0] Blog post query result:\", { found: !!post, error: error?.message })\n\n  if (error) {\n    console.error(\"[v0] Error fetching blog post:\", error)\n    return null\n  }\n\n  if (!post) {\n    console.log(\"[v0] No post found with slug:\", slug)\n    return null\n  }\n\n  // Get author separately to avoid RLS recursion\n  let author = null\n  if (post.author_id) {\n    const { data: authorData } = await supabase\n      .from(\"user_profiles\")\n      .select(\"id, full_name, avatar_url\")\n      .eq(\"id\", post.author_id)\n      .single()\n\n    author = authorData\n  }\n\n  // Get categories separately\n  const { data: postCategories } = await supabase\n    .from(\"blog_post_categories\")\n    .select(`\n      category:blog_categories (\n        id,\n        name,\n        slug\n      )\n    `)\n    .eq(\"post_id\", post.id)\n\n  // Increment views count asynchronously (don't wait for it)\n  supabase\n    .from(\"blog_posts\")\n    .update({ views_count: (post.views_count || 0) + 1 })\n    .eq(\"id\", post.id)\n    .then(() => {})\n\n  return {\n    ...post,\n    author,\n    blog_post_categories: postCategories || [],\n  }\n}\n\n// Get blog posts by category\nexport async function getBlogPostsByCategory(categorySlug: string, limit = 10) {\n  const supabase = await createClient()\n\n  const { data, error } = await supabase\n    .from(\"blog_posts\")\n    .select(`\n      *,\n      author:user_profiles (*),\n      blog_post_categories!inner (\n        category:blog_categories!inner (slug)\n      )\n    `)\n    .eq(\"blog_post_categories.blog_categories.slug\", categorySlug)\n    .eq(\"status\", \"published\")\n    .order(\"published_at\", { ascending: false })\n    .limit(limit)\n\n  if (error) throw error\n  return data\n}\n\n// Get all blog categories with post count\nexport async function getBlogCategories() {\n  const supabase = await createClient()\n\n  const { data, error } = await supabase\n    .from(\"blog_categories\")\n    .select(`\n      *,\n      blog_post_categories (count)\n    `)\n    .order(\"name\")\n\n  if (error) throw error\n  return data\n}\n\n// Search blog posts\nexport async function searchBlogPosts(query: string, limit = 20) {\n  const supabase = await createClient()\n\n  const { data, error } = await supabase\n    .from(\"blog_posts\")\n    .select(`\n      *,\n      author:user_profiles (*),\n      blog_post_categories (\n        category:blog_categories (*)\n      )\n    `)\n    .eq(\"status\", \"published\")\n    .or(`title.ilike.%${query}%,excerpt.ilike.%${query}%,content.ilike.%${query}%`)\n    .order(\"published_at\", { ascending: false })\n    .limit(limit)\n\n  if (error) throw error\n  return data\n}\n\n// Get recent blog posts\nexport async function getRecentBlogPosts(limit = 5) {\n  const supabase = await createClient()\n\n  const { data, error } = await supabase\n    .from(\"blog_posts\")\n    .select(\"id, slug, title, excerpt, featured_image_url, published_at\")\n    .eq(\"status\", \"published\")\n    .order(\"published_at\", { ascending: false })\n    .limit(limit)\n\n  if (error) throw error\n  return data\n}\n\n// Get related blog posts based on categories\nexport async function getRelatedBlogPosts(postId: string, limit = 3) {\n  const supabase = await createClient()\n\n  // Get categories of current post\n  const { data: currentCategories } = await supabase\n    .from(\"blog_post_categories\")\n    .select(\"category_id\")\n    .eq(\"post_id\", postId)\n\n  if (!currentCategories || currentCategories.length === 0) {\n    // If no categories, return recent posts\n    const { data, error } = await supabase\n      .from(\"blog_posts\")\n      .select(\"id, slug, title, excerpt, featured_image_url, published_at\")\n      .eq(\"status\", \"published\")\n      .neq(\"id\", postId)\n      .order(\"published_at\", { ascending: false })\n      .limit(limit)\n\n    return data || []\n  }\n\n  const categoryIds = currentCategories.map((c) => c.category_id)\n\n  // Get posts with same categories\n  const { data: relatedPostIds } = await supabase\n    .from(\"blog_post_categories\")\n    .select(\"post_id\")\n    .in(\"category_id\", categoryIds)\n    .neq(\"post_id\", postId)\n\n  if (!relatedPostIds || relatedPostIds.length === 0) {\n    return []\n  }\n\n  const postIds = [...new Set(relatedPostIds.map((p) => p.post_id))]\n\n  const { data, error } = await supabase\n    .from(\"blog_posts\")\n    .select(\"id, slug, title, excerpt, featured_image_url, published_at\")\n    .eq(\"status\", \"published\")\n    .in(\"id\", postIds)\n    .order(\"published_at\", { ascending: false })\n    .limit(limit)\n\n  return data || []\n}\n\n// Admin: Create or update blog post\nexport async function upsertBlogPost(post: {\n  id?: string\n  slug: string\n  title: string\n  excerpt?: string\n  content: string\n  featured_image_url?: string\n  status?: \"draft\" | \"published\" | \"archived\"\n  published_at?: string\n  author_id?: string\n}) {\n  const supabase = await createClient()\n\n  const { data, error } = await supabase.from(\"blog_posts\").upsert(post).select().single()\n\n  if (error) throw error\n  return data\n}\n\n// Admin: Delete blog post\nexport async function deleteBlogPost(postId: string) {\n  const supabase = await createClient()\n\n  const { error } = await supabase.from(\"blog_posts\").delete().eq(\"id\", postId)\n\n  if (error) throw error\n  return true\n}\n","// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const FavoriteButton = registerClientReference(\n    function() { throw new Error(\"Attempted to call FavoriteButton() from the server but FavoriteButton is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/products/favorite-button.tsx\",\n    \"FavoriteButton\",\n);\n","import Image from \"next/image\"\nimport Link from \"next/link\"\nimport type { Product } from \"@/lib/db/types\"\nimport { Card, CardContent, CardFooter } from \"@/components/ui/card\"\nimport { Badge } from \"@/components/ui/badge\"\nimport { Button } from \"@/components/ui/button\"\nimport { ShoppingCart } from \"lucide-react\"\nimport { FavoriteButton } from \"@/components/products/favorite-button\"\n\ninterface ProductCardProps {\n  product: Product\n  showFavoriteButton?: boolean\n  isFavorited?: boolean\n}\n\nexport function ProductCard({ product, showFavoriteButton = true, isFavorited = false }: ProductCardProps) {\n  const hasStock = product.upp_existencia > 0\n\n  return (\n    <Card className=\"group overflow-hidden h-full flex flex-col\">\n      <div className=\"relative\">\n        <Link href={`/productos/${product.slug}`} className=\"block\">\n          <div className=\"relative aspect-square overflow-hidden bg-muted\">\n            <Image\n              src={product.imagen_principal_url || \"/placeholder.svg?height=300&width=300\"}\n              alt={product.nombre_comercial || product.pdt_descripcion}\n              fill\n              className=\"object-cover group-hover:scale-105 transition-transform duration-300\"\n              sizes=\"(max-width: 768px) 50vw, 25vw\"\n            />\n\n            {/* Badges */}\n            <div className=\"absolute top-2 left-2 flex flex-col gap-1\">\n              {product.is_new && (\n                <Badge variant=\"default\" className=\"w-fit\">\n                  Nuevo\n                </Badge>\n              )}\n              {product.is_on_sale && (\n                <Badge variant=\"destructive\" className=\"w-fit\">\n                  Oferta\n                </Badge>\n              )}\n              {!hasStock && (\n                <Badge variant=\"secondary\" className=\"w-fit\">\n                  Agotado\n                </Badge>\n              )}\n            </div>\n          </div>\n        </Link>\n        \n        {/* Favorite Button */}\n        {showFavoriteButton && (\n          <div className=\"absolute top-2 right-2 z-10\">\n            <FavoriteButton \n              productId={product.id} \n              initialIsFavorite={isFavorited}\n              className=\"bg-background/80 backdrop-blur-sm hover:bg-background\"\n            />\n          </div>\n        )}\n      </div>\n\n      <CardContent className=\"p-4 flex-1\">\n        <Link href={`/productos/${product.slug}`}>\n          <h3 className=\"font-semibold text-sm mb-1 line-clamp-2 group-hover:text-primary transition-colors\">\n            {product.nombre_comercial || product.pdt_descripcion}\n          </h3>\n        </Link>\n        <p className=\"text-xs text-muted-foreground mb-2\">Código: {product.pdt_codigo}</p>\n        <div className=\"flex items-baseline gap-2\">\n          <span className=\"text-lg font-bold\">${product.precio?.toFixed(2)}</span>\n          {product.is_on_sale && (\n            <span className=\"text-sm text-muted-foreground line-through\">${(product.precio! * 1.2).toFixed(2)}</span>\n          )}\n        </div>\n      </CardContent>\n\n      <CardFooter className=\"p-4 pt-0\">\n        <Button className=\"w-full\" size=\"sm\" disabled={!hasStock}>\n          <ShoppingCart className=\"h-4 w-4 mr-2\" />\n          {hasStock ? \"Agregar\" : \"Agotado\"}\n        </Button>\n      </CardFooter>\n    </Card>\n  )\n}\n","import { Suspense } from \"react\"\nimport { searchProducts } from \"@/lib/db/queries\"\nimport { ProductCard } from \"@/components/products/product-card\"\nimport { Search } from \"lucide-react\"\nimport Link from \"next/link\"\nimport { Button } from \"@/components/ui/button\"\n\nasync function SearchResults({ query }: { query: string }) {\n  if (!query || query.trim().length === 0) {\n    return (\n      <div className=\"text-center py-12\">\n        <Search className=\"h-12 w-12 mx-auto text-muted-foreground mb-4\" />\n        <h2 className=\"text-xl font-semibold mb-2\">Ingresa un término de búsqueda</h2>\n        <p className=\"text-muted-foreground\">Usa la barra de búsqueda para encontrar productos</p>\n      </div>\n    )\n  }\n\n  const products = await searchProducts(query, 50)\n\n  if (!products || products.length === 0) {\n    return (\n      <div className=\"text-center py-12\">\n        <Search className=\"h-12 w-12 mx-auto text-muted-foreground mb-4\" />\n        <h2 className=\"text-xl font-semibold mb-2\">No se encontraron resultados</h2>\n        <p className=\"text-muted-foreground mb-6\">No encontramos productos que coincidan con \"{query}\"</p>\n        <Button asChild>\n          <Link href=\"/productos\">Ver todos los productos</Link>\n        </Button>\n      </div>\n    )\n  }\n\n  return (\n    <div>\n      <p className=\"text-muted-foreground mb-6\">\n        Se encontraron {products.length} producto{products.length !== 1 ? \"s\" : \"\"} para \"{query}\"\n      </p>\n      <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6\">\n        {products.map((product) => (\n          <ProductCard key={product.id} product={product} />\n        ))}\n      </div>\n    </div>\n  )\n}\n\nexport default async function SearchPage({\n  searchParams,\n}: {\n  searchParams: Promise<{ q?: string }>\n}) {\n  const params = await searchParams\n  const query = params.q || \"\"\n\n  return (\n    <div className=\"container py-8\">\n      <div className=\"mb-8\">\n        <h1 className=\"text-3xl font-bold mb-2\">Resultados de búsqueda</h1>\n        {query && (\n          <p className=\"text-muted-foreground\">\n            Buscando: <span className=\"font-medium text-foreground\">{query}</span>\n          </p>\n        )}\n      </div>\n\n      <Suspense\n        fallback={\n          <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6\">\n            {Array.from({ length: 8 }).map((_, i) => (\n              <div key={i} className=\"h-80 bg-muted animate-pulse rounded-lg\" />\n            ))}\n          </div>\n        }\n      >\n        <SearchResults query={query} />\n      </Suspense>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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","ignoreList":[1,3]}