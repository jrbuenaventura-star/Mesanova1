{"version":3,"sources":["../../../lib/csv/product-importer.ts","../../../lib/csv/product-parser.ts"],"sourcesContent":["import { createClient } from '@/lib/supabase/server';\nimport {\n  ParsedProduct,\n  ProductDiff,\n  parseBooleanValue,\n  parseNumericValue,\n} from './product-parser';\nimport { ProductCSVRow } from './product-template';\n\nexport interface ImportResult {\n  success: boolean;\n  importId: string;\n  created: number;\n  updated: number;\n  skipped: number;\n  errors: ImportError[];\n}\n\nexport interface ImportError {\n  row: number;\n  ref: string;\n  error: string;\n}\n\ninterface CategoryInfo {\n  siloId: string;\n  subcategoryId: string;\n  productTypeId?: string;\n}\n\nexport async function importProducts(\n  products: ParsedProduct[],\n  diffs: ProductDiff[],\n  importMode: 'update' | 'add_only' | 'replace_all',\n  userId: string,\n  filename: string\n): Promise<ImportResult> {\n  const supabase = await createClient();\n  const errors: ImportError[] = [];\n  let created = 0;\n  let updated = 0;\n  let skipped = 0;\n  \n  // Crear registro de importación\n  const { data: importRecord, error: importError } = await supabase\n    .from('csv_imports')\n    .insert({\n      filename,\n      total_rows: products.length,\n      status: 'processing',\n      import_mode: importMode,\n      imported_by: userId,\n      started_at: new Date().toISOString(),\n    })\n    .select('id')\n    .single();\n  \n  if (importError || !importRecord) {\n    return {\n      success: false,\n      importId: '',\n      created: 0,\n      updated: 0,\n      skipped: 0,\n      errors: [{ row: 0, ref: '', error: 'Error al crear registro de importación' }],\n    };\n  }\n  \n  const importId = importRecord.id;\n  \n  // Pre-cargar categorías\n  const categoryCache = await loadCategoryCache(supabase);\n  \n  // Procesar cada producto\n  for (let i = 0; i < products.length; i++) {\n    const product = products[i];\n    const diff = diffs.find(d => d.ref === product.data.Ref);\n    \n    if (!product.isValid) {\n      skipped++;\n      continue;\n    }\n    \n    if (!diff) {\n      skipped++;\n      continue;\n    }\n    \n    try {\n      if (diff.changeType === 'create') {\n        if (importMode === 'update') {\n          // En modo update, también se crean nuevos\n          await createProduct(supabase, product.data, categoryCache, userId, importId, product.row);\n          created++;\n        } else if (importMode === 'add_only') {\n          await createProduct(supabase, product.data, categoryCache, userId, importId, product.row);\n          created++;\n        } else {\n          await createProduct(supabase, product.data, categoryCache, userId, importId, product.row);\n          created++;\n        }\n      } else if (diff.changeType === 'update') {\n        if (importMode === 'add_only') {\n          skipped++;\n        } else {\n          await updateProduct(supabase, product.data, diff, categoryCache, userId, importId, product.row);\n          updated++;\n        }\n      } else {\n        skipped++;\n      }\n    } catch (error) {\n      errors.push({\n        row: product.row,\n        ref: product.data.Ref,\n        error: error instanceof Error ? error.message : 'Error desconocido',\n      });\n    }\n  }\n  \n  // Actualizar registro de importación\n  await supabase\n    .from('csv_imports')\n    .update({\n      rows_created: created,\n      rows_updated: updated,\n      rows_skipped: skipped,\n      rows_error: errors.length,\n      errors: errors.length > 0 ? errors : null,\n      status: errors.length === 0 ? 'completed' : 'completed_with_errors',\n      completed_at: new Date().toISOString(),\n    })\n    .eq('id', importId);\n  \n  return {\n    success: errors.length === 0,\n    importId,\n    created,\n    updated,\n    skipped,\n    errors,\n  };\n}\n\nasync function loadCategoryCache(supabase: Awaited<ReturnType<typeof createClient>>) {\n  const cache: Map<string, CategoryInfo> = new Map();\n  \n  // Cargar silos\n  const { data: silos } = await supabase\n    .from('silos')\n    .select('id, slug, name');\n  \n  // Cargar subcategorías\n  const { data: subcategories } = await supabase\n    .from('subcategories')\n    .select('id, slug, name, silo_id');\n  \n  // Cargar tipos de producto\n  const { data: productTypes } = await supabase\n    .from('product_types')\n    .select('id, slug, name, subcategory_id');\n  \n  // Crear mapa combinado\n  if (silos && subcategories) {\n    for (const silo of silos) {\n      const siloSubs = subcategories.filter(s => s.silo_id === silo.id);\n      for (const sub of siloSubs) {\n        // Clave: \"categoria|subcategoria\"\n        const key = `${silo.name.toLowerCase()}|${sub.name.toLowerCase()}`;\n        cache.set(key, {\n          siloId: silo.id,\n          subcategoryId: sub.id,\n        });\n        \n        // También agregar tipos si existen\n        if (productTypes) {\n          const subTypes = productTypes.filter(t => t.subcategory_id === sub.id);\n          for (const type of subTypes) {\n            const typeKey = `${silo.name.toLowerCase()}|${sub.name.toLowerCase()}|${type.name.toLowerCase()}`;\n            cache.set(typeKey, {\n              siloId: silo.id,\n              subcategoryId: sub.id,\n              productTypeId: type.id,\n            });\n          }\n        }\n      }\n    }\n  }\n  \n  return cache;\n}\n\nfunction getCategoryInfo(\n  data: ProductCSVRow,\n  cache: Map<string, CategoryInfo>\n): CategoryInfo | null {\n  const categoria = data.Categoria?.toLowerCase().trim() || '';\n  const subcategoria = data.Subcategoria?.toLowerCase().trim() || '';\n  const tipo = data.Tipo_producto?.toLowerCase().trim() || '';\n  \n  // Intentar con los 3 niveles\n  if (tipo) {\n    const key = `${categoria}|${subcategoria}|${tipo}`;\n    const info = cache.get(key);\n    if (info) return info;\n  }\n  \n  // Intentar con 2 niveles\n  if (subcategoria) {\n    const key = `${categoria}|${subcategoria}`;\n    const info = cache.get(key);\n    if (info) return info;\n  }\n  \n  return null;\n}\n\nasync function createProduct(\n  supabase: Awaited<ReturnType<typeof createClient>>,\n  data: ProductCSVRow,\n  categoryCache: Map<string, CategoryInfo>,\n  userId: string,\n  importId: string,\n  rowNumber: number\n): Promise<void> {\n  // Generar slug\n  const slug = generateSlug(data.Producto);\n  \n  // Obtener categoría\n  const categoryInfo = getCategoryInfo(data, categoryCache);\n  \n  // Crear producto\n  const { data: product, error } = await supabase\n    .from('products')\n    .insert({\n      pdt_codigo: data.Ref,\n      codigo_barras: data.Cod_Barra || null,\n      nombre_comercial: data.Producto,\n      pdt_descripcion: data.Descripcion || null,\n      marca: data.Marca || null,\n      precio: parseNumericValue(data.Precio_COP),\n      descuento_porcentaje: parseNumericValue(data.Descuento) || 0,\n      upp_existencia: parseNumericValue(data.Existencia_inv) || 0,\n      pedido_en_camino: parseBooleanValue(data.Pedido_en_camino),\n      descontinuado: parseBooleanValue(data.Descontinuado),\n      pdt_empaque: data.Inner_pack || null,\n      outer_pack: parseNumericValue(data.Outer_pack) as number | null,\n      nombre_coleccion: data.Coleccion || null,\n      product_type_id: categoryInfo?.productTypeId || null,\n      material: data.Material || null,\n      color: data.Color || null,\n      dimensiones: data.Dimensiones || null,\n      peso: parseNumericValue(data.Peso_kg),\n      capacidad: data.Capacidad || null,\n      pais_origen: data.Pais_origen || null,\n      descripcion_larga: data.Descrip_Cliente_Final || null,\n      momentos_uso: data.Momentos_Uso_Cliente || null,\n      productos_afines_csv: data.Productos_Afines_Cliente || null,\n      descripcion_distribuidor: data.Descrip_Distribuidor || null,\n      argumentos_venta: data.Argumentos_Venta_Distribuidor || null,\n      ubicacion_tienda: data.Ubicacion_Tienda_Distribuidor || null,\n      margen_sugerido: parseNumericValue(data.Margen_Sugerido),\n      rotacion_esperada: data.Rotacion_Esperada?.toLowerCase() || null,\n      seo_title: data.SEO_Title || null,\n      seo_description: data.SEO_Description || null,\n      tags: data.Tags ? data.Tags.split(',').map(t => t.trim()) : null,\n      video_url: data.Video_URL || null,\n      ficha_tecnica_url: data.Ficha_Tecnica_URL || null,\n      fecha_lanzamiento: data.Fecha_Lanzamiento || null,\n      imagen_principal_url: data.Image_1 || null,\n      slug,\n      is_active: true,\n      is_on_sale: (parseNumericValue(data.Descuento) || 0) > 0,\n      last_csv_update: new Date().toISOString(),\n      created_by: userId,\n      updated_by: userId,\n    })\n    .select('id')\n    .single();\n  \n  if (error) {\n    throw new Error(`Error creando producto: ${error.message}`);\n  }\n  \n  // Asociar con categoría\n  if (product && categoryInfo) {\n    await supabase\n      .from('product_categories')\n      .insert({\n        product_id: product.id,\n        subcategory_id: categoryInfo.subcategoryId,\n        is_primary: true,\n      });\n  }\n  \n  // Insertar imágenes adicionales\n  if (product) {\n    await insertProductImages(supabase, product.id, data);\n  }\n  \n  // Crear log de cambio\n  await supabase\n    .from('product_change_log')\n    .insert({\n      product_id: product?.id,\n      change_type: 'create',\n      change_source: 'csv',\n      fields_changed: { all: 'new product' },\n      changed_by: userId,\n      csv_filename: importId,\n      csv_row_number: rowNumber,\n    });\n}\n\nasync function updateProduct(\n  supabase: Awaited<ReturnType<typeof createClient>>,\n  data: ProductCSVRow,\n  diff: ProductDiff,\n  categoryCache: Map<string, CategoryInfo>,\n  userId: string,\n  importId: string,\n  rowNumber: number\n): Promise<void> {\n  // Obtener producto existente\n  const { data: existingProduct } = await supabase\n    .from('products')\n    .select('id')\n    .eq('pdt_codigo', data.Ref)\n    .single();\n  \n  if (!existingProduct) {\n    throw new Error('Producto no encontrado para actualizar');\n  }\n  \n  const productId = existingProduct.id;\n  const categoryInfo = getCategoryInfo(data, categoryCache);\n  \n  // Construir objeto de actualización solo con campos cambiados\n  const updateData: Record<string, unknown> = {\n    updated_by: userId,\n    last_csv_update: new Date().toISOString(),\n    is_on_sale: (parseNumericValue(data.Descuento) || 0) > 0,\n  };\n  \n  // Mapear campos CSV a campos de BD\n  const fieldMap: Record<string, { dbField: string; transform?: (v: string) => unknown }> = {\n    Cod_Barra: { dbField: 'codigo_barras' },\n    Producto: { dbField: 'nombre_comercial' },\n    Descripcion: { dbField: 'pdt_descripcion' },\n    Marca: { dbField: 'marca' },\n    Precio_COP: { dbField: 'precio', transform: parseNumericValue },\n    Descuento: { dbField: 'descuento_porcentaje', transform: (v) => parseNumericValue(v) || 0 },\n    Existencia_inv: { dbField: 'upp_existencia', transform: (v) => parseNumericValue(v) || 0 },\n    Pedido_en_camino: { dbField: 'pedido_en_camino', transform: parseBooleanValue },\n    Descontinuado: { dbField: 'descontinuado', transform: parseBooleanValue },\n    Inner_pack: { dbField: 'pdt_empaque' },\n    Outer_pack: { dbField: 'outer_pack', transform: parseNumericValue },\n    Coleccion: { dbField: 'nombre_coleccion' },\n    Material: { dbField: 'material' },\n    Color: { dbField: 'color' },\n    Dimensiones: { dbField: 'dimensiones' },\n    Peso_kg: { dbField: 'peso', transform: parseNumericValue },\n    Capacidad: { dbField: 'capacidad' },\n    Pais_origen: { dbField: 'pais_origen' },\n    Descrip_Cliente_Final: { dbField: 'descripcion_larga' },\n    Momentos_Uso_Cliente: { dbField: 'momentos_uso' },\n    Productos_Afines_Cliente: { dbField: 'productos_afines_csv' },\n    Descrip_Distribuidor: { dbField: 'descripcion_distribuidor' },\n    Argumentos_Venta_Distribuidor: { dbField: 'argumentos_venta' },\n    Ubicacion_Tienda_Distribuidor: { dbField: 'ubicacion_tienda' },\n    Margen_Sugerido: { dbField: 'margen_sugerido', transform: parseNumericValue },\n    Rotacion_Esperada: { dbField: 'rotacion_esperada', transform: (v) => v?.toLowerCase() || null },\n    SEO_Title: { dbField: 'seo_title' },\n    SEO_Description: { dbField: 'seo_description' },\n    Tags: { dbField: 'tags', transform: (v) => v ? v.split(',').map(t => t.trim()) : null },\n    Video_URL: { dbField: 'video_url' },\n    Ficha_Tecnica_URL: { dbField: 'ficha_tecnica_url' },\n    Fecha_Lanzamiento: { dbField: 'fecha_lanzamiento' },\n    Image_1: { dbField: 'imagen_principal_url' },\n  };\n  \n  for (const change of diff.changes) {\n    const mapping = fieldMap[change.field];\n    if (mapping) {\n      const value = data[change.field as keyof ProductCSVRow];\n      updateData[mapping.dbField] = mapping.transform \n        ? mapping.transform(value) \n        : (value || null);\n    }\n  }\n  \n  // Actualizar producto\n  const { error } = await supabase\n    .from('products')\n    .update(updateData)\n    .eq('id', productId);\n  \n  if (error) {\n    throw new Error(`Error actualizando producto: ${error.message}`);\n  }\n  \n  // Actualizar tipo de producto si cambió\n  if (categoryInfo?.productTypeId) {\n    await supabase\n      .from('products')\n      .update({ product_type_id: categoryInfo.productTypeId })\n      .eq('id', productId);\n  }\n  \n  // Actualizar imágenes si cambiaron\n  const imageChanges = diff.changes.filter(c => c.field.startsWith('Image_'));\n  if (imageChanges.length > 0) {\n    // Eliminar imágenes existentes y reinsertar\n    await supabase\n      .from('product_media')\n      .delete()\n      .eq('product_id', productId);\n    \n    await insertProductImages(supabase, productId, data);\n  }\n  \n  // Crear log de cambio\n  const changesJson: Record<string, { old: string | null; new: string | null }> = {};\n  for (const change of diff.changes) {\n    changesJson[change.field] = {\n      old: change.oldValue,\n      new: change.newValue,\n    };\n  }\n  \n  await supabase\n    .from('product_change_log')\n    .insert({\n      product_id: productId,\n      change_type: 'update',\n      change_source: 'csv',\n      fields_changed: changesJson,\n      changed_by: userId,\n      csv_filename: importId,\n      csv_row_number: rowNumber,\n    });\n}\n\nasync function insertProductImages(\n  supabase: Awaited<ReturnType<typeof createClient>>,\n  productId: string,\n  data: ProductCSVRow\n): Promise<void> {\n  const images: { product_id: string; media_type: string; url: string; order_index: number }[] = [];\n  \n  const imageFields: (keyof ProductCSVRow)[] = [\n    'Image_2', 'Image_3', 'Image_4', 'Image_5',\n    'Image_6', 'Image_7', 'Image_8', 'Image_9', 'Image_10',\n  ];\n  \n  for (let i = 0; i < imageFields.length; i++) {\n    const url = data[imageFields[i]];\n    if (url && url.trim() !== '') {\n      images.push({\n        product_id: productId,\n        media_type: 'image',\n        url: url.trim(),\n        order_index: i + 2, // Image_1 es principal, estas empiezan en 2\n      });\n    }\n  }\n  \n  if (images.length > 0) {\n    await supabase.from('product_media').insert(images);\n  }\n}\n\nfunction generateSlug(name: string): string {\n  return name\n    .toLowerCase()\n    .normalize('NFD')\n    .replace(/[\\u0300-\\u036f]/g, '') // Remover acentos\n    .replace(/[^a-z0-9\\s-]/g, '') // Solo alfanuméricos\n    .replace(/\\s+/g, '-') // Espacios a guiones\n    .replace(/-+/g, '-') // Múltiples guiones a uno\n    .replace(/^-|-$/g, ''); // Remover guiones inicio/fin\n}\n\nexport async function getExistingProductsMap(\n  supabase: Awaited<ReturnType<typeof createClient>>\n): Promise<Map<string, Record<string, unknown>>> {\n  const { data: products } = await supabase\n    .from('products')\n    .select('*');\n  \n  const map = new Map<string, Record<string, unknown>>();\n  if (products) {\n    for (const product of products) {\n      map.set(product.pdt_codigo, product);\n    }\n  }\n  \n  return map;\n}\n\nexport async function exportProductsToCSV(\n  supabase: Awaited<ReturnType<typeof createClient>>\n): Promise<string> {\n  const { data: products } = await supabase\n    .from('products')\n    .select(`\n      *,\n      product_categories!inner(\n        subcategory:subcategories(\n          name,\n          silo:silos(name)\n        )\n      ),\n      product_type:product_types(name),\n      product_media(url, order_index)\n    `)\n    .order('pdt_codigo');\n  \n  if (!products || products.length === 0) {\n    return '';\n  }\n  \n  const { CSV_HEADERS } = await import('./product-template');\n  \n  const rows: string[] = [CSV_HEADERS.join(',')];\n  \n  for (const product of products) {\n    const category = product.product_categories?.[0]?.subcategory;\n    const images = product.product_media?.sort((a: { order_index: number }, b: { order_index: number }) => a.order_index - b.order_index) || [];\n    \n    const row: string[] = [\n      escapeCSV(product.pdt_codigo || ''),\n      escapeCSV(product.codigo_barras || ''),\n      escapeCSV(product.nombre_comercial || ''),\n      escapeCSV(product.pdt_descripcion || ''),\n      escapeCSV(product.marca || ''),\n      String(product.precio || ''),\n      String(product.descuento_porcentaje || '0'),\n      String(product.upp_existencia || '0'),\n      product.pedido_en_camino ? 'SI' : 'NO',\n      product.descontinuado ? 'SI' : 'NO',\n      escapeCSV(product.pdt_empaque || ''),\n      String(product.outer_pack || ''),\n      escapeCSV(product.nombre_coleccion || ''),\n      escapeCSV(category?.silo?.name || ''),\n      escapeCSV(category?.name || ''),\n      escapeCSV(product.product_type?.name || ''),\n      escapeCSV(product.material || ''),\n      escapeCSV(product.color || ''),\n      escapeCSV(product.dimensiones || ''),\n      String(product.peso || ''),\n      escapeCSV(product.capacidad || ''),\n      escapeCSV(product.pais_origen || ''),\n      escapeCSV(product.descripcion_larga || ''),\n      escapeCSV(product.momentos_uso || ''),\n      escapeCSV(product.productos_afines_csv || ''),\n      escapeCSV(product.descripcion_distribuidor || ''),\n      escapeCSV(product.argumentos_venta || ''),\n      escapeCSV(product.ubicacion_tienda || ''),\n      String(product.margen_sugerido || ''),\n      escapeCSV(product.rotacion_esperada || ''),\n      escapeCSV(product.seo_title || ''),\n      escapeCSV(product.seo_description || ''),\n      escapeCSV((product.tags || []).join(',')),\n      escapeCSV(product.video_url || ''),\n      escapeCSV(product.ficha_tecnica_url || ''),\n      escapeCSV(product.fecha_lanzamiento || ''),\n      escapeCSV(product.imagen_principal_url || ''),\n      ...Array.from({ length: 9 }, (_, i) => {\n        const img = images.find((m: { order_index: number }) => m.order_index === i + 2);\n        return escapeCSV(img?.url || '');\n      }),\n    ];\n    \n    rows.push(row.join(','));\n  }\n  \n  return rows.join('\\n');\n}\n\nfunction escapeCSV(value: string): string {\n  if (!value) return '';\n  if (value.includes(',') || value.includes('\"') || value.includes('\\n')) {\n    return `\"${value.replace(/\"/g, '\"\"')}\"`;\n  }\n  return value;\n}\n","import {\n  ProductCSVRow,\n  CSV_HEADERS,\n  REQUIRED_FIELDS,\n  BOOLEAN_FIELDS,\n  NUMERIC_FIELDS,\n  VALID_CATEGORIES,\n  VALID_ROTACION,\n} from './product-template';\n\nexport interface ParsedProduct {\n  row: number;\n  data: ProductCSVRow;\n  errors: ValidationError[];\n  warnings: ValidationWarning[];\n  isValid: boolean;\n}\n\nexport interface ValidationError {\n  field: keyof ProductCSVRow;\n  message: string;\n  value: string;\n}\n\nexport interface ValidationWarning {\n  field: keyof ProductCSVRow;\n  message: string;\n  value: string;\n}\n\nexport interface CSVParseResult {\n  success: boolean;\n  totalRows: number;\n  validRows: number;\n  invalidRows: number;\n  products: ParsedProduct[];\n  globalErrors: string[];\n}\n\nexport interface ProductChange {\n  field: string;\n  oldValue: string | null;\n  newValue: string | null;\n}\n\nexport interface ProductDiff {\n  ref: string;\n  changeType: 'create' | 'update' | 'unchanged';\n  changes: ProductChange[];\n}\n\nfunction parseCSVLine(line: string): string[] {\n  const result: string[] = [];\n  let current = '';\n  let inQuotes = false;\n  \n  for (let i = 0; i < line.length; i++) {\n    const char = line[i];\n    const nextChar = line[i + 1];\n    \n    if (char === '\"') {\n      if (inQuotes && nextChar === '\"') {\n        current += '\"';\n        i++;\n      } else {\n        inQuotes = !inQuotes;\n      }\n    } else if (char === ',' && !inQuotes) {\n      result.push(current.trim());\n      current = '';\n    } else {\n      current += char;\n    }\n  }\n  \n  result.push(current.trim());\n  return result;\n}\n\nfunction validateRow(row: ProductCSVRow, rowNumber: number): { errors: ValidationError[]; warnings: ValidationWarning[] } {\n  const errors: ValidationError[] = [];\n  const warnings: ValidationWarning[] = [];\n  \n  // Validar campos requeridos\n  for (const field of REQUIRED_FIELDS) {\n    if (!row[field] || row[field].trim() === '') {\n      errors.push({\n        field,\n        message: `El campo ${field} es obligatorio`,\n        value: row[field] || '',\n      });\n    }\n  }\n  \n  // Validar campos numéricos\n  for (const field of NUMERIC_FIELDS) {\n    const value = row[field];\n    if (value && value.trim() !== '') {\n      const numValue = parseFloat(value.replace(/[,$]/g, ''));\n      if (isNaN(numValue)) {\n        errors.push({\n          field,\n          message: `El campo ${field} debe ser un número válido`,\n          value,\n        });\n      } else if (numValue < 0) {\n        errors.push({\n          field,\n          message: `El campo ${field} no puede ser negativo`,\n          value,\n        });\n      }\n    }\n  }\n  \n  // Validar campos booleanos\n  for (const field of BOOLEAN_FIELDS) {\n    const value = row[field]?.toUpperCase();\n    if (value && value !== '' && value !== 'SI' && value !== 'NO' && value !== 'TRUE' && value !== 'FALSE' && value !== '1' && value !== '0') {\n      errors.push({\n        field,\n        message: `El campo ${field} debe ser SI/NO`,\n        value: row[field],\n      });\n    }\n  }\n  \n  // Validar categoría\n  if (row.Categoria && row.Categoria.trim() !== '') {\n    const normalizedCat = row.Categoria.trim();\n    if (!VALID_CATEGORIES.some(c => c.toLowerCase() === normalizedCat.toLowerCase())) {\n      warnings.push({\n        field: 'Categoria',\n        message: `Categoría \"${normalizedCat}\" no reconocida. Válidas: ${VALID_CATEGORIES.join(', ')}`,\n        value: row.Categoria,\n      });\n    }\n  }\n  \n  // Validar rotación esperada\n  if (row.Rotacion_Esperada && row.Rotacion_Esperada.trim() !== '') {\n    const rotacion = row.Rotacion_Esperada.toLowerCase().trim();\n    if (!VALID_ROTACION.includes(rotacion)) {\n      errors.push({\n        field: 'Rotacion_Esperada',\n        message: `Rotación debe ser: ${VALID_ROTACION.join(', ')}`,\n        value: row.Rotacion_Esperada,\n      });\n    }\n  }\n  \n  // Validar descuento (0-100)\n  if (row.Descuento && row.Descuento.trim() !== '') {\n    const descuento = parseFloat(row.Descuento);\n    if (!isNaN(descuento) && (descuento < 0 || descuento > 100)) {\n      errors.push({\n        field: 'Descuento',\n        message: 'El descuento debe estar entre 0 y 100',\n        value: row.Descuento,\n      });\n    }\n  }\n  \n  // Validar margen sugerido (0-100)\n  if (row.Margen_Sugerido && row.Margen_Sugerido.trim() !== '') {\n    const margen = parseFloat(row.Margen_Sugerido);\n    if (!isNaN(margen) && (margen < 0 || margen > 100)) {\n      warnings.push({\n        field: 'Margen_Sugerido',\n        message: 'El margen sugerido parece fuera de rango normal (0-100%)',\n        value: row.Margen_Sugerido,\n      });\n    }\n  }\n  \n  // Validar fecha de lanzamiento\n  if (row.Fecha_Lanzamiento && row.Fecha_Lanzamiento.trim() !== '') {\n    const dateRegex = /^\\d{4}-\\d{2}-\\d{2}$/;\n    if (!dateRegex.test(row.Fecha_Lanzamiento)) {\n      errors.push({\n        field: 'Fecha_Lanzamiento',\n        message: 'La fecha debe tener formato YYYY-MM-DD',\n        value: row.Fecha_Lanzamiento,\n      });\n    } else {\n      const date = new Date(row.Fecha_Lanzamiento);\n      if (isNaN(date.getTime())) {\n        errors.push({\n          field: 'Fecha_Lanzamiento',\n          message: 'Fecha inválida',\n          value: row.Fecha_Lanzamiento,\n        });\n      }\n    }\n  }\n  \n  // Validar URLs de imágenes\n  const imageFields: (keyof ProductCSVRow)[] = [\n    'Image_1', 'Image_2', 'Image_3', 'Image_4', 'Image_5',\n    'Image_6', 'Image_7', 'Image_8', 'Image_9', 'Image_10',\n  ];\n  \n  for (const field of imageFields) {\n    const value = row[field];\n    if (value && value.trim() !== '') {\n      try {\n        new URL(value);\n      } catch {\n        errors.push({\n          field,\n          message: 'URL de imagen inválida',\n          value,\n        });\n      }\n    }\n  }\n  \n  // Validar Video URL\n  if (row.Video_URL && row.Video_URL.trim() !== '') {\n    try {\n      new URL(row.Video_URL);\n    } catch {\n      errors.push({\n        field: 'Video_URL',\n        message: 'URL de video inválida',\n        value: row.Video_URL,\n      });\n    }\n  }\n  \n  // Validar Ficha Técnica URL\n  if (row.Ficha_Tecnica_URL && row.Ficha_Tecnica_URL.trim() !== '') {\n    try {\n      new URL(row.Ficha_Tecnica_URL);\n    } catch {\n      errors.push({\n        field: 'Ficha_Tecnica_URL',\n        message: 'URL de ficha técnica inválida',\n        value: row.Ficha_Tecnica_URL,\n      });\n    }\n  }\n  \n  // Warning si no hay imagen principal\n  if (!row.Image_1 || row.Image_1.trim() === '') {\n    warnings.push({\n      field: 'Image_1',\n      message: 'Se recomienda incluir al menos una imagen',\n      value: '',\n    });\n  }\n  \n  return { errors, warnings };\n}\n\nexport function parseCSV(csvContent: string): CSVParseResult {\n  const lines = csvContent.split(/\\r?\\n/).filter(line => line.trim() !== '');\n  const globalErrors: string[] = [];\n  const products: ParsedProduct[] = [];\n  \n  if (lines.length === 0) {\n    return {\n      success: false,\n      totalRows: 0,\n      validRows: 0,\n      invalidRows: 0,\n      products: [],\n      globalErrors: ['El archivo está vacío'],\n    };\n  }\n  \n  // Parsear headers\n  const headerLine = lines[0];\n  const headers = parseCSVLine(headerLine);\n  \n  // Verificar que los headers coincidan\n  const missingHeaders = CSV_HEADERS.filter(h => !headers.includes(h));\n  const extraHeaders = headers.filter(h => !CSV_HEADERS.includes(h as keyof ProductCSVRow));\n  \n  if (missingHeaders.length > 0) {\n    globalErrors.push(`Columnas faltantes: ${missingHeaders.join(', ')}`);\n  }\n  \n  if (extraHeaders.length > 0) {\n    globalErrors.push(`Columnas no reconocidas (serán ignoradas): ${extraHeaders.join(', ')}`);\n  }\n  \n  // Crear mapa de índices\n  const headerIndexMap: Record<string, number> = {};\n  headers.forEach((h, i) => {\n    headerIndexMap[h] = i;\n  });\n  \n  // Saltar la primera fila si parece ser descripción (contiene texto largo)\n  let startRow = 1;\n  if (lines.length > 1) {\n    const secondLine = parseCSVLine(lines[1]);\n    const firstValue = secondLine[0] || '';\n    // Si el primer valor de la segunda fila tiene más de 50 caracteres, probablemente es descripción\n    if (firstValue.length > 50 || firstValue.toLowerCase().includes('obligatorio')) {\n      startRow = 2;\n    }\n  }\n  \n  // Parsear filas de datos\n  for (let i = startRow; i < lines.length; i++) {\n    const line = lines[i];\n    if (line.trim() === '') continue;\n    \n    const values = parseCSVLine(line);\n    \n    // Crear objeto ProductCSVRow\n    const rowData: ProductCSVRow = {} as ProductCSVRow;\n    for (const header of CSV_HEADERS) {\n      const index = headerIndexMap[header];\n      rowData[header] = index !== undefined ? (values[index] || '') : '';\n    }\n    \n    // Validar\n    const { errors, warnings } = validateRow(rowData, i + 1);\n    \n    products.push({\n      row: i + 1,\n      data: rowData,\n      errors,\n      warnings,\n      isValid: errors.length === 0,\n    });\n  }\n  \n  const validRows = products.filter(p => p.isValid).length;\n  const invalidRows = products.filter(p => !p.isValid).length;\n  \n  return {\n    success: invalidRows === 0 && globalErrors.length === 0,\n    totalRows: products.length,\n    validRows,\n    invalidRows,\n    products,\n    globalErrors,\n  };\n}\n\nexport function compareWithExisting(\n  newProducts: ParsedProduct[],\n  existingProducts: Map<string, Record<string, unknown>>\n): ProductDiff[] {\n  const diffs: ProductDiff[] = [];\n  \n  for (const newProduct of newProducts) {\n    if (!newProduct.isValid) continue;\n    \n    const ref = newProduct.data.Ref;\n    const existing = existingProducts.get(ref);\n    \n    if (!existing) {\n      // Producto nuevo\n      diffs.push({\n        ref,\n        changeType: 'create',\n        changes: [],\n      });\n    } else {\n      // Comparar campos\n      const changes: ProductChange[] = [];\n      \n      const fieldMappings: Record<keyof ProductCSVRow, string> = {\n        Ref: 'pdt_codigo',\n        Cod_Barra: 'codigo_barras',\n        Producto: 'nombre_comercial',\n        Descripcion: 'pdt_descripcion',\n        Marca: 'marca',\n        Precio_COP: 'precio',\n        Descuento: 'descuento_porcentaje',\n        Existencia_inv: 'upp_existencia',\n        Pedido_en_camino: 'pedido_en_camino',\n        Descontinuado: 'descontinuado',\n        Inner_pack: 'pdt_empaque',\n        Outer_pack: 'outer_pack',\n        Coleccion: 'nombre_coleccion',\n        Categoria: '_category', // Handled separately\n        Subcategoria: '_subcategory',\n        Tipo_producto: '_type',\n        Material: 'material',\n        Color: 'color',\n        Dimensiones: 'dimensiones',\n        Peso_kg: 'peso',\n        Capacidad: 'capacidad',\n        Pais_origen: 'pais_origen',\n        Descrip_Cliente_Final: 'descripcion_larga',\n        Momentos_Uso_Cliente: 'momentos_uso',\n        Productos_Afines_Cliente: 'productos_afines_csv',\n        Descrip_Distribuidor: 'descripcion_distribuidor',\n        Argumentos_Venta_Distribuidor: 'argumentos_venta',\n        Ubicacion_Tienda_Distribuidor: 'ubicacion_tienda',\n        Margen_Sugerido: 'margen_sugerido',\n        Rotacion_Esperada: 'rotacion_esperada',\n        SEO_Title: 'seo_title',\n        SEO_Description: 'seo_description',\n        Tags: 'tags',\n        Video_URL: 'video_url',\n        Ficha_Tecnica_URL: 'ficha_tecnica_url',\n        Fecha_Lanzamiento: 'fecha_lanzamiento',\n        Image_1: 'imagen_principal_url',\n        Image_2: '_image_2',\n        Image_3: '_image_3',\n        Image_4: '_image_4',\n        Image_5: '_image_5',\n        Image_6: '_image_6',\n        Image_7: '_image_7',\n        Image_8: '_image_8',\n        Image_9: '_image_9',\n        Image_10: '_image_10',\n      };\n      \n      for (const [csvField, dbField] of Object.entries(fieldMappings)) {\n        if (dbField.startsWith('_')) continue; // Skip special fields\n        \n        const newValue = newProduct.data[csvField as keyof ProductCSVRow] || '';\n        const oldValue = String(existing[dbField] || '');\n        \n        // Normalize values for comparison\n        const normalizedNew = normalizeValue(newValue, csvField as keyof ProductCSVRow);\n        const normalizedOld = normalizeValue(oldValue, csvField as keyof ProductCSVRow);\n        \n        if (normalizedNew !== normalizedOld) {\n          changes.push({\n            field: csvField,\n            oldValue: oldValue || null,\n            newValue: newValue || null,\n          });\n        }\n      }\n      \n      if (changes.length > 0) {\n        diffs.push({\n          ref,\n          changeType: 'update',\n          changes,\n        });\n      } else {\n        diffs.push({\n          ref,\n          changeType: 'unchanged',\n          changes: [],\n        });\n      }\n    }\n  }\n  \n  return diffs;\n}\n\nfunction normalizeValue(value: string, field: keyof ProductCSVRow): string {\n  if (!value) return '';\n  \n  // Para booleanos\n  if (BOOLEAN_FIELDS.includes(field)) {\n    const upper = value.toUpperCase();\n    if (upper === 'SI' || upper === 'TRUE' || upper === '1') return 'true';\n    if (upper === 'NO' || upper === 'FALSE' || upper === '0') return 'false';\n    return value.toLowerCase();\n  }\n  \n  // Para numéricos\n  if (NUMERIC_FIELDS.includes(field)) {\n    const num = parseFloat(value.replace(/[,$]/g, ''));\n    return isNaN(num) ? '' : num.toString();\n  }\n  \n  return value.trim().toLowerCase();\n}\n\nexport function parseBooleanValue(value: string): boolean {\n  const upper = (value || '').toUpperCase().trim();\n  return upper === 'SI' || upper === 'TRUE' || upper === '1' || upper === 'YES';\n}\n\nexport function parseNumericValue(value: string): number | null {\n  if (!value || value.trim() === '') return null;\n  const num = parseFloat(value.replace(/[,$]/g, ''));\n  return isNaN(num) ? null : num;\n}\n"],"names":[],"mappings":"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"}